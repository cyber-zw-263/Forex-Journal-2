(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,18924,e=>{"use strict";var r=e.i(43476),t=e.i(71645),a=e.i(92199),l=e.i(68577),s=e.i(46932),i=e.i(53276),o=e.i(5766);let d=[{id:"htf_bias",label:"Higher Timeframe Bias",description:"Market bias on higher timeframe aligns with trade direction",icon:a.FiTrendingUp,required:!0,category:"market"},{id:"poi_identified",label:"Points of Interest",description:"Key levels, support/resistance, and POI identified",icon:a.FiTarget,required:!0,category:"setup"},{id:"entry_rules",label:"Entry Rules Met",description:"All strategy entry criteria satisfied",icon:a.FiCheck,required:!0,category:"setup"},{id:"session_respect",label:"Session Respect",description:"Trading within appropriate session time",icon:a.FiTarget,required:!1,category:"market"},{id:"risk_rules",label:"Risk Rules",description:"Position size and risk limits respected",icon:a.FiShield,required:!0,category:"risk"},{id:"emotional_state",label:"Emotional State",description:"Calm, focused, and disciplined mindset",icon:a.FiHeart,required:!0,category:"emotional"}],n={setup:"bg-blue-500",risk:"bg-red-500",emotional:"bg-purple-500",market:"bg-green-500"},c={setup:"Setup",risk:"Risk",emotional:"Emotional",market:"Market"};function x({tradeId:e,onChecklistComplete:l,onChecklistChange:x,className:p=""}){let[u,g]=(0,t.useState)(new Set),[m,h]=(0,t.useState)(!1),[b,y]=(0,t.useState)(new Set);(0,t.useEffect)(()=>{e&&v()},[e]);let v=async()=>{if(e)try{let r=await fetch(`/api/trades/${e}/checklist`,{headers:{"x-user-id":"demo-user"}});if(r.ok){let e=await r.json(),t=Array.isArray(e.completedItems)?e.completedItems:[],a=new Set(t.filter(e=>"string"==typeof e));g(a),y(a)}}catch(e){console.error("Failed to load checklist state:",e)}},f=async r=>{if(e){h(!0);try{(await fetch(`/api/trades/${e}/checklist`,{method:"POST",headers:{"Content-Type":"application/json","x-user-id":"demo-user"},body:JSON.stringify({completedItems:Array.from(r)})})).ok?(y(new Set(r)),o.default.success("Checklist saved")):o.default.error("Failed to save checklist")}catch(e){console.error("Failed to save checklist:",e),o.default.error("Failed to save checklist")}finally{h(!1)}}},j=d.filter(e=>e.required),k=j.every(e=>u.has(e.id)),w=Math.round(u.size/d.length*100),N=d.reduce((e,r)=>(e[r.category]||(e[r.category]=[]),e[r.category].push(r),e),{});return(0,r.jsxs)(i.default,{className:`p-6 ${p}`,children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Pre-Trade Checklist"}),(0,r.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:"Complete all required items before entering the trade"})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsxs)("div",{className:"text-right",children:[(0,r.jsxs)("div",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:[w,"%"]}),(0,r.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Complete"})]}),k?(0,r.jsx)(a.FiCheck,{className:"w-8 h-8 text-green-500"}):(0,r.jsx)(a.FiAlertCircle,{className:"w-8 h-8 text-yellow-500"})]})]}),(0,r.jsx)("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2 mb-6",children:(0,r.jsx)(s.motion.div,{className:"bg-gradient-to-r from-blue-500 to-purple-600 h-2 rounded-full",initial:{width:0},animate:{width:`${w}%`},transition:{duration:.5}})}),(0,r.jsx)("div",{className:"space-y-6",children:Object.entries(N).map(([t,i])=>(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center mb-3",children:[(0,r.jsx)("div",{className:`w-3 h-3 rounded-full ${n[t]} mr-2`}),(0,r.jsx)("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 uppercase tracking-wide",children:c[t]})]}),(0,r.jsx)("div",{className:"space-y-3 ml-5",children:i.map(t=>{let i=t.icon,o=u.has(t.id),n=t.required;return(0,r.jsxs)(s.motion.div,{className:`flex items-start space-x-3 p-3 rounded-lg border-2 transition-all cursor-pointer ${o?"border-green-200 bg-green-50 dark:border-green-800 dark:bg-green-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"}`,onClick:()=>{var r;let a,s;return r=t.id,(a=new Set(u)).has(r)?a.delete(r):a.add(r),g(a),e&&f(a),s=d.filter(e=>e.required).map(e=>e.id).every(e=>a.has(e)),void(x?.(Array.from(a),s),s&&!u.has(r)&&l?.(Array.from(a)))},whileHover:{scale:1.02},whileTap:{scale:.98},children:[(0,r.jsx)("div",{className:`flex-shrink-0 w-6 h-6 rounded-full flex items-center justify-center border-2 ${o?"bg-green-500 border-green-500 text-white":"border-gray-300 dark:border-gray-600"}`,children:o?(0,r.jsx)(a.FiCheck,{className:"w-4 h-4"}):(0,r.jsx)("div",{className:"w-2 h-2 rounded-full bg-gray-300 dark:bg-gray-600"})}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(i,{className:`w-4 h-4 ${o?"text-green-600":"text-gray-400"}`}),(0,r.jsxs)("span",{className:`text-sm font-medium ${o?"text-green-800 dark:text-green-200":"text-gray-900 dark:text-white"}`,children:[t.label,n&&(0,r.jsx)("span",{className:"text-red-500 ml-1",children:"*"})]})]}),(0,r.jsx)("p",{className:`text-xs mt-1 ${o?"text-green-700 dark:text-green-300":"text-gray-600 dark:text-gray-400"}`,children:t.description})]})]},t.id)})})]},t))}),(0,r.jsx)("div",{className:"mt-6 p-4 rounded-lg bg-gray-50 dark:bg-gray-800",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("div",{className:"flex items-center space-x-2",children:k?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(a.FiCheck,{className:"w-5 h-5 text-green-500"}),(0,r.jsx)("span",{className:"text-sm font-medium text-green-700 dark:text-green-300",children:"All required items completed!"})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(a.FiAlertCircle,{className:"w-5 h-5 text-yellow-500"}),(0,r.jsxs)("span",{className:"text-sm font-medium text-yellow-700 dark:text-yellow-300",children:[j.length-j.filter(e=>u.has(e.id)).length," required items remaining"]})]})}),m&&(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"}),(0,r.jsx)("span",{className:"text-xs text-gray-500",children:"Saving..."})]})]})})]})}var p=e.i(55613);let u=[{value:"none",label:"No Action",description:"Monitoring the trade"},{value:"sl_moved",label:"Stop Loss Moved",description:"Adjusted stop loss level"},{value:"tp_adjusted",label:"Take Profit Adjusted",description:"Modified profit target"},{value:"partial_close",label:"Partial Close",description:"Closed portion of position"},{value:"manual_close",label:"Manual Close",description:"Closed entire position manually"}],g=[{value:"followed_plan",label:"Followed Plan",description:"Executed according to strategy"},{value:"market_structure",label:"Market Structure",description:"Responding to price action"},{value:"emotional",label:"Emotional Response",description:"Reacted based on emotions"},{value:"fear",label:"Fear",description:"Fear-driven decision"},{value:"greed",label:"Greed",description:"Greed-driven decision"},{value:"uncertainty",label:"Uncertainty",description:"Uncertain market conditions"},{value:"distraction",label:"Distraction",description:"Lost focus or distracted"}],m=[{value:"calm",label:"Calm",color:"bg-green-100 text-green-800"},{value:"confident",label:"Confident",color:"bg-blue-100 text-blue-800"},{value:"anxious",label:"Anxious",color:"bg-yellow-100 text-yellow-800"},{value:"hesitant",label:"Hesitant",color:"bg-orange-100 text-orange-800"},{value:"overconfident",label:"Overconfident",color:"bg-purple-100 text-purple-800"},{value:"fearful",label:"Fearful",color:"bg-red-100 text-red-800"},{value:"impulsive",label:"Impulsive",color:"bg-pink-100 text-pink-800"},{value:"detached",label:"Detached",color:"bg-gray-100 text-gray-800"}],h=[{value:"disciplined",label:"Disciplined",description:"Following rules consistently"},{value:"patient",label:"Patient",description:"Waiting for proper setup"},{value:"focused",label:"Focused",description:"Maintaining attention"},{value:"impulsive",label:"Impulsive",description:"Acting without thinking"},{value:"fearful",label:"Fearful",description:"Avoiding necessary actions"},{value:"greedy",label:"Greedy",description:"Taking excessive risk"},{value:"distracted",label:"Distracted",description:"Not fully engaged"},{value:"overconfident",label:"Overconfident",description:"Taking unnecessary risks"}];function b({isOpen:e,onClose:l,tradeId:i,onUpdateAdded:d,existingUpdates:n=[]}){let[c,x]=(0,t.useState)(!1),[b,y]=(0,t.useState)({id:"",action:"none",reason:"",emotionalState:"",behavior:[],notes:"",timestamp:new Date().toISOString()}),v=()=>{y({id:"",action:"none",reason:"",emotionalState:"",behavior:[],notes:"",timestamp:new Date().toISOString()}),l()},f=async e=>{if(e.preventDefault(),!b.action)return void o.default.error("Please select an action");x(!0);try{let e=await fetch(`/api/trades/${i}/updates`,{method:"POST",headers:{"Content-Type":"application/json","x-user-id":"demo-user"},body:JSON.stringify({action:b.action,reason:b.reason||null,emotionalState:b.emotionalState||null,behavior:b.behavior&&b.behavior.length>0?b.behavior:null,notes:b.notes||null})});if(!e.ok){let r=await e.json();throw Error(r.error||"Failed to add update")}let r=await e.json();o.default.success("Trade update added successfully"),d?.(r),v()}catch(e){console.error("Error adding trade update:",e),o.default.error(e instanceof Error?e.message:"Failed to add trade update")}finally{x(!1)}};return(0,r.jsx)(p.default,{open:e,onClose:v,children:(0,r.jsxs)(s.motion.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},style:{background:"var(--background)",borderRadius:"12px",boxShadow:"var(--shadow-lg)",maxWidth:"800px",width:"100%",margin:"0 16px",maxHeight:"90vh",overflowY:"auto"},children:[(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"24px",borderBottom:"1px solid var(--border)"},children:[(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[(0,r.jsx)("div",{style:{width:"40px",height:"40px",background:"var(--accent-bg)",borderRadius:"8px",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,r.jsx)(a.FiClock,{style:{width:"20px",height:"20px",color:"var(--accent-color)"}})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{style:{fontSize:"20px",fontWeight:"600",color:"var(--text-primary)",margin:"0"},children:"Add Trade Update"}),(0,r.jsx)("p",{style:{fontSize:"14px",color:"var(--text-secondary)",margin:"4px 0 0 0"},children:"Record changes and observations during the trade"})]})]}),(0,r.jsx)("button",{onClick:v,style:{padding:"8px",background:"transparent",border:"none",borderRadius:"6px",cursor:"pointer",color:"var(--text-secondary)",transition:"background 0.2s"},onMouseEnter:e=>e.currentTarget.style.background="var(--hover-bg)",onMouseLeave:e=>e.currentTarget.style.background="transparent",children:(0,r.jsx)(a.FiX,{style:{width:"20px",height:"20px"}})})]}),(0,r.jsxs)("form",{onSubmit:f,style:{padding:"24px",display:"flex",flexDirection:"column",gap:"24px"},children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{style:{display:"block",fontSize:"14px",fontWeight:"500",color:"var(--text-primary)",marginBottom:"12px"},children:"What action did you take?"}),(0,r.jsx)("div",{style:{display:"grid",gridTemplateColumns:"1fr",gap:"12px"},children:u.map(e=>(0,r.jsxs)("label",{style:{display:"flex",alignItems:"flex-start",gap:"12px",padding:"16px",borderRadius:"8px",border:b.action===e.value?"2px solid var(--accent-color)":"2px solid var(--border)",background:b.action===e.value?"var(--accent-bg)":"var(--card-bg)",cursor:"pointer",transition:"all 0.2s"},children:[(0,r.jsx)("input",{type:"radio",name:"action",value:e.value,checked:b.action===e.value,onChange:e=>y(r=>({...r,action:e.target.value})),style:{marginTop:"2px"}}),(0,r.jsxs)("div",{style:{flex:1},children:[(0,r.jsx)("div",{style:{fontWeight:"500",color:"var(--text-primary)",marginBottom:"4px"},children:e.label}),(0,r.jsx)("div",{style:{fontSize:"14px",color:"var(--text-secondary)"},children:e.description})]})]},e.value))})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{style:{display:"block",fontSize:"14px",fontWeight:"500",color:"var(--text-primary)",marginBottom:"12px"},children:"Why did you take this action?"}),(0,r.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"12px"},children:g.map(e=>(0,r.jsxs)("label",{style:{display:"flex",alignItems:"flex-start",gap:"8px",padding:"16px",borderRadius:"8px",border:b.reason===e.value?"2px solid var(--accent-color)":"2px solid var(--border)",background:b.reason===e.value?"var(--accent-bg)":"var(--card-bg)",cursor:"pointer",transition:"all 0.2s"},children:[(0,r.jsx)("input",{type:"radio",name:"reason",value:e.value,checked:b.reason===e.value,onChange:e=>y(r=>({...r,reason:e.target.value})),style:{marginTop:"2px"}}),(0,r.jsx)("div",{style:{fontSize:"12px"},children:(0,r.jsx)("div",{style:{fontWeight:"500",color:"var(--text-primary)"},children:e.label})})]},e.value))})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{style:{display:"block",fontSize:"14px",fontWeight:"500",color:"var(--text-primary)",marginBottom:"12px"},children:"How were you feeling?"}),(0,r.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:"8px"},children:m.map(e=>(0,r.jsx)("button",{type:"button",onClick:()=>y(r=>({...r,emotionalState:r.emotionalState===e.value?"":e.value})),style:{padding:"8px 16px",borderRadius:"20px",fontSize:"14px",fontWeight:"500",border:"none",cursor:"pointer",transition:"all 0.2s",background:b.emotionalState===e.value?e.color:"var(--card-bg)",color:b.emotionalState===e.value?"white":"var(--text-primary)",boxShadow:b.emotionalState===e.value?"0 0 0 2px var(--accent-color)":"none"},children:e.label},e.value))})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{style:{display:"block",fontSize:"14px",fontWeight:"500",color:"var(--text-primary)",marginBottom:"12px"},children:"How did you behave during this update?"}),(0,r.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"12px"},children:h.map(e=>(0,r.jsxs)("label",{style:{display:"flex",alignItems:"flex-start",gap:"8px",padding:"16px",borderRadius:"8px",border:b.behavior?.includes(e.value)?"2px solid var(--success-color)":"2px solid var(--border)",background:b.behavior?.includes(e.value)?"var(--success-bg)":"var(--card-bg)",cursor:"pointer",transition:"all 0.2s"},children:[(0,r.jsx)("input",{type:"checkbox",checked:b.behavior?.includes(e.value)||!1,onChange:()=>{var r;return r=e.value,void y(e=>({...e,behavior:e.behavior?.includes(r)?e.behavior.filter(e=>e!==r):[...e.behavior||[],r]}))},style:{marginTop:"2px"}}),(0,r.jsxs)("div",{style:{fontSize:"12px",flex:1},children:[(0,r.jsx)("div",{style:{fontWeight:"500",color:"var(--text-primary)",marginBottom:"4px"},children:e.label}),(0,r.jsx)("div",{style:{color:"var(--text-secondary)",lineHeight:"1.4"},children:e.description})]})]},e.value))})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{style:{display:"block",fontSize:"14px",fontWeight:"500",color:"var(--text-primary)",marginBottom:"8px"},children:"Additional Notes"}),(0,r.jsx)("textarea",{value:b.notes,onChange:e=>y(r=>({...r,notes:e.target.value})),placeholder:"Any additional observations or thoughts...",rows:3,style:{width:"100%",padding:"12px",border:"1px solid var(--border)",borderRadius:"8px",background:"var(--card-bg)",color:"var(--text-primary)",fontSize:"14px",resize:"vertical",outline:"none",transition:"border-color 0.2s"},onFocus:e=>e.currentTarget.style.borderColor="var(--accent-color)",onBlur:e=>e.currentTarget.style.borderColor="var(--border)"})]}),(0,r.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px",paddingTop:"16px",borderTop:"1px solid var(--border)"},children:[(0,r.jsx)("button",{type:"button",onClick:v,style:{padding:"8px 16px",background:"transparent",border:"none",borderRadius:"6px",color:"var(--text-secondary)",cursor:"pointer",fontSize:"14px",transition:"background 0.2s"},onMouseEnter:e=>e.currentTarget.style.background="var(--hover-bg)",onMouseLeave:e=>e.currentTarget.style.background="transparent",children:"Cancel"}),(0,r.jsx)("button",{type:"submit",disabled:c,style:{display:"flex",alignItems:"center",gap:"8px",padding:"8px 24px",background:c?"var(--disabled-bg)":"var(--accent-color)",border:"none",borderRadius:"6px",color:"white",cursor:c?"not-allowed":"pointer",fontSize:"14px",fontWeight:"500",transition:"background 0.2s"},onMouseEnter:e=>{c||(e.currentTarget.style.background="var(--accent-hover)")},onMouseLeave:e=>{c||(e.currentTarget.style.background="var(--accent-color)")},children:c?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{style:{width:"16px",height:"16px",border:"2px solid transparent",borderTop:"2px solid white",borderRadius:"50%",animation:"spin 1s linear infinite"}}),(0,r.jsx)("span",{children:"Saving..."})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(a.FiSave,{style:{width:"16px",height:"16px"}}),(0,r.jsx)("span",{children:"Add Update"})]})})]})]})]})})}let y={none:a.FiMinus,sl_moved:a.FiTrendingDown,tp_adjusted:a.FiTrendingUp,partial_close:a.FiPlus,manual_close:a.FiX},v={none:"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-200",sl_moved:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200",tp_adjusted:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",partial_close:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200",manual_close:"bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200"},f={calm:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",confident:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200",anxious:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200",hesitant:"bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200",overconfident:"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200",fearful:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200",impulsive:"bg-pink-100 text-pink-800 dark:bg-pink-900 dark:text-pink-200",detached:"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-200"},j={followed_plan:"Followed Plan",market_structure:"Market Structure",emotional:"Emotional",fear:"Fear",greed:"Greed",uncertainty:"Uncertainty",distraction:"Distraction"};function k({tradeId:e,className:l=""}){let[o,d]=(0,t.useState)([]),[n,c]=(0,t.useState)(!0),[x,p]=(0,t.useState)(null),[u,g]=(0,t.useState)(!1);(0,t.useEffect)(()=>{m()},[e]);let m=async()=>{try{c(!0),p(null);let r=await fetch(`/api/trades/${e}/updates`,{headers:{"x-user-id":"demo-user"}});if(!r.ok)throw Error("Failed to load trade updates");let t=await r.json();d(t)}catch(e){console.error("Error loading trade updates:",e),p(e instanceof Error?e.message:"Failed to load updates")}finally{c(!1)}};return n?(0,r.jsx)(i.default,{className:`p-6 ${l}`,children:(0,r.jsxs)("div",{className:"flex items-center justify-center py-8",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"}),(0,r.jsx)("span",{className:"ml-3 text-gray-600 dark:text-gray-400",children:"Loading updates..."})]})}):x?(0,r.jsx)(i.default,{className:`p-6 ${l}`,children:(0,r.jsxs)("div",{className:"text-center py-8",children:[(0,r.jsx)("div",{className:"text-red-500 mb-2",children:"Failed to load trade updates"}),(0,r.jsx)("button",{onClick:m,className:"text-blue-600 hover:text-blue-700 underline",children:"Try again"})]})}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(i.default,{className:`p-6 ${l}`,children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)("div",{className:"w-10 h-10 bg-blue-100 dark:bg-blue-900 rounded-lg flex items-center justify-center",children:(0,r.jsx)(a.FiClock,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Trade Updates"}),(0,r.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[o.length," update",1!==o.length?"s":""," recorded"]})]})]}),(0,r.jsxs)("button",{onClick:()=>g(!0),className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors",children:[(0,r.jsx)(a.FiEdit3,{className:"w-4 h-4"}),(0,r.jsx)("span",{children:"Add Update"})]})]}),0===o.length?(0,r.jsxs)("div",{className:"text-center py-12",children:[(0,r.jsx)(a.FiClock,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),(0,r.jsx)("h4",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"No updates yet"}),(0,r.jsx)("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"Record changes and observations as the trade progresses"}),(0,r.jsxs)("button",{onClick:()=>g(!0),className:"inline-flex items-center space-x-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors",children:[(0,r.jsx)(a.FiPlus,{className:"w-4 h-4"}),(0,r.jsx)("span",{children:"Add First Update"})]})]}):(0,r.jsx)("div",{className:"space-y-4",children:o.map((e,t)=>{let l,i,o,d,n,c=y[e.action]||a.FiMinus;return(0,r.jsx)(s.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1*t},className:"border border-gray-200 dark:border-gray-700 rounded-lg p-4 hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors",children:(0,r.jsx)("div",{className:"flex items-start justify-between",children:(0,r.jsxs)("div",{className:"flex items-start space-x-4 flex-1",children:[(0,r.jsxs)("div",{className:`flex-shrink-0 px-3 py-1 rounded-full text-xs font-medium ${v[e.action]||v.none}`,children:[(0,r.jsx)(c,{className:"w-3 h-3 inline mr-1"}),e.action.replace("_"," ").replace(/\b\w/g,e=>e.toUpperCase())]}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,r.jsx)("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:(l=new Date(e.timestamp),o=Math.floor((i=new Date().getTime()-l.getTime())/6e4),d=Math.floor(i/36e5),n=Math.floor(i/864e5),o<1?"Just now":o<60?`${o}m ago`:d<24?`${d}h ago`:n<7?`${n}d ago`:l.toLocaleDateString())}),e.reason&&(0,r.jsx)("span",{className:"text-xs bg-gray-100 dark:bg-gray-700 px-2 py-1 rounded",children:j[e.reason]||e.reason})]}),e.emotionalState&&(0,r.jsx)("div",{className:"mb-2",children:(0,r.jsxs)("span",{className:`inline-block px-2 py-1 rounded-full text-xs font-medium ${f[e.emotionalState]||"bg-gray-100 text-gray-800"}`,children:["Feeling: ",e.emotionalState.replace(/\b\w/g,e=>e.toUpperCase())]})}),e.behavior&&e.behavior.length>0&&(0,r.jsx)("div",{className:"mb-2",children:(0,r.jsx)("div",{className:"flex flex-wrap gap-1",children:e.behavior.map(e=>(0,r.jsx)("span",{className:"inline-block px-2 py-1 bg-purple-100 dark:bg-purple-900 text-purple-800 dark:text-purple-200 rounded text-xs",children:e.replace(/\b\w/g,e=>e.toUpperCase())},e))})}),e.notes&&(0,r.jsx)("div",{className:"text-sm text-gray-700 dark:text-gray-300 bg-gray-50 dark:bg-gray-800 p-3 rounded-lg",children:e.notes})]})]})})},e.id)})})]}),(0,r.jsx)(b,{isOpen:u,onClose:()=>g(!1),tradeId:e,onUpdateAdded:e=>{d(r=>[...r,e].sort((e,r)=>new Date(e.timestamp).getTime()-new Date(r.timestamp).getTime()))},existingUpdates:o})]})}let w=[{value:"yes",label:"Yes",description:"Fully followed the plan"},{value:"mostly",label:"Mostly",description:"Minor deviations only"},{value:"no",label:"No",description:"Significant deviations"}],N=[{value:"calm",label:"Calm",color:"bg-green-100 text-green-800"},{value:"confident",label:"Confident",color:"bg-blue-100 text-blue-800"},{value:"anxious",label:"Anxious",color:"bg-yellow-100 text-yellow-800"},{value:"hesitant",label:"Hesitant",color:"bg-orange-100 text-orange-800"},{value:"overconfident",label:"Overconfident",color:"bg-purple-100 text-purple-800"},{value:"fearful",label:"Fearful",color:"bg-red-100 text-red-800"},{value:"impulsive",label:"Impulsive",color:"bg-pink-100 text-pink-800"},{value:"detached",label:"Detached",color:"bg-gray-100 text-gray-800"}],S=[{value:"disciplined",label:"Disciplined",description:"Followed all rules"},{value:"patient",label:"Patient",description:"Waited for proper setup"},{value:"focused",label:"Focused",description:"Maintained attention"},{value:"impulsive",label:"Impulsive",description:"Acted without thinking"},{value:"fearful",label:"Fearful",description:"Avoided necessary actions"},{value:"greedy",label:"Greedy",description:"Took excessive risk"},{value:"distracted",label:"Distracted",description:"Lost focus"},{value:"overconfident",label:"Overconfident",description:"Took unnecessary risks"}];function C({tradeId:e,onReflectionComplete:l,className:s=""}){let[d,n]=(0,t.useState)(!1),[c,x]=(0,t.useState)(!1),[p,u]=(0,t.useState)({followedPlan:"",rulesRespected:"",emotionalSummary:[],behavioralOutcomes:[],whatWentRight:"",whatWentWrong:"",lessonLearned:"",ruleToReinforce:""});(0,t.useEffect)(()=>{g()},[e]);let g=async()=>{try{n(!0);let r=await fetch(`/api/trades/${e}/reflection`,{headers:{"x-user-id":"demo-user"}});if(r.ok){let e=await r.json();u({followedPlan:e.followedPlan||"",rulesRespected:e.rulesRespected||"",emotionalSummary:e.emotionalSummary?JSON.parse(e.emotionalSummary):[],behavioralOutcomes:e.behavioralOutcomes?JSON.parse(e.behavioralOutcomes):[],whatWentRight:e.whatWentRight||"",whatWentWrong:e.whatWentWrong||"",lessonLearned:e.lessonLearned||"",ruleToReinforce:e.ruleToReinforce||""})}}catch(e){console.error("Failed to load reflection:",e)}finally{n(!1)}},m=async r=>{if(r.preventDefault(),!p.followedPlan||!p.rulesRespected)return void o.default.error("Please complete the execution quality assessment");x(!0);try{let r=await fetch(`/api/trades/${e}/reflection`,{method:"POST",headers:{"Content-Type":"application/json","x-user-id":"demo-user"},body:JSON.stringify({followedPlan:p.followedPlan,rulesRespected:p.rulesRespected,emotionalSummary:p.emotionalSummary,behavioralOutcomes:p.behavioralOutcomes,whatWentRight:p.whatWentRight,whatWentWrong:p.whatWentWrong,lessonLearned:p.lessonLearned,ruleToReinforce:p.ruleToReinforce})});if(!r.ok){let e=await r.json();throw Error(e.error||"Failed to save reflection")}let t=await r.json();o.default.success("Reflection saved successfully"),l?.(t)}catch(e){console.error("Error saving reflection:",e),o.default.error(e instanceof Error?e.message:"Failed to save reflection")}finally{x(!1)}};return d?(0,r.jsx)(i.default,{className:`p-6 ${s}`,children:(0,r.jsxs)("div",{className:"flex items-center justify-center py-8",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"}),(0,r.jsx)("span",{className:"ml-3 text-gray-600 dark:text-gray-400",children:"Loading reflection..."})]})}):(0,r.jsxs)(i.default,{className:`p-6 ${s}`,children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3 mb-6",children:[(0,r.jsx)("div",{className:"w-10 h-10 bg-green-100 dark:bg-green-900 rounded-lg flex items-center justify-center",children:(0,r.jsx)(a.FiBookOpen,{className:"w-5 h-5 text-green-600 dark:text-green-400"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Post-Trade Reflection"}),(0,r.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Analyze what happened and learn from the experience"})]})]}),(0,r.jsxs)("form",{onSubmit:m,className:"space-y-6",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Did you follow your trading plan?"}),(0,r.jsx)("div",{className:"space-y-2",children:w.map(e=>(0,r.jsxs)("label",{className:`flex items-center space-x-3 p-3 rounded-lg border-2 cursor-pointer transition-all ${p.followedPlan===e.value?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"}`,children:[(0,r.jsx)("input",{type:"radio",name:"followedPlan",value:e.value,checked:p.followedPlan===e.value,onChange:e=>u(r=>({...r,followedPlan:e.target.value})),className:"text-blue-600"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"font-medium text-gray-900 dark:text-white",children:e.label}),(0,r.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:e.description})]})]},e.value))})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Did you respect your trading rules?"}),(0,r.jsx)("div",{className:"space-y-2",children:w.map(e=>(0,r.jsxs)("label",{className:`flex items-center space-x-3 p-3 rounded-lg border-2 cursor-pointer transition-all ${p.rulesRespected===e.value?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"}`,children:[(0,r.jsx)("input",{type:"radio",name:"rulesRespected",value:e.value,checked:p.rulesRespected===e.value,onChange:e=>u(r=>({...r,rulesRespected:e.target.value})),className:"text-blue-600"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"font-medium text-gray-900 dark:text-white",children:e.label}),(0,r.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:e.description})]})]},`rules-${e.value}`))})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"How did you feel during and after the trade?"}),(0,r.jsx)("div",{className:"flex flex-wrap gap-2",children:N.map(e=>(0,r.jsx)("button",{type:"button",onClick:()=>{var r;return r=e.value,void u(e=>({...e,emotionalSummary:e.emotionalSummary.includes(r)?e.emotionalSummary.filter(e=>e!==r):[...e.emotionalSummary,r]}))},className:`px-3 py-2 rounded-full text-sm font-medium transition-all ${p.emotionalSummary.includes(e.value)?e.color+" ring-2 ring-offset-2 ring-blue-500":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"}`,children:e.label},e.value))})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"How did you behave during this trade?"}),(0,r.jsx)("div",{className:"grid grid-cols-2 gap-3",children:S.map(e=>(0,r.jsxs)("label",{className:`flex items-start space-x-2 p-3 rounded-lg border cursor-pointer transition-all ${p.behavioralOutcomes.includes(e.value)?"border-green-500 bg-green-50 dark:bg-green-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"}`,children:[(0,r.jsx)("input",{type:"checkbox",checked:p.behavioralOutcomes.includes(e.value),onChange:()=>{var r;return r=e.value,void u(e=>({...e,behavioralOutcomes:e.behavioralOutcomes.includes(r)?e.behavioralOutcomes.filter(e=>e!==r):[...e.behavioralOutcomes,r]}))},className:"mt-0.5"}),(0,r.jsxs)("div",{className:"text-xs",children:[(0,r.jsx)("div",{className:"font-medium text-gray-900 dark:text-white",children:e.label}),(0,r.jsx)("div",{className:"text-gray-600 dark:text-gray-400",children:e.description})]})]},e.value))})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"What went right?"}),(0,r.jsx)("textarea",{value:p.whatWentRight,onChange:e=>u(r=>({...r,whatWentRight:e.target.value})),placeholder:"What did you do well in this trade?",rows:4,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"What went wrong?"}),(0,r.jsx)("textarea",{value:p.whatWentWrong,onChange:e=>u(r=>({...r,whatWentWrong:e.target.value})),placeholder:"What could you have done better?",rows:4,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Key lesson learned"}),(0,r.jsx)("textarea",{value:p.lessonLearned,onChange:e=>u(r=>({...r,lessonLearned:e.target.value})),placeholder:"What's the most important takeaway from this trade?",rows:3,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Rule to reinforce"}),(0,r.jsx)("textarea",{value:p.ruleToReinforce,onChange:e=>u(r=>({...r,ruleToReinforce:e.target.value})),placeholder:"Which trading rule should you focus on reinforcing?",rows:3,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]})]}),(0,r.jsx)("div",{className:"flex justify-end pt-4 border-t border-gray-200 dark:border-gray-700",children:(0,r.jsx)("button",{type:"submit",disabled:c,className:"flex items-center space-x-2 px-6 py-2 bg-green-600 hover:bg-green-700 disabled:bg-green-400 text-white rounded-lg transition-colors",children:c?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),(0,r.jsx)("span",{children:"Saving..."})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(a.FiSave,{className:"w-4 h-4"}),(0,r.jsx)("span",{children:"Save Reflection"})]})})})]})]})}function T({onRecordingSaved:e}){let l=(0,t.useRef)(null),s=(0,t.useRef)([]),[i,d]=(0,t.useState)(!1),[n,c]=(0,t.useState)(0),[x,p]=(0,t.useState)([]),[u,g]=(0,t.useState)(null);(0,t.useEffect)(()=>{let e;return i&&(e=setInterval(()=>{c(e=>e+1)},1e3)),()=>clearInterval(e)},[i]);let m=async()=>{try{let r=await navigator.mediaDevices.getUserMedia({audio:!0});l.current=new MediaRecorder(r),s.current=[],l.current.ondataavailable=e=>{s.current.push(e.data)},l.current.onstop=()=>{(async()=>{let r=new Blob(s.current,{type:"audio/webm"}),t=URL.createObjectURL(r),a={id:Date.now().toString(),url:t,duration:n,timestamp:new Date,uploaded:!1};p(e=>[a,...e]),e?.(t);try{let e=new FormData;e.append("file",r,`voice-${Date.now()}.webm`);let t=await fetch("/api/voice-notes",{method:"POST",body:e,headers:{"x-user-id":"demo-user"}});if(t.ok){let e=await t.json();e?.url?p(r=>r.map(r=>r.id===a.id?{...r,url:e.url,uploaded:!0}:r)):p(e=>e.map(e=>e.id===a.id?{...e,uploaded:!0}:e)),o.default.success("Voice note uploaded")}else(0,o.default)("Saved locally (upload failed)",{icon:"âš ï¸"})}catch(e){console.error("Voice upload failed",e),(0,o.default)("Saved locally (upload failed)",{icon:"âš ï¸"})}})()},l.current.start(),d(!0),c(0)}catch(e){o.default.error("Unable to access microphone"),console.error(e)}},h=e=>{let r=Math.floor(e/60);return`${r}:${(e%60).toString().padStart(2,"0")}`};return(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"bg-white dark:bg-slate-800 rounded-lg p-6 border border-gray-200 dark:border-slate-700",children:[(0,r.jsx)("h3",{className:"text-lg font-bold text-gray-900 dark:text-white mb-4",children:"Voice Notes"}),(0,r.jsx)("div",{className:"flex items-center gap-4 mb-4 flex-wrap",children:i?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("button",{onClick:()=>{l.current&&i&&(l.current.stop(),d(!1),l.current.stream.getTracks().forEach(e=>e.stop()))},className:"flex items-center gap-2 bg-red-600 hover:bg-red-700 text-white font-semibold py-3 px-4 rounded-lg transition-colors","aria-label":"Stop recording","aria-live":"polite",children:[(0,r.jsx)(a.FiStopCircle,{className:"w-5 h-5"}),"Stop"]}),(0,r.jsxs)("div",{className:"text-lg font-bold text-red-600 dark:text-red-400","aria-live":"polite",children:["Recording: ",h(n)]}),(0,r.jsx)("div",{className:"flex-1 h-1 bg-red-300 dark:bg-red-900 rounded-full relative overflow-hidden min-w-[100px]",children:(0,r.jsx)("div",{className:"h-full bg-red-600 animate-pulse",style:{width:"30%"}})})]}):(0,r.jsxs)("button",{onClick:m,className:"flex items-center gap-2 bg-red-600 hover:bg-red-700 text-white font-semibold py-3 px-4 rounded-lg transition-colors","aria-label":"Start recording voice note",children:[(0,r.jsx)(a.FiMic,{className:"w-5 h-5"}),"Start Recording"]})}),x.length>0&&(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("h4",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300",children:["Recordings (",x.length,")"]}),x.map(e=>(0,r.jsxs)("div",{className:"flex items-center justify-between bg-gray-50 dark:bg-slate-700 p-3 rounded-lg",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 flex-1",children:[(0,r.jsx)("button",{onClick:()=>g(u===e.id?null:e.id),className:"p-2 rounded-lg bg-blue-600 hover:bg-blue-700 text-white transition-colors","aria-label":u===e.id?"Pause recording":"Play recording",children:(0,r.jsx)(a.FiPlay,{className:"w-4 h-4"})}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:e.timestamp.toLocaleTimeString()}),(0,r.jsxs)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Duration: ",h(e.duration),e.uploaded&&(0,r.jsx)("span",{className:"ml-2",children:"âœ“ Uploaded"})]})]})]}),(0,r.jsx)("button",{onClick:()=>{var r;return r=e.id,void p(e=>e.filter(e=>e.id!==r))},className:"p-2 rounded-lg text-red-600 dark:text-red-400 hover:bg-red-100 dark:hover:bg-red-900/30 transition-colors","aria-label":`Delete recording from ${e.timestamp.toLocaleTimeString()}`,children:(0,r.jsx)(a.FiTrash2,{className:"w-4 h-4"})})]},e.id))]}),0===x.length&&!i&&(0,r.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 text-center py-6",children:"No recordings yet. Start recording to add voice notes to your trades."})]}),u&&(0,r.jsx)("audio",{src:x.find(e=>e.id===u)?.url,autoPlay:!0,controls:!0,className:"w-full"},u)]})}function F({onScreenshotAdded:e}){let l=(0,t.useRef)(null),[s,i]=(0,t.useState)([]),[d,n]=(0,t.useState)(null),[c,x]=(0,t.useState)(""),p=async r=>{let t=r.currentTarget.files;if(t){for(let r of Array.from(t))try{let t=new FileReader;t.onload=r=>{let t=r.target?.result,a={id:Date.now().toString()+Math.random(),url:t,caption:"",timestamp:new Date};i(e=>[a,...e]),e?.(t),o.default.success("Screenshot uploaded")},t.readAsDataURL(r)}catch(e){o.default.error("Failed to upload screenshot"),console.error(e)}l.current&&(l.current.value="")}},u=(e,r)=>{i(t=>t.map(t=>t.id===e?{...t,caption:r}:t)),n(null)};return(0,r.jsx)("div",{className:"space-y-4",children:(0,r.jsxs)("div",{className:"bg-white dark:bg-slate-800 rounded-lg p-6 border border-gray-200 dark:border-slate-700",children:[(0,r.jsx)("h3",{className:"text-lg font-bold text-gray-900 dark:text-white mb-4",children:"Trade Setup Screenshots"}),(0,r.jsxs)("button",{onClick:()=>l.current?.click(),className:"w-full border-2 border-dashed border-gray-300 dark:border-slate-600 rounded-lg p-6 text-center cursor-pointer hover:bg-gray-50 dark:hover:bg-slate-700/50 transition-colors","aria-label":"Upload screenshot by clicking or dragging files",children:[(0,r.jsx)(a.FiUpload,{className:"w-8 h-8 mx-auto mb-2 text-gray-600 dark:text-gray-400"}),(0,r.jsx)("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:"Click to upload or drag & drop"}),(0,r.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"PNG, JPG, GIF up to 10MB"}),(0,r.jsx)("input",{ref:l,type:"file",multiple:!0,accept:"image/*",onChange:p,className:"hidden","aria-label":"File input for screenshots"})]}),s.length>0&&(0,r.jsxs)("div",{className:"mt-6",children:[(0,r.jsxs)("h4",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-4",children:["Uploads (",s.length,")"]}),(0,r.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:s.map(e=>(0,r.jsxs)("div",{className:"relative group bg-gray-100 dark:bg-slate-700 rounded-lg overflow-hidden",children:[(0,r.jsx)("img",{src:e.url,alt:"Trade setup",className:"w-full h-40 object-cover"}),(0,r.jsxs)("div",{className:"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-between p-2",children:[(0,r.jsx)("button",{onClick:()=>{var r,t;let a;return r=e.url,t=e.timestamp,void((a=document.createElement("a")).href=r,a.download=`trade-setup-${t.toISOString()}.png`,document.body.appendChild(a),a.click(),document.body.removeChild(a))},className:"p-2 rounded-lg bg-blue-600 hover:bg-blue-700 text-white transition-colors",title:"Download",children:(0,r.jsx)(a.FiDownload,{className:"w-4 h-4"})}),(0,r.jsx)("button",{onClick:()=>{var r;return r=e.id,void i(e=>e.filter(e=>e.id!==r))},className:"p-2 rounded-lg bg-red-600 hover:bg-red-700 text-white transition-colors",title:"Delete",children:(0,r.jsx)(a.FiX,{className:"w-4 h-4"})})]}),(0,r.jsx)("div",{className:"p-3 bg-white dark:bg-slate-800 border-t border-gray-200 dark:border-slate-600",children:d===e.id?(0,r.jsx)("input",{autoFocus:!0,type:"text",value:c,onChange:e=>x(e.target.value),onBlur:()=>u(e.id,c),onKeyPress:r=>{"Enter"===r.key&&u(e.id,c)},placeholder:"Add caption...",className:"w-full px-2 py-1 border border-gray-300 dark:border-slate-600 rounded bg-white dark:bg-slate-700 text-gray-900 dark:text-white text-xs focus:ring-2 focus:ring-blue-500 outline-none"}):(0,r.jsx)("p",{onClick:()=>{n(e.id),x(e.caption)},className:"text-xs text-gray-600 dark:text-gray-400 cursor-pointer hover:text-gray-900 dark:hover:text-white",children:e.caption||"Click to add caption..."})})]},e.id))})]})]})})}var R=e.i(9876);function W(){let{theme:e,toggleTheme:s}=(0,R.useTheme)(),[i]=(0,t.useState)(()=>!0),[d,n]=(0,t.useState)(null),[c,p]=(0,t.useState)([]),[u,g]=(0,t.useState)(!0),[m,h]=(0,t.useState)("checklist");(0,t.useEffect)(()=>{i&&b()},[i]);let b=async()=>{try{let e;g(!0);let r=await fetch("/api/trades",{headers:{"x-user-id":"demo-user"}});if(!r.ok)throw Error("Failed to load trades");let t=await r.json();e=t&&"object"==typeof t&&"data"in t?t.data:t,p(e)}catch(e){console.error("Error loading trades:",e),o.default.error("Failed to load trades")}finally{g(!1)}},y=c.find(e=>e.id===d),v=[{id:"checklist",label:"Pre-Trade Checklist",icon:a.FiCheckCircle},{id:"updates",label:"Trade Updates",icon:a.FiClock},{id:"reflection",label:"Post-Trade Reflection",icon:a.FiBookOpen},{id:"media",label:"Media & Notes",icon:a.FiTrendingUp}];return i?(0,r.jsxs)("div",{style:{minHeight:"100vh",backgroundColor:"var(--background)"},children:[(0,r.jsx)(l.default,{onThemeToggle:s,currentTheme:e}),(0,r.jsxs)("main",{style:{maxWidth:"1200px",margin:"0 auto",padding:"32px 16px"},children:[(0,r.jsxs)("div",{style:{marginBottom:"32px"},children:[(0,r.jsx)("h1",{style:{fontSize:"32px",fontWeight:"700",color:"var(--text-primary)",marginBottom:"8px"},children:"Trade Lifecycle Review"}),(0,r.jsx)("p",{style:{fontSize:"16px",color:"var(--text-secondary)",margin:0},children:"Complete pre-trade preparation, track in-trade decisions, and reflect on outcomes"})]}),(0,r.jsx)("div",{style:{marginBottom:"24px"},children:(0,r.jsx)("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap"},children:v.map(e=>{let t=e.icon;return(0,r.jsxs)("button",{onClick:()=>h(e.id),style:{display:"flex",alignItems:"center",gap:"8px",padding:"12px 16px",borderRadius:"8px",border:"none",backgroundColor:m===e.id?"var(--purple-base)":"transparent",color:m===e.id?"white":"var(--text-secondary)",cursor:"pointer",fontWeight:"600",fontSize:"14px",transition:"all 0.2s ease"},onMouseEnter:r=>{m!==e.id&&(r.currentTarget.style.backgroundColor="var(--panel-muted)")},onMouseLeave:r=>{m!==e.id&&(r.currentTarget.style.backgroundColor="transparent")},children:[(0,r.jsx)(t,{size:16}),(0,r.jsx)("span",{children:e.label})]},e.id)})})}),(0,r.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(300px, 1fr))",gap:"24px"},children:[(0,r.jsxs)("div",{style:{backgroundColor:"var(--card-bg)",border:"1px solid var(--card-border)",borderRadius:"12px",padding:"20px"},children:[(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"16px"},children:[(0,r.jsx)("h2",{style:{fontSize:"16px",fontWeight:"600",color:"var(--text-primary)",margin:0},children:"Recent Trades"}),(0,r.jsxs)("div",{style:{fontSize:"12px",color:"var(--text-secondary)"},children:[c.length," total"]})]}),(0,r.jsx)("div",{style:{maxHeight:"400px",overflowY:"auto"},children:u?(0,r.jsx)("div",{style:{display:"flex",justifyContent:"center",padding:"32px"},children:(0,r.jsx)("div",{style:{width:"24px",height:"24px",border:"2px solid var(--card-border)",borderTop:"2px solid var(--purple-base)",borderRadius:"50%",animation:"spin 1s linear infinite"}})}):c.length>0?(0,r.jsx)("div",{style:{display:"grid",gap:"8px"},children:c.map(e=>(0,r.jsxs)("button",{onClick:()=>n(e.id),style:{width:"100%",textAlign:"left",padding:"12px",borderRadius:"8px",border:d===e.id?"2px solid var(--purple-base)":"1px solid var(--card-border)",backgroundColor:d===e.id?"var(--panel-muted)":"var(--card-bg)",cursor:"pointer",transition:"all 0.2s ease"},onMouseEnter:r=>{d!==e.id&&(r.currentTarget.style.backgroundColor="var(--panel-muted)")},onMouseLeave:r=>{d!==e.id&&(r.currentTarget.style.backgroundColor=d===e.id?"var(--panel-muted)":"var(--card-bg)")},children:[(0,r.jsxs)("div",{style:{fontSize:"14px",fontWeight:"600",color:"var(--text-primary)",marginBottom:"4px"},children:[e.pair," ",e.direction]}),(0,r.jsx)("div",{style:{fontSize:"12px",color:"var(--text-secondary)",marginBottom:"4px"},children:new Date(e.entryTime).toLocaleDateString()}),(0,r.jsx)("div",{style:{fontSize:"12px",fontWeight:"600",color:"WIN"===e.outcome?"#10b981":"LOSS"===e.outcome?"#ef4444":"var(--text-secondary)"},children:e.outcome||"Open"})]},e.id))}):(0,r.jsxs)("div",{style:{textAlign:"center",padding:"32px"},children:[(0,r.jsx)("div",{style:{fontSize:"48px",marginBottom:"16px"},children:"ðŸ“Š"}),(0,r.jsx)("h3",{style:{fontSize:"16px",fontWeight:"600",color:"var(--text-primary)",marginBottom:"8px"},children:"No Trades Yet"}),(0,r.jsx)("p",{style:{fontSize:"14px",color:"var(--text-secondary)"},children:"Start trading to begin reviewing your performance"})]})})]}),(0,r.jsx)("div",{style:{backgroundColor:"var(--card-bg)",border:"1px solid var(--card-border)",borderRadius:"12px",padding:"20px"},children:y?(0,r.jsxs)("div",{style:{display:"grid",gap:"20px"},children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"16px"},children:[(0,r.jsxs)("h2",{style:{fontSize:"18px",fontWeight:"600",color:"var(--text-primary)",margin:0},children:[y.pair," - ",y.direction]}),(0,r.jsx)("span",{style:{padding:"4px 12px",borderRadius:"20px",fontSize:"12px",fontWeight:"600",backgroundColor:"closed"===y.status?"#dcfce7":"open"===y.status?"#dbeafe":"var(--panel-muted)",color:"closed"===y.status?"#166534":"open"===y.status?"#1e40af":"var(--text-secondary)"},children:y.status})]}),(0,r.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(120px, 1fr))",gap:"16px"},children:[(0,r.jsxs)("div",{style:{padding:"12px",backgroundColor:"var(--panel-muted)",borderRadius:"6px"},children:[(0,r.jsx)("div",{style:{fontSize:"12px",color:"var(--text-secondary)",marginBottom:"4px"},children:"Entry Price"}),(0,r.jsx)("div",{style:{fontSize:"14px",fontWeight:"600",color:"var(--text-primary)"},children:y.entryPrice.toFixed(5)})]}),(0,r.jsxs)("div",{style:{padding:"12px",backgroundColor:"var(--panel-muted)",borderRadius:"6px"},children:[(0,r.jsx)("div",{style:{fontSize:"12px",color:"var(--text-secondary)",marginBottom:"4px"},children:"Exit Price"}),(0,r.jsx)("div",{style:{fontSize:"14px",fontWeight:"600",color:"var(--text-primary)"},children:y.exitPrice?.toFixed(5)||"Open"})]}),(0,r.jsxs)("div",{style:{padding:"12px",backgroundColor:"var(--panel-muted)",borderRadius:"6px"},children:[(0,r.jsx)("div",{style:{fontSize:"12px",color:"var(--text-secondary)",marginBottom:"4px"},children:"P&L"}),(0,r.jsx)("div",{style:{fontSize:"14px",fontWeight:"600",color:(y.profitLoss||0)>=0?"#10b981":"#ef4444"},children:y.profitLoss?.toFixed(2)||"N/A"})]}),(0,r.jsxs)("div",{style:{padding:"12px",backgroundColor:"var(--panel-muted)",borderRadius:"6px"},children:[(0,r.jsx)("div",{style:{fontSize:"12px",color:"var(--text-secondary)",marginBottom:"4px"},children:"Outcome"}),(0,r.jsx)("div",{style:{fontSize:"14px",fontWeight:"600",color:"var(--text-primary)"},children:y.outcome||"Open"})]})]})]}),(0,r.jsxs)("div",{style:{minHeight:"400px"},children:["checklist"===m&&(0,r.jsx)(x,{tradeId:y.id,onChecklistComplete:e=>{o.default.success("Pre-trade checklist completed!")}}),"updates"===m&&(0,r.jsx)(k,{tradeId:y.id}),"reflection"===m&&(0,r.jsx)(C,{tradeId:y.id,onReflectionComplete:e=>{o.default.success("Post-trade reflection saved!")}}),"media"===m&&(0,r.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"16px"},children:[(0,r.jsxs)("div",{style:{backgroundColor:"var(--panel-muted)",borderRadius:"8px",padding:"16px"},children:[(0,r.jsx)("h3",{style:{fontSize:"16px",fontWeight:"600",color:"var(--text-primary)",marginBottom:"12px"},children:"Voice Notes"}),(0,r.jsx)(T,{})]}),(0,r.jsxs)("div",{style:{backgroundColor:"var(--panel-muted)",borderRadius:"8px",padding:"16px"},children:[(0,r.jsx)("h3",{style:{fontSize:"16px",fontWeight:"600",color:"var(--text-primary)",marginBottom:"12px"},children:"Screenshots"}),(0,r.jsx)(F,{})]})]})]})]}):(0,r.jsxs)("div",{style:{textAlign:"center",padding:"64px 32px"},children:[(0,r.jsx)("div",{style:{fontSize:"64px",marginBottom:"24px"},children:"ðŸ“ˆ"}),(0,r.jsx)("h3",{style:{fontSize:"20px",fontWeight:"600",color:"var(--text-primary)",marginBottom:"12px"},children:"Select a Trade to Review"}),(0,r.jsx)("p",{style:{fontSize:"16px",color:"var(--text-secondary)",marginBottom:"24px"},children:"Choose a trade from the sidebar to access the complete lifecycle review"}),(0,r.jsx)("button",{onClick:()=>n(c[0]?.id||null),disabled:0===c.length,style:{padding:"12px 24px",background:"linear-gradient(135deg, var(--purple-base) 0%, var(--purple-dark) 100%)",color:"white",border:"none",borderRadius:"8px",cursor:c.length>0?"pointer":"not-allowed",fontWeight:"600",fontSize:"14px",opacity:c.length>0?1:.5},children:"Select First Trade"})]})})]})]}),(0,r.jsx)(o.Toaster,{position:"bottom-right"})]}):(0,r.jsx)("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900"})}e.s(["default",()=>W],18924)}]);