(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,18924,e=>{"use strict";var a=e.i(43476),t=e.i(71645),r=e.i(92199),s=e.i(68577),l=e.i(53276),i=e.i(46932),d=e.i(5766);let o=[{id:"htf_bias",label:"Higher Timeframe Bias",description:"Market bias on higher timeframe aligns with trade direction",icon:r.FiTrendingUp,required:!0,category:"market"},{id:"poi_identified",label:"Points of Interest",description:"Key levels, support/resistance, and POI identified",icon:r.FiTarget,required:!0,category:"setup"},{id:"entry_rules",label:"Entry Rules Met",description:"All strategy entry criteria satisfied",icon:r.FiCheck,required:!0,category:"setup"},{id:"session_respect",label:"Session Respect",description:"Trading within appropriate session time",icon:r.FiTarget,required:!1,category:"market"},{id:"risk_rules",label:"Risk Rules",description:"Position size and risk limits respected",icon:r.FiShield,required:!0,category:"risk"},{id:"emotional_state",label:"Emotional State",description:"Calm, focused, and disciplined mindset",icon:r.FiHeart,required:!0,category:"emotional"}],n={setup:"bg-blue-500",risk:"bg-red-500",emotional:"bg-purple-500",market:"bg-green-500"},c={setup:"Setup",risk:"Risk",emotional:"Emotional",market:"Market"};function x({tradeId:e,onChecklistComplete:s,onChecklistChange:x,className:u=""}){let[g,m]=(0,t.useState)(new Set),[h,b]=(0,t.useState)(!1),[p,y]=(0,t.useState)(new Set);(0,t.useEffect)(()=>{e&&f()},[e]);let f=async()=>{if(e)try{let a=await fetch(`/api/trades/${e}/checklist`,{headers:{"x-user-id":"demo-user"}});if(a.ok){let e=await a.json(),t=Array.isArray(e.completedItems)?e.completedItems:[],r=new Set(t.filter(e=>"string"==typeof e));m(r),y(r)}}catch(e){console.error("Failed to load checklist state:",e)}},v=async a=>{if(e){b(!0);try{(await fetch(`/api/trades/${e}/checklist`,{method:"POST",headers:{"Content-Type":"application/json","x-user-id":"demo-user"},body:JSON.stringify({completedItems:Array.from(a)})})).ok?(y(new Set(a)),d.default.success("Checklist saved")):d.default.error("Failed to save checklist")}catch(e){console.error("Failed to save checklist:",e),d.default.error("Failed to save checklist")}finally{b(!1)}}},j=o.filter(e=>e.required),k=j.every(e=>g.has(e.id)),N=Math.round(g.size/o.length*100),w=o.reduce((e,a)=>(e[a.category]||(e[a.category]=[]),e[a.category].push(a),e),{});return(0,a.jsxs)(l.default,{className:`p-6 ${u}`,children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Pre-Trade Checklist"}),(0,a.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:"Complete all required items before entering the trade"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("div",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:[N,"%"]}),(0,a.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Complete"})]}),k?(0,a.jsx)(r.FiCheck,{className:"w-8 h-8 text-green-500"}):(0,a.jsx)(r.FiAlertCircle,{className:"w-8 h-8 text-yellow-500"})]})]}),(0,a.jsx)("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2 mb-6",children:(0,a.jsx)(i.motion.div,{className:"bg-gradient-to-r from-blue-500 to-purple-600 h-2 rounded-full",initial:{width:0},animate:{width:`${N}%`},transition:{duration:.5}})}),(0,a.jsx)("div",{className:"space-y-6",children:Object.entries(w).map(([t,l])=>(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center mb-3",children:[(0,a.jsx)("div",{className:`w-3 h-3 rounded-full ${n[t]} mr-2`}),(0,a.jsx)("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 uppercase tracking-wide",children:c[t]})]}),(0,a.jsx)("div",{className:"space-y-3 ml-5",children:l.map(t=>{let l=t.icon,d=g.has(t.id),n=t.required;return(0,a.jsxs)(i.motion.div,{className:`flex items-start space-x-3 p-3 rounded-lg border-2 transition-all cursor-pointer ${d?"border-green-200 bg-green-50 dark:border-green-800 dark:bg-green-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"}`,onClick:()=>{var a;let r,l;return a=t.id,(r=new Set(g)).has(a)?r.delete(a):r.add(a),m(r),e&&v(r),l=o.filter(e=>e.required).map(e=>e.id).every(e=>r.has(e)),void(x?.(Array.from(r),l),l&&!g.has(a)&&s?.(Array.from(r)))},whileHover:{scale:1.02},whileTap:{scale:.98},children:[(0,a.jsx)("div",{className:`flex-shrink-0 w-6 h-6 rounded-full flex items-center justify-center border-2 ${d?"bg-green-500 border-green-500 text-white":"border-gray-300 dark:border-gray-600"}`,children:d?(0,a.jsx)(r.FiCheck,{className:"w-4 h-4"}):(0,a.jsx)("div",{className:"w-2 h-2 rounded-full bg-gray-300 dark:bg-gray-600"})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(l,{className:`w-4 h-4 ${d?"text-green-600":"text-gray-400"}`}),(0,a.jsxs)("span",{className:`text-sm font-medium ${d?"text-green-800 dark:text-green-200":"text-gray-900 dark:text-white"}`,children:[t.label,n&&(0,a.jsx)("span",{className:"text-red-500 ml-1",children:"*"})]})]}),(0,a.jsx)("p",{className:`text-xs mt-1 ${d?"text-green-700 dark:text-green-300":"text-gray-600 dark:text-gray-400"}`,children:t.description})]})]},t.id)})})]},t))}),(0,a.jsx)("div",{className:"mt-6 p-4 rounded-lg bg-gray-50 dark:bg-gray-800",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("div",{className:"flex items-center space-x-2",children:k?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(r.FiCheck,{className:"w-5 h-5 text-green-500"}),(0,a.jsx)("span",{className:"text-sm font-medium text-green-700 dark:text-green-300",children:"All required items completed!"})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(r.FiAlertCircle,{className:"w-5 h-5 text-yellow-500"}),(0,a.jsxs)("span",{className:"text-sm font-medium text-yellow-700 dark:text-yellow-300",children:[j.length-j.filter(e=>g.has(e.id)).length," required items remaining"]})]})}),h&&(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"}),(0,a.jsx)("span",{className:"text-xs text-gray-500",children:"Saving..."})]})]})})]})}var u=e.i(55613);let g=[{value:"none",label:"No Action",description:"Monitoring the trade"},{value:"sl_moved",label:"Stop Loss Moved",description:"Adjusted stop loss level"},{value:"tp_adjusted",label:"Take Profit Adjusted",description:"Modified profit target"},{value:"partial_close",label:"Partial Close",description:"Closed portion of position"},{value:"manual_close",label:"Manual Close",description:"Closed entire position manually"}],m=[{value:"followed_plan",label:"Followed Plan",description:"Executed according to strategy"},{value:"market_structure",label:"Market Structure",description:"Responding to price action"},{value:"emotional",label:"Emotional Response",description:"Reacted based on emotions"},{value:"fear",label:"Fear",description:"Fear-driven decision"},{value:"greed",label:"Greed",description:"Greed-driven decision"},{value:"uncertainty",label:"Uncertainty",description:"Uncertain market conditions"},{value:"distraction",label:"Distraction",description:"Lost focus or distracted"}],h=[{value:"calm",label:"Calm",color:"bg-green-100 text-green-800"},{value:"confident",label:"Confident",color:"bg-blue-100 text-blue-800"},{value:"anxious",label:"Anxious",color:"bg-yellow-100 text-yellow-800"},{value:"hesitant",label:"Hesitant",color:"bg-orange-100 text-orange-800"},{value:"overconfident",label:"Overconfident",color:"bg-purple-100 text-purple-800"},{value:"fearful",label:"Fearful",color:"bg-red-100 text-red-800"},{value:"impulsive",label:"Impulsive",color:"bg-pink-100 text-pink-800"},{value:"detached",label:"Detached",color:"bg-gray-100 text-gray-800"}],b=[{value:"disciplined",label:"Disciplined",description:"Following rules consistently"},{value:"patient",label:"Patient",description:"Waiting for proper setup"},{value:"focused",label:"Focused",description:"Maintaining attention"},{value:"impulsive",label:"Impulsive",description:"Acting without thinking"},{value:"fearful",label:"Fearful",description:"Avoiding necessary actions"},{value:"greedy",label:"Greedy",description:"Taking excessive risk"},{value:"distracted",label:"Distracted",description:"Not fully engaged"},{value:"overconfident",label:"Overconfident",description:"Taking unnecessary risks"}];function p({isOpen:e,onClose:s,tradeId:l,onUpdateAdded:o,existingUpdates:n=[]}){let[c,x]=(0,t.useState)(!1),[p,y]=(0,t.useState)({id:"",action:"none",reason:"",emotionalState:"",behavior:[],notes:"",timestamp:new Date().toISOString()}),f=()=>{y({id:"",action:"none",reason:"",emotionalState:"",behavior:[],notes:"",timestamp:new Date().toISOString()}),s()},v=async e=>{if(e.preventDefault(),!p.action)return void d.default.error("Please select an action");x(!0);try{let e=await fetch(`/api/trades/${l}/updates`,{method:"POST",headers:{"Content-Type":"application/json","x-user-id":"demo-user"},body:JSON.stringify({action:p.action,reason:p.reason||null,emotionalState:p.emotionalState||null,behavior:p.behavior&&p.behavior.length>0?p.behavior:null,notes:p.notes||null})});if(!e.ok){let a=await e.json();throw Error(a.error||"Failed to add update")}let a=await e.json();d.default.success("Trade update added successfully"),o?.(a),f()}catch(e){console.error("Error adding trade update:",e),d.default.error(e instanceof Error?e.message:"Failed to add trade update")}finally{x(!1)}};return(0,a.jsx)(u.default,{open:e,onClose:f,children:(0,a.jsxs)(i.motion.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"bg-white dark:bg-gray-800 rounded-xl shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"w-10 h-10 bg-blue-100 dark:bg-blue-900 rounded-lg flex items-center justify-center",children:(0,a.jsx)(r.FiClock,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Add Trade Update"}),(0,a.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Record changes and observations during the trade"})]})]}),(0,a.jsx)("button",{onClick:f,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:(0,a.jsx)(r.FiX,{className:"w-5 h-5"})})]}),(0,a.jsxs)("form",{onSubmit:v,className:"p-6 space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"What action did you take?"}),(0,a.jsx)("div",{className:"grid grid-cols-1 gap-3",children:g.map(e=>(0,a.jsxs)("label",{className:`flex items-start space-x-3 p-3 rounded-lg border-2 cursor-pointer transition-all ${p.action===e.value?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"}`,children:[(0,a.jsx)("input",{type:"radio",name:"action",value:e.value,checked:p.action===e.value,onChange:e=>y(a=>({...a,action:e.target.value})),className:"mt-0.5"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("div",{className:"font-medium text-gray-900 dark:text-white",children:e.label}),(0,a.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:e.description})]})]},e.value))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Why did you take this action?"}),(0,a.jsx)("div",{className:"grid grid-cols-2 gap-3",children:m.map(e=>(0,a.jsxs)("label",{className:`flex items-start space-x-2 p-3 rounded-lg border cursor-pointer transition-all ${p.reason===e.value?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"}`,children:[(0,a.jsx)("input",{type:"radio",name:"reason",value:e.value,checked:p.reason===e.value,onChange:e=>y(a=>({...a,reason:e.target.value})),className:"mt-0.5"}),(0,a.jsx)("div",{className:"text-xs",children:(0,a.jsx)("div",{className:"font-medium text-gray-900 dark:text-white",children:e.label})})]},e.value))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"How were you feeling?"}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:h.map(e=>(0,a.jsx)("button",{type:"button",onClick:()=>y(a=>({...a,emotionalState:a.emotionalState===e.value?"":e.value})),className:`px-3 py-2 rounded-full text-sm font-medium transition-all ${p.emotionalState===e.value?e.color+" ring-2 ring-offset-2 ring-blue-500":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"}`,children:e.label},e.value))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"How did you behave during this update?"}),(0,a.jsx)("div",{className:"grid grid-cols-2 gap-3",children:b.map(e=>(0,a.jsxs)("label",{className:`flex items-start space-x-2 p-3 rounded-lg border cursor-pointer transition-all ${p.behavior?.includes(e.value)?"border-green-500 bg-green-50 dark:bg-green-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"}`,children:[(0,a.jsx)("input",{type:"checkbox",checked:p.behavior?.includes(e.value)||!1,onChange:()=>{var a;return a=e.value,void y(e=>({...e,behavior:e.behavior?.includes(a)?e.behavior.filter(e=>e!==a):[...e.behavior||[],a]}))},className:"mt-0.5"}),(0,a.jsxs)("div",{className:"text-xs",children:[(0,a.jsx)("div",{className:"font-medium text-gray-900 dark:text-white",children:e.label}),(0,a.jsx)("div",{className:"text-gray-600 dark:text-gray-400",children:e.description})]})]},e.value))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Additional Notes"}),(0,a.jsx)("textarea",{value:p.notes,onChange:e=>y(a=>({...a,notes:e.target.value})),placeholder:"Any additional observations or thoughts...",rows:3,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-200 dark:border-gray-700",children:[(0,a.jsx)("button",{type:"button",onClick:f,className:"px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:"Cancel"}),(0,a.jsx)("button",{type:"submit",disabled:c,className:"flex items-center space-x-2 px-6 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white rounded-lg transition-colors",children:c?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),(0,a.jsx)("span",{children:"Saving..."})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(r.FiSave,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:"Add Update"})]})})]})]})]})})}let y={none:r.FiMinus,sl_moved:r.FiTrendingDown,tp_adjusted:r.FiTrendingUp,partial_close:r.FiPlus,manual_close:r.FiX},f={none:"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-200",sl_moved:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200",tp_adjusted:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",partial_close:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200",manual_close:"bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200"},v={calm:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",confident:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200",anxious:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200",hesitant:"bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200",overconfident:"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200",fearful:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200",impulsive:"bg-pink-100 text-pink-800 dark:bg-pink-900 dark:text-pink-200",detached:"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-200"},j={followed_plan:"Followed Plan",market_structure:"Market Structure",emotional:"Emotional",fear:"Fear",greed:"Greed",uncertainty:"Uncertainty",distraction:"Distraction"};function k({tradeId:e,className:s=""}){let[d,o]=(0,t.useState)([]),[n,c]=(0,t.useState)(!0),[x,u]=(0,t.useState)(null),[g,m]=(0,t.useState)(!1);(0,t.useEffect)(()=>{h()},[e]);let h=async()=>{try{c(!0),u(null);let a=await fetch(`/api/trades/${e}/updates`,{headers:{"x-user-id":"demo-user"}});if(!a.ok)throw Error("Failed to load trade updates");let t=await a.json();o(t)}catch(e){console.error("Error loading trade updates:",e),u(e instanceof Error?e.message:"Failed to load updates")}finally{c(!1)}};return n?(0,a.jsx)(l.default,{className:`p-6 ${s}`,children:(0,a.jsxs)("div",{className:"flex items-center justify-center py-8",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"}),(0,a.jsx)("span",{className:"ml-3 text-gray-600 dark:text-gray-400",children:"Loading updates..."})]})}):x?(0,a.jsx)(l.default,{className:`p-6 ${s}`,children:(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)("div",{className:"text-red-500 mb-2",children:"Failed to load trade updates"}),(0,a.jsx)("button",{onClick:h,className:"text-blue-600 hover:text-blue-700 underline",children:"Try again"})]})}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(l.default,{className:`p-6 ${s}`,children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"w-10 h-10 bg-blue-100 dark:bg-blue-900 rounded-lg flex items-center justify-center",children:(0,a.jsx)(r.FiClock,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Trade Updates"}),(0,a.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[d.length," update",1!==d.length?"s":""," recorded"]})]})]}),(0,a.jsxs)("button",{onClick:()=>m(!0),className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors",children:[(0,a.jsx)(r.FiEdit3,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:"Add Update"})]})]}),0===d.length?(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)(r.FiClock,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),(0,a.jsx)("h4",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"No updates yet"}),(0,a.jsx)("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"Record changes and observations as the trade progresses"}),(0,a.jsxs)("button",{onClick:()=>m(!0),className:"inline-flex items-center space-x-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors",children:[(0,a.jsx)(r.FiPlus,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:"Add First Update"})]})]}):(0,a.jsx)("div",{className:"space-y-4",children:d.map((e,t)=>{let s,l,d,o,n,c=y[e.action]||r.FiMinus;return(0,a.jsx)(i.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1*t},className:"border border-gray-200 dark:border-gray-700 rounded-lg p-4 hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors",children:(0,a.jsx)("div",{className:"flex items-start justify-between",children:(0,a.jsxs)("div",{className:"flex items-start space-x-4 flex-1",children:[(0,a.jsxs)("div",{className:`flex-shrink-0 px-3 py-1 rounded-full text-xs font-medium ${f[e.action]||f.none}`,children:[(0,a.jsx)(c,{className:"w-3 h-3 inline mr-1"}),e.action.replace("_"," ").replace(/\b\w/g,e=>e.toUpperCase())]}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,a.jsx)("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:(s=new Date(e.timestamp),d=Math.floor((l=new Date().getTime()-s.getTime())/6e4),o=Math.floor(l/36e5),n=Math.floor(l/864e5),d<1?"Just now":d<60?`${d}m ago`:o<24?`${o}h ago`:n<7?`${n}d ago`:s.toLocaleDateString())}),e.reason&&(0,a.jsx)("span",{className:"text-xs bg-gray-100 dark:bg-gray-700 px-2 py-1 rounded",children:j[e.reason]||e.reason})]}),e.emotionalState&&(0,a.jsx)("div",{className:"mb-2",children:(0,a.jsxs)("span",{className:`inline-block px-2 py-1 rounded-full text-xs font-medium ${v[e.emotionalState]||"bg-gray-100 text-gray-800"}`,children:["Feeling: ",e.emotionalState.replace(/\b\w/g,e=>e.toUpperCase())]})}),e.behavior&&e.behavior.length>0&&(0,a.jsx)("div",{className:"mb-2",children:(0,a.jsx)("div",{className:"flex flex-wrap gap-1",children:e.behavior.map(e=>(0,a.jsx)("span",{className:"inline-block px-2 py-1 bg-purple-100 dark:bg-purple-900 text-purple-800 dark:text-purple-200 rounded text-xs",children:e.replace(/\b\w/g,e=>e.toUpperCase())},e))})}),e.notes&&(0,a.jsx)("div",{className:"text-sm text-gray-700 dark:text-gray-300 bg-gray-50 dark:bg-gray-800 p-3 rounded-lg",children:e.notes})]})]})})},e.id)})})]}),(0,a.jsx)(p,{isOpen:g,onClose:()=>m(!1),tradeId:e,onUpdateAdded:e=>{o(a=>[...a,e].sort((e,a)=>new Date(e.timestamp).getTime()-new Date(a.timestamp).getTime()))},existingUpdates:d})]})}let N=[{value:"yes",label:"Yes",description:"Fully followed the plan"},{value:"mostly",label:"Mostly",description:"Minor deviations only"},{value:"no",label:"No",description:"Significant deviations"}],w=[{value:"calm",label:"Calm",color:"bg-green-100 text-green-800"},{value:"confident",label:"Confident",color:"bg-blue-100 text-blue-800"},{value:"anxious",label:"Anxious",color:"bg-yellow-100 text-yellow-800"},{value:"hesitant",label:"Hesitant",color:"bg-orange-100 text-orange-800"},{value:"overconfident",label:"Overconfident",color:"bg-purple-100 text-purple-800"},{value:"fearful",label:"Fearful",color:"bg-red-100 text-red-800"},{value:"impulsive",label:"Impulsive",color:"bg-pink-100 text-pink-800"},{value:"detached",label:"Detached",color:"bg-gray-100 text-gray-800"}],S=[{value:"disciplined",label:"Disciplined",description:"Followed all rules"},{value:"patient",label:"Patient",description:"Waited for proper setup"},{value:"focused",label:"Focused",description:"Maintained attention"},{value:"impulsive",label:"Impulsive",description:"Acted without thinking"},{value:"fearful",label:"Fearful",description:"Avoided necessary actions"},{value:"greedy",label:"Greedy",description:"Took excessive risk"},{value:"distracted",label:"Distracted",description:"Lost focus"},{value:"overconfident",label:"Overconfident",description:"Took unnecessary risks"}];function F({tradeId:e,onReflectionComplete:s,className:i=""}){let[o,n]=(0,t.useState)(!1),[c,x]=(0,t.useState)(!1),[u,g]=(0,t.useState)({followedPlan:"",rulesRespected:"",emotionalSummary:[],behavioralOutcomes:[],whatWentRight:"",whatWentWrong:"",lessonLearned:"",ruleToReinforce:""});(0,t.useEffect)(()=>{m()},[e]);let m=async()=>{try{n(!0);let a=await fetch(`/api/trades/${e}/reflection`,{headers:{"x-user-id":"demo-user"}});if(a.ok){let e=await a.json();g({followedPlan:e.followedPlan||"",rulesRespected:e.rulesRespected||"",emotionalSummary:e.emotionalSummary?JSON.parse(e.emotionalSummary):[],behavioralOutcomes:e.behavioralOutcomes?JSON.parse(e.behavioralOutcomes):[],whatWentRight:e.whatWentRight||"",whatWentWrong:e.whatWentWrong||"",lessonLearned:e.lessonLearned||"",ruleToReinforce:e.ruleToReinforce||""})}}catch(e){console.error("Failed to load reflection:",e)}finally{n(!1)}},h=async a=>{if(a.preventDefault(),!u.followedPlan||!u.rulesRespected)return void d.default.error("Please complete the execution quality assessment");x(!0);try{let a=await fetch(`/api/trades/${e}/reflection`,{method:"POST",headers:{"Content-Type":"application/json","x-user-id":"demo-user"},body:JSON.stringify({followedPlan:u.followedPlan,rulesRespected:u.rulesRespected,emotionalSummary:u.emotionalSummary,behavioralOutcomes:u.behavioralOutcomes,whatWentRight:u.whatWentRight,whatWentWrong:u.whatWentWrong,lessonLearned:u.lessonLearned,ruleToReinforce:u.ruleToReinforce})});if(!a.ok){let e=await a.json();throw Error(e.error||"Failed to save reflection")}let t=await a.json();d.default.success("Reflection saved successfully"),s?.(t)}catch(e){console.error("Error saving reflection:",e),d.default.error(e instanceof Error?e.message:"Failed to save reflection")}finally{x(!1)}};return o?(0,a.jsx)(l.default,{className:`p-6 ${i}`,children:(0,a.jsxs)("div",{className:"flex items-center justify-center py-8",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"}),(0,a.jsx)("span",{className:"ml-3 text-gray-600 dark:text-gray-400",children:"Loading reflection..."})]})}):(0,a.jsxs)(l.default,{className:`p-6 ${i}`,children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3 mb-6",children:[(0,a.jsx)("div",{className:"w-10 h-10 bg-green-100 dark:bg-green-900 rounded-lg flex items-center justify-center",children:(0,a.jsx)(r.FiBookOpen,{className:"w-5 h-5 text-green-600 dark:text-green-400"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Post-Trade Reflection"}),(0,a.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Analyze what happened and learn from the experience"})]})]}),(0,a.jsxs)("form",{onSubmit:h,className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Did you follow your trading plan?"}),(0,a.jsx)("div",{className:"space-y-2",children:N.map(e=>(0,a.jsxs)("label",{className:`flex items-center space-x-3 p-3 rounded-lg border-2 cursor-pointer transition-all ${u.followedPlan===e.value?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"}`,children:[(0,a.jsx)("input",{type:"radio",name:"followedPlan",value:e.value,checked:u.followedPlan===e.value,onChange:e=>g(a=>({...a,followedPlan:e.target.value})),className:"text-blue-600"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium text-gray-900 dark:text-white",children:e.label}),(0,a.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:e.description})]})]},e.value))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Did you respect your trading rules?"}),(0,a.jsx)("div",{className:"space-y-2",children:N.map(e=>(0,a.jsxs)("label",{className:`flex items-center space-x-3 p-3 rounded-lg border-2 cursor-pointer transition-all ${u.rulesRespected===e.value?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"}`,children:[(0,a.jsx)("input",{type:"radio",name:"rulesRespected",value:e.value,checked:u.rulesRespected===e.value,onChange:e=>g(a=>({...a,rulesRespected:e.target.value})),className:"text-blue-600"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium text-gray-900 dark:text-white",children:e.label}),(0,a.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:e.description})]})]},`rules-${e.value}`))})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"How did you feel during and after the trade?"}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:w.map(e=>(0,a.jsx)("button",{type:"button",onClick:()=>{var a;return a=e.value,void g(e=>({...e,emotionalSummary:e.emotionalSummary.includes(a)?e.emotionalSummary.filter(e=>e!==a):[...e.emotionalSummary,a]}))},className:`px-3 py-2 rounded-full text-sm font-medium transition-all ${u.emotionalSummary.includes(e.value)?e.color+" ring-2 ring-offset-2 ring-blue-500":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"}`,children:e.label},e.value))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"How did you behave during this trade?"}),(0,a.jsx)("div",{className:"grid grid-cols-2 gap-3",children:S.map(e=>(0,a.jsxs)("label",{className:`flex items-start space-x-2 p-3 rounded-lg border cursor-pointer transition-all ${u.behavioralOutcomes.includes(e.value)?"border-green-500 bg-green-50 dark:bg-green-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"}`,children:[(0,a.jsx)("input",{type:"checkbox",checked:u.behavioralOutcomes.includes(e.value),onChange:()=>{var a;return a=e.value,void g(e=>({...e,behavioralOutcomes:e.behavioralOutcomes.includes(a)?e.behavioralOutcomes.filter(e=>e!==a):[...e.behavioralOutcomes,a]}))},className:"mt-0.5"}),(0,a.jsxs)("div",{className:"text-xs",children:[(0,a.jsx)("div",{className:"font-medium text-gray-900 dark:text-white",children:e.label}),(0,a.jsx)("div",{className:"text-gray-600 dark:text-gray-400",children:e.description})]})]},e.value))})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"What went right?"}),(0,a.jsx)("textarea",{value:u.whatWentRight,onChange:e=>g(a=>({...a,whatWentRight:e.target.value})),placeholder:"What did you do well in this trade?",rows:4,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"What went wrong?"}),(0,a.jsx)("textarea",{value:u.whatWentWrong,onChange:e=>g(a=>({...a,whatWentWrong:e.target.value})),placeholder:"What could you have done better?",rows:4,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Key lesson learned"}),(0,a.jsx)("textarea",{value:u.lessonLearned,onChange:e=>g(a=>({...a,lessonLearned:e.target.value})),placeholder:"What's the most important takeaway from this trade?",rows:3,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Rule to reinforce"}),(0,a.jsx)("textarea",{value:u.ruleToReinforce,onChange:e=>g(a=>({...a,ruleToReinforce:e.target.value})),placeholder:"Which trading rule should you focus on reinforcing?",rows:3,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]})]}),(0,a.jsx)("div",{className:"flex justify-end pt-4 border-t border-gray-200 dark:border-gray-700",children:(0,a.jsx)("button",{type:"submit",disabled:c,className:"flex items-center space-x-2 px-6 py-2 bg-green-600 hover:bg-green-700 disabled:bg-green-400 text-white rounded-lg transition-colors",children:c?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),(0,a.jsx)("span",{children:"Saving..."})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(r.FiSave,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:"Save Reflection"})]})})})]})]})}function C({onRecordingSaved:e}){let s=(0,t.useRef)(null),l=(0,t.useRef)([]),[i,o]=(0,t.useState)(!1),[n,c]=(0,t.useState)(0),[x,u]=(0,t.useState)([]),[g,m]=(0,t.useState)(null);(0,t.useEffect)(()=>{let e;return i&&(e=setInterval(()=>{c(e=>e+1)},1e3)),()=>clearInterval(e)},[i]);let h=async()=>{try{let a=await navigator.mediaDevices.getUserMedia({audio:!0});s.current=new MediaRecorder(a),l.current=[],s.current.ondataavailable=e=>{l.current.push(e.data)},s.current.onstop=()=>{(async()=>{let a=new Blob(l.current,{type:"audio/webm"}),t=URL.createObjectURL(a),r={id:Date.now().toString(),url:t,duration:n,timestamp:new Date,uploaded:!1};u(e=>[r,...e]),e?.(t);try{let e=new FormData;e.append("file",a,`voice-${Date.now()}.webm`);let t=await fetch("/api/voice-notes",{method:"POST",body:e,headers:{"x-user-id":"demo-user"}});if(t.ok){let e=await t.json();e?.url?u(a=>a.map(a=>a.id===r.id?{...a,url:e.url,uploaded:!0}:a)):u(e=>e.map(e=>e.id===r.id?{...e,uploaded:!0}:e)),d.default.success("Voice note uploaded")}else(0,d.default)("Saved locally (upload failed)",{icon:"⚠️"})}catch(e){console.error("Voice upload failed",e),(0,d.default)("Saved locally (upload failed)",{icon:"⚠️"})}})()},s.current.start(),o(!0),c(0)}catch(e){d.default.error("Unable to access microphone"),console.error(e)}},b=e=>{let a=Math.floor(e/60);return`${a}:${(e%60).toString().padStart(2,"0")}`};return(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"bg-white dark:bg-slate-800 rounded-lg p-6 border border-gray-200 dark:border-slate-700",children:[(0,a.jsx)("h3",{className:"text-lg font-bold text-gray-900 dark:text-white mb-4",children:"Voice Notes"}),(0,a.jsx)("div",{className:"flex items-center gap-4 mb-4 flex-wrap",children:i?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("button",{onClick:()=>{s.current&&i&&(s.current.stop(),o(!1),s.current.stream.getTracks().forEach(e=>e.stop()))},className:"flex items-center gap-2 bg-red-600 hover:bg-red-700 text-white font-semibold py-3 px-4 rounded-lg transition-colors","aria-label":"Stop recording","aria-live":"polite",children:[(0,a.jsx)(r.FiStopCircle,{className:"w-5 h-5"}),"Stop"]}),(0,a.jsxs)("div",{className:"text-lg font-bold text-red-600 dark:text-red-400","aria-live":"polite",children:["Recording: ",b(n)]}),(0,a.jsx)("div",{className:"flex-1 h-1 bg-red-300 dark:bg-red-900 rounded-full relative overflow-hidden min-w-[100px]",children:(0,a.jsx)("div",{className:"h-full bg-red-600 animate-pulse",style:{width:"30%"}})})]}):(0,a.jsxs)("button",{onClick:h,className:"flex items-center gap-2 bg-red-600 hover:bg-red-700 text-white font-semibold py-3 px-4 rounded-lg transition-colors","aria-label":"Start recording voice note",children:[(0,a.jsx)(r.FiMic,{className:"w-5 h-5"}),"Start Recording"]})}),x.length>0&&(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("h4",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300",children:["Recordings (",x.length,")"]}),x.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between bg-gray-50 dark:bg-slate-700 p-3 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 flex-1",children:[(0,a.jsx)("button",{onClick:()=>m(g===e.id?null:e.id),className:"p-2 rounded-lg bg-blue-600 hover:bg-blue-700 text-white transition-colors","aria-label":g===e.id?"Pause recording":"Play recording",children:(0,a.jsx)(r.FiPlay,{className:"w-4 h-4"})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:e.timestamp.toLocaleTimeString()}),(0,a.jsxs)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Duration: ",b(e.duration),e.uploaded&&(0,a.jsx)("span",{className:"ml-2",children:"✓ Uploaded"})]})]})]}),(0,a.jsx)("button",{onClick:()=>{var a;return a=e.id,void u(e=>e.filter(e=>e.id!==a))},className:"p-2 rounded-lg text-red-600 dark:text-red-400 hover:bg-red-100 dark:hover:bg-red-900/30 transition-colors","aria-label":`Delete recording from ${e.timestamp.toLocaleTimeString()}`,children:(0,a.jsx)(r.FiTrash2,{className:"w-4 h-4"})})]},e.id))]}),0===x.length&&!i&&(0,a.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 text-center py-6",children:"No recordings yet. Start recording to add voice notes to your trades."})]}),g&&(0,a.jsx)("audio",{src:x.find(e=>e.id===g)?.url,autoPlay:!0,controls:!0,className:"w-full"},g)]})}function T({onScreenshotAdded:e}){let s=(0,t.useRef)(null),[l,i]=(0,t.useState)([]),[o,n]=(0,t.useState)(null),[c,x]=(0,t.useState)(""),u=async a=>{let t=a.currentTarget.files;if(t){for(let a of Array.from(t))try{let t=new FileReader;t.onload=a=>{let t=a.target?.result,r={id:Date.now().toString()+Math.random(),url:t,caption:"",timestamp:new Date};i(e=>[r,...e]),e?.(t),d.default.success("Screenshot uploaded")},t.readAsDataURL(a)}catch(e){d.default.error("Failed to upload screenshot"),console.error(e)}s.current&&(s.current.value="")}},g=(e,a)=>{i(t=>t.map(t=>t.id===e?{...t,caption:a}:t)),n(null)};return(0,a.jsx)("div",{className:"space-y-4",children:(0,a.jsxs)("div",{className:"bg-white dark:bg-slate-800 rounded-lg p-6 border border-gray-200 dark:border-slate-700",children:[(0,a.jsx)("h3",{className:"text-lg font-bold text-gray-900 dark:text-white mb-4",children:"Trade Setup Screenshots"}),(0,a.jsxs)("button",{onClick:()=>s.current?.click(),className:"w-full border-2 border-dashed border-gray-300 dark:border-slate-600 rounded-lg p-6 text-center cursor-pointer hover:bg-gray-50 dark:hover:bg-slate-700/50 transition-colors","aria-label":"Upload screenshot by clicking or dragging files",children:[(0,a.jsx)(r.FiUpload,{className:"w-8 h-8 mx-auto mb-2 text-gray-600 dark:text-gray-400"}),(0,a.jsx)("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:"Click to upload or drag & drop"}),(0,a.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"PNG, JPG, GIF up to 10MB"}),(0,a.jsx)("input",{ref:s,type:"file",multiple:!0,accept:"image/*",onChange:u,className:"hidden","aria-label":"File input for screenshots"})]}),l.length>0&&(0,a.jsxs)("div",{className:"mt-6",children:[(0,a.jsxs)("h4",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-4",children:["Uploads (",l.length,")"]}),(0,a.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:l.map(e=>(0,a.jsxs)("div",{className:"relative group bg-gray-100 dark:bg-slate-700 rounded-lg overflow-hidden",children:[(0,a.jsx)("img",{src:e.url,alt:"Trade setup",className:"w-full h-40 object-cover"}),(0,a.jsxs)("div",{className:"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-between p-2",children:[(0,a.jsx)("button",{onClick:()=>{var a,t;let r;return a=e.url,t=e.timestamp,void((r=document.createElement("a")).href=a,r.download=`trade-setup-${t.toISOString()}.png`,document.body.appendChild(r),r.click(),document.body.removeChild(r))},className:"p-2 rounded-lg bg-blue-600 hover:bg-blue-700 text-white transition-colors",title:"Download",children:(0,a.jsx)(r.FiDownload,{className:"w-4 h-4"})}),(0,a.jsx)("button",{onClick:()=>{var a;return a=e.id,void i(e=>e.filter(e=>e.id!==a))},className:"p-2 rounded-lg bg-red-600 hover:bg-red-700 text-white transition-colors",title:"Delete",children:(0,a.jsx)(r.FiX,{className:"w-4 h-4"})})]}),(0,a.jsx)("div",{className:"p-3 bg-white dark:bg-slate-800 border-t border-gray-200 dark:border-slate-600",children:o===e.id?(0,a.jsx)("input",{autoFocus:!0,type:"text",value:c,onChange:e=>x(e.target.value),onBlur:()=>g(e.id,c),onKeyPress:a=>{"Enter"===a.key&&g(e.id,c)},placeholder:"Add caption...",className:"w-full px-2 py-1 border border-gray-300 dark:border-slate-600 rounded bg-white dark:bg-slate-700 text-gray-900 dark:text-white text-xs focus:ring-2 focus:ring-blue-500 outline-none"}):(0,a.jsx)("p",{onClick:()=>{n(e.id),x(e.caption)},className:"text-xs text-gray-600 dark:text-gray-400 cursor-pointer hover:text-gray-900 dark:hover:text-white",children:e.caption||"Click to add caption..."})})]},e.id))})]})]})})}var R=e.i(9876);function P(){let{theme:e,toggleTheme:i}=(0,R.useTheme)(),[o]=(0,t.useState)(()=>!0),[n,c]=(0,t.useState)(null),[u,g]=(0,t.useState)([]),[m,h]=(0,t.useState)(!0),[b,p]=(0,t.useState)("checklist");(0,t.useEffect)(()=>{o&&y()},[o]);let y=async()=>{try{h(!0);let e=await fetch("/api/trades",{headers:{"x-user-id":"demo-user"}});if(!e.ok)throw Error("Failed to load trades");let a=await e.json();g(a)}catch(e){console.error("Error loading trades:",e),d.default.error("Failed to load trades")}finally{h(!1)}},f=u.find(e=>e.id===n),v=[{id:"checklist",label:"Pre-Trade Checklist",icon:r.FiCheckCircle},{id:"updates",label:"Trade Updates",icon:r.FiClock},{id:"reflection",label:"Post-Trade Reflection",icon:r.FiBookOpen},{id:"media",label:"Media & Notes",icon:r.FiTrendingUp}];return o?(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:[(0,a.jsx)(s.default,{onThemeToggle:i,currentTheme:e}),(0,a.jsxs)("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Trade Lifecycle Review"}),(0,a.jsx)("p",{className:"mt-2 text-gray-600 dark:text-gray-400",children:"Complete pre-trade preparation, track in-trade decisions, and reflect on outcomes"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-8",children:[(0,a.jsx)("div",{className:"lg:col-span-1",children:(0,a.jsxs)(l.default,{className:"p-6",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Recent Trades"}),(0,a.jsx)("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:m?(0,a.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-500"})}):u.length>0?u.map(e=>(0,a.jsxs)("button",{onClick:()=>c(e.id),className:`w-full text-left p-3 rounded-lg transition-all ${n===e.id?"bg-blue-100 dark:bg-blue-900 border-blue-500":"bg-gray-50 dark:bg-gray-800 hover:bg-gray-100 dark:hover:bg-gray-700"} border`,children:[(0,a.jsxs)("div",{className:"font-medium text-gray-900 dark:text-white",children:[e.pair," ",e.direction]}),(0,a.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:new Date(e.entryTime).toLocaleDateString()}),(0,a.jsx)("div",{className:`text-sm font-medium ${"WIN"===e.outcome?"text-green-600":"LOSS"===e.outcome?"text-red-600":"text-gray-600"}`,children:e.outcome||"Open"})]},e.id)):(0,a.jsx)("p",{className:"text-gray-500 dark:text-gray-400 text-center py-4",children:"No trades yet"})})]})}),(0,a.jsx)("div",{className:"lg:col-span-3",children:f?(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)(l.default,{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:[f.pair," - ",f.direction]}),(0,a.jsx)("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${"closed"===f.status?"bg-green-100 text-green-800":"open"===f.status?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:f.status})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"Entry Price"}),(0,a.jsx)("p",{className:"font-semibold text-gray-900 dark:text-white",children:f.entryPrice.toFixed(5)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"Exit Price"}),(0,a.jsx)("p",{className:"font-semibold text-gray-900 dark:text-white",children:f.exitPrice?.toFixed(5)||"Open"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"P&L"}),(0,a.jsx)("p",{className:`font-semibold ${(f.profitLoss||0)>=0?"text-green-600":"text-red-600"}`,children:f.profitLoss?.toFixed(2)||"N/A"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"Outcome"}),(0,a.jsx)("p",{className:"font-semibold text-gray-900 dark:text-white",children:f.outcome||"Open"})]})]})]}),(0,a.jsx)(l.default,{className:"p-1",children:(0,a.jsx)("div",{className:"flex space-x-1",children:v.map(e=>{let t=e.icon;return(0,a.jsxs)("button",{onClick:()=>p(e.id),className:`flex items-center space-x-2 px-4 py-2 rounded-lg text-sm font-medium transition-all ${b===e.id?"bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-300":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-800"}`,children:[(0,a.jsx)(t,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:e.label})]},e.id)})})}),(0,a.jsxs)("div",{className:"min-h-96",children:["checklist"===b&&(0,a.jsx)(x,{tradeId:f.id,onChecklistComplete:e=>{d.default.success("Pre-trade checklist completed!")}}),"updates"===b&&(0,a.jsx)(k,{tradeId:f.id}),"reflection"===b&&(0,a.jsx)(F,{tradeId:f.id,onReflectionComplete:e=>{d.default.success("Post-trade reflection saved!")}}),"media"===b&&(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)(l.default,{className:"p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Voice Notes"}),(0,a.jsx)(C,{})]}),(0,a.jsxs)(l.default,{className:"p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Screenshots"}),(0,a.jsx)(T,{})]})]})]})]}):(0,a.jsxs)(l.default,{className:"p-12 text-center",children:[(0,a.jsx)(r.FiBookOpen,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),(0,a.jsx)("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-2",children:"Select a Trade to Review"}),(0,a.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"Choose a trade from the sidebar to access the complete lifecycle review"})]})})]})]}),(0,a.jsx)(d.Toaster,{position:"bottom-right"})]}):(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900"})}e.s(["default",()=>P],18924)}]);