(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,51720,e=>{"use strict";var t=e.i(43476),r=e.i(71645),i=e.i(9876),o=e.i(5766),n=e.i(92199);function a(){let{theme:e,toggleTheme:a}=(0,i.useTheme)(),[s,l]=(0,r.useState)(()=>!0),[d,p]=(0,r.useState)([]),[c,g]=(0,r.useState)([]),[x,u]=(0,r.useState)(!0),[h,m]=(0,r.useState)(null);return((0,r.useEffect)(()=>{s&&(async()=>{try{u(!0),m(null);let e=await fetch("/api/trades",{headers:{"x-user-id":"demo-user"}});if(!e.ok){let t=null;try{t=await e.json()}catch(r){t=await e.text()}console.error("Failed to fetch trades:",e.status,t),m("Failed to load trades data"),p([]);return}let t=await e.json();if(!Array.isArray(t)){console.warn("Unexpected trades payload in insights page",t),m("Invalid trades data format"),p([]);return}p(t)}catch(e){console.error("Error fetching trades:",e),m("An error occurred while loading trades")}finally{u(!1)}})()},[s]),(0,r.useEffect)(()=>{if(0===d.length)return;let e=[],t={};d.forEach(e=>{t[e.pair]||(t[e.pair]={wins:0,losses:0,pnl:0}),"WIN"===e.outcome&&t[e.pair].wins++,"LOSS"===e.outcome&&t[e.pair].losses++,t[e.pair].pnl+=e.profitLoss||0});let r=Object.entries(t).sort((e,t)=>t[1].wins-e[1].wins)[0];r&&e.push({type:"strength",title:`${r[0]} is your best pair`,description:`You have a ${Math.round(r[1].wins/(r[1].wins+r[1].losses)*100)}% win rate on ${r[0]}. Consider trading it more often.`,icon:n.FiTrendingUp,color:"text-green-600 dark:text-green-400"});let i=d.filter(e=>e.emotionalState);if(i.length>0){let t={};i.forEach(e=>{t[e.emotionalState||""]||(t[e.emotionalState||""]={wins:0,losses:0}),"WIN"===e.outcome?t[e.emotionalState||""].wins++:t[e.emotionalState||""].losses++});let r=Object.entries(t).sort((e,t)=>t[1].wins-e[1].wins)[0];r&&e.push({type:"pattern",title:`You trade best when ${r[0]}`,description:`${r[1].wins} wins when ${r[0]} vs ${r[1].losses} losses. Remember this state for future trades.`,icon:n.FiZap,color:"text-blue-600 dark:text-blue-400"})}let o=d.filter(e=>"LONG"===e.direction),a=d.filter(e=>"SHORT"===e.direction),s=o.length>0?o.filter(e=>"WIN"===e.outcome).length/o.length*100:0,l=a.length>0?a.filter(e=>"WIN"===e.outcome).length/a.length*100:0;s>l&&s>40&&e.push({type:"improvement",title:"You are better at LONG trades",description:`Long win rate: ${Math.round(s)}% vs Short: ${Math.round(l)}%. Focus more on long setups.`,icon:n.FiTarget,color:"text-green-600 dark:text-green-400"});let p=d.filter(e=>e.mistakes).flatMap(e=>{try{return e.mistakes?JSON.parse(e.mistakes):[]}catch{return[]}});if(p.length>0){let t={};p.forEach(e=>{t[e]=(t[e]||0)+1});let r=Object.entries(t).sort((e,t)=>t[1]-e[1])[0];r&&r[1]>1&&e.push({type:"warning",title:`Repeated mistake: ${r[0]}`,description:`You've made this mistake ${r[1]} times. Create a checklist to prevent this.`,icon:n.FiAlertCircle,color:"text-orange-600 dark:text-orange-400"})}let c=d.filter(e=>{let t=new Date(e.entryTime).getHours();return t>=8&&t<12});if(c.length>5){let t=c.filter(e=>"WIN"===e.outcome).length/c.length*100;t>60&&e.push({type:"pattern",title:"You trade best in the morning",description:`Morning (8am-12pm) win rate: ${Math.round(t)}%. Schedule more trades during this time.`,icon:n.FiTrendingUp,color:"text-yellow-600 dark:text-yellow-400"})}g(e)},[d]),s)?(0,t.jsxs)("div",{style:{minHeight:"100vh",backgroundColor:"var(--background)"},children:[(0,t.jsxs)("main",{style:{maxWidth:"1000px",margin:"0 auto",padding:"32px 16px"},children:[(0,t.jsxs)("div",{style:{marginBottom:"32px"},children:[(0,t.jsx)("h1",{style:{fontSize:"28px",fontWeight:"700",color:"var(--text-primary)",marginBottom:"8px"},children:"AI-Powered Insights"}),(0,t.jsx)("p",{style:{fontSize:"14px",color:"var(--text-secondary)"},children:"Get personalized trading improvements based on your data"})]}),h&&(0,t.jsxs)("div",{style:{marginBottom:"24px",padding:"16px",backgroundColor:"rgba(220, 38, 38, 0.1)",border:"1px solid rgba(220, 38, 38, 0.3)",borderRadius:"8px",display:"flex",alignItems:"center",gap:"12px",color:"var(--loss-color)"},role:"alert",children:[(0,t.jsx)(n.FiAlertCircle,{size:20}),(0,t.jsx)("span",{style:{fontSize:"14px"},children:h})]}),x?(0,t.jsxs)("div",{style:{textAlign:"center",padding:"60px 20px",color:"var(--text-secondary)"},children:[(0,t.jsx)("div",{style:{fontSize:"14px",marginBottom:"16px"},children:"Analyzing your trading data..."}),(0,t.jsx)("div",{style:{width:"40px",height:"40px",border:"2px solid var(--purple-base)",borderTop:"2px solid transparent",borderRadius:"50%",animation:"spin 1s linear infinite",margin:"0 auto"}})]}):c.length>0?(0,t.jsx)(t.Fragment,{children:(0,t.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(300px, 1fr))",gap:"16px",marginBottom:"32px"},children:c.map((e,r)=>{let i=e.icon,o=(()=>{switch(e.type){case"warning":return{bg:"rgba(217, 119, 6, 0.1)",border:"rgba(217, 119, 6, 0.3)"};case"strength":return{bg:"rgba(34, 197, 94, 0.1)",border:"rgba(34, 197, 94, 0.3)"};case"improvement":return{bg:"rgba(59, 130, 246, 0.1)",border:"rgba(59, 130, 246, 0.3)"};default:return{bg:"rgba(139, 92, 246, 0.1)",border:"rgba(139, 92, 246, 0.3)"}}})();return(0,t.jsxs)("div",{style:{backgroundColor:o.bg,border:`1px solid ${o.border}`,borderRadius:"12px",padding:"20px",display:"flex",flexDirection:"column",gap:"12px"},children:[(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[(0,t.jsx)("div",{style:{backgroundColor:"var(--card-bg)",padding:"8px",borderRadius:"8px",display:"flex",alignItems:"center"},children:(0,t.jsx)(i,{size:20,style:{color:(()=>{switch(e.type){case"warning":return"#d97706";case"strength":return"#22c55e";case"improvement":return"#3b82f6";default:return"#a855f7"}})()}})}),(0,t.jsx)("h3",{style:{fontSize:"15px",fontWeight:"600",color:"var(--text-primary)",margin:0},children:e.title})]}),(0,t.jsx)("p",{style:{fontSize:"13px",color:"var(--text-secondary)",margin:0},children:e.description})]},r)})})}):0===d.length?(0,t.jsxs)("div",{style:{textAlign:"center",padding:"60px 20px",backgroundColor:"var(--card-bg)",border:"1px solid var(--card-border)",borderRadius:"12px",color:"var(--text-secondary)"},children:[(0,t.jsx)("p",{style:{fontSize:"16px",marginBottom:"8px",margin:0},children:"No trades available"}),(0,t.jsx)("p",{style:{fontSize:"13px",margin:0},children:"Add some trades to your journal to get AI-powered insights"})]}):(0,t.jsx)("div",{style:{textAlign:"center",padding:"60px 20px",backgroundColor:"var(--card-bg)",border:"1px solid var(--card-border)",borderRadius:"12px",color:"var(--text-secondary)"},children:(0,t.jsx)("p",{style:{fontSize:"16px",margin:0},children:"Not enough data for insights yet"})}),d.length>0&&c.length>0&&(0,t.jsxs)("div",{style:{marginTop:"32px",backgroundColor:"var(--card-bg)",border:"1px solid var(--card-border)",borderRadius:"12px",padding:"24px"},children:[(0,t.jsx)("h2",{style:{fontSize:"16px",fontWeight:"600",color:"var(--text-primary)",marginBottom:"20px",margin:0},children:"Trading Summary"}),(0,t.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(150px, 1fr))",gap:"16px"},children:[(0,t.jsxs)("div",{style:{backgroundColor:"var(--panel-muted)",padding:"16px",borderRadius:"8px"},children:[(0,t.jsx)("p",{style:{fontSize:"12px",color:"var(--text-secondary)",marginBottom:"8px",margin:0},children:"Total Trades"}),(0,t.jsx)("p",{style:{fontSize:"24px",fontWeight:"700",color:"var(--text-primary)",margin:0},children:d.length})]}),(0,t.jsxs)("div",{style:{backgroundColor:"var(--panel-muted)",padding:"16px",borderRadius:"8px"},children:[(0,t.jsx)("p",{style:{fontSize:"12px",color:"var(--text-secondary)",marginBottom:"8px",margin:0},children:"Win Rate"}),(0,t.jsxs)("p",{style:{fontSize:"24px",fontWeight:"700",color:"#22c55e",margin:0},children:[d.length>0?Math.round(d.filter(e=>"WIN"===e.outcome).length/d.length*100):0,"%"]})]}),(0,t.jsxs)("div",{style:{backgroundColor:"var(--panel-muted)",padding:"16px",borderRadius:"8px"},children:[(0,t.jsx)("p",{style:{fontSize:"12px",color:"var(--text-secondary)",marginBottom:"8px",margin:0},children:"Total P&L"}),(0,t.jsx)("p",{style:{fontSize:"24px",fontWeight:"700",color:d.reduce((e,t)=>e+(t.profitLoss||0),0)>=0?"#22c55e":"#ef4444",margin:0},children:(d.reduce((e,t)=>e+(t.profitLoss||0),0)||0).toFixed(2)})]}),(0,t.jsxs)("div",{style:{backgroundColor:"var(--panel-muted)",padding:"16px",borderRadius:"8px"},children:[(0,t.jsx)("p",{style:{fontSize:"12px",color:"var(--text-secondary)",marginBottom:"8px",margin:0},children:"Avg Quality"}),(0,t.jsx)("p",{style:{fontSize:"24px",fontWeight:"700",color:"#fbbf24",margin:0},children:d.filter(e=>e.setupQuality).length>0?(d.filter(e=>e.setupQuality).reduce((e,t)=>e+(t.setupQuality||0),0)/d.filter(e=>e.setupQuality).length).toFixed(1):"N/A"})]})]})]})]}),(0,t.jsx)(o.Toaster,{position:"bottom-right"})]}):(0,t.jsx)("div",{style:{minHeight:"100vh",backgroundColor:"var(--background)"}})}e.s(["default",()=>a])}]);