{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 58, "column": 0}, "map": {"version":3,"sources":["file:///workspaces/Forex-Journal-2/src/lib/api-response.ts"],"sourcesContent":["import { NextResponse } from 'next/server';\n\nexport interface ApiResponse<T = unknown> {\n  success: boolean;\n  data?: T;\n  error?: {\n    code: string;\n    message: string;\n    details?: Record<string, unknown>;\n  };\n  pagination?: {\n    page: number;\n    limit: number;\n    total: number;\n    totalPages: number;\n  };\n}\n\nexport const apiResponse = {\n  success: <T,>(data: T, pagination?: { page: number; limit: number; total: number }, status = 200) => {\n    const response: ApiResponse<T> = { success: true, data };\n    if (pagination) {\n      response.pagination = {\n        ...pagination,\n        totalPages: Math.ceil(pagination.total / pagination.limit),\n      };\n    }\n    return NextResponse.json(response, { status });\n  },\n\n  error: (code: string, message: string, details?: Record<string, unknown>, status = 400) => {\n    const response: ApiResponse = {\n      success: false,\n      error: { code, message, details },\n    };\n    return NextResponse.json(response, { status });\n  },\n\n  validationError: (details: Record<string, unknown>) => {\n    return apiResponse.error('VALIDATION_ERROR', 'Invalid input', details, 400);\n  },\n\n  notFound: (message = 'Resource not found') => {\n    return apiResponse.error('NOT_FOUND', message, undefined, 404);\n  },\n\n  unauthorized: () => {\n    return apiResponse.error('UNAUTHORIZED', 'Unauthorized', undefined, 401);\n  },\n\n  forbidden: () => {\n    return apiResponse.error('FORBIDDEN', 'Access denied', undefined, 403);\n  },\n\n  serverError: (message = 'Internal server error', details?: Record<string, unknown>) => {\n    return apiResponse.error('SERVER_ERROR', message, details, 500);\n  },\n\n  unavailable: () => {\n    return apiResponse.error('SERVICE_UNAVAILABLE', 'Database service unavailable. Using demo data.', undefined, 503);\n  },\n};\n"],"names":[],"mappings":";;;;AAAA;;AAkBO,MAAM,cAAc;IACzB,SAAS,CAAK,MAAS,YAA6D,SAAS,GAAG;QAC9F,MAAM,WAA2B;YAAE,SAAS;YAAM;QAAK;QACvD,IAAI,YAAY;YACd,SAAS,UAAU,GAAG;gBACpB,GAAG,UAAU;gBACb,YAAY,KAAK,IAAI,CAAC,WAAW,KAAK,GAAG,WAAW,KAAK;YAC3D;QACF;QACA,OAAO,gJAAY,CAAC,IAAI,CAAC,UAAU;YAAE;QAAO;IAC9C;IAEA,OAAO,CAAC,MAAc,SAAiB,SAAmC,SAAS,GAAG;QACpF,MAAM,WAAwB;YAC5B,SAAS;YACT,OAAO;gBAAE;gBAAM;gBAAS;YAAQ;QAClC;QACA,OAAO,gJAAY,CAAC,IAAI,CAAC,UAAU;YAAE;QAAO;IAC9C;IAEA,iBAAiB,CAAC;QAChB,OAAO,YAAY,KAAK,CAAC,oBAAoB,iBAAiB,SAAS;IACzE;IAEA,UAAU,CAAC,UAAU,oBAAoB;QACvC,OAAO,YAAY,KAAK,CAAC,aAAa,SAAS,WAAW;IAC5D;IAEA,cAAc;QACZ,OAAO,YAAY,KAAK,CAAC,gBAAgB,gBAAgB,WAAW;IACtE;IAEA,WAAW;QACT,OAAO,YAAY,KAAK,CAAC,aAAa,iBAAiB,WAAW;IACpE;IAEA,aAAa,CAAC,UAAU,uBAAuB,EAAE;QAC/C,OAAO,YAAY,KAAK,CAAC,gBAAgB,SAAS,SAAS;IAC7D;IAEA,aAAa;QACX,OAAO,YAAY,KAAK,CAAC,uBAAuB,kDAAkD,WAAW;IAC/G;AACF"}},
    {"offset": {"line": 116, "column": 0}, "map": {"version":3,"sources":["file:///workspaces/Forex-Journal-2/src/lib/validation.ts"],"sourcesContent":["import { z } from 'zod';\n\n// Trade schemas\nexport const TradeInputSchema = z.object({\n  pair: z.string().min(1, 'Pair is required'),\n  direction: z.enum(['LONG', 'SHORT']),\n  entryPrice: z.number().positive('Entry price must be positive'),\n  exitPrice: z.number().positive().optional().nullable(),\n  entryTime: z.string().or(z.date()),\n  exitTime: z.string().or(z.date()).optional().nullable(),\n  outcome: z.enum(['WIN', 'LOSS', 'BREAKEVEN', 'OPEN']).optional(),\n  profitLoss: z.number().optional().nullable(),\n  profitLossPercent: z.number().optional().nullable(),\n  volume: z.number().optional().nullable(),\n  stopLoss: z.number().optional().nullable(),\n  takeProfit: z.number().optional().nullable(),\n  riskAmount: z.number().optional().nullable(),\n  riskPercent: z.number().optional().nullable(),\n  riskRewardRatio: z.number().optional().nullable(),\n  account: z.string().optional(),\n  broker: z.string().optional(),\n  accountBalance: z.number().optional().nullable(),\n  accountEquity: z.number().optional().nullable(),\n  emotionalState: z.string().optional(),\n  strategy: z.string().optional(),\n  setupQuality: z.number().min(1).max(10).optional(),\n  notes: z.string().optional(),\n  whatLearned: z.string().optional(),\n  mistakes: z.string().optional(),\n});\n\nexport const TradeUpdateSchema = TradeInputSchema.partial();\n\nexport const PaginationSchema = z.object({\n  page: z.number().int().positive().default(1),\n  limit: z.number().int().positive().default(50),\n  offset: z.number().int().nonnegative().optional(),\n});\n\nexport const DailyGoalSchema = z.object({\n  date: z.string(),\n  goals: z.array(z.string()).default([]),\n  notes: z.string().optional(),\n});\n\nexport const VoiceNoteSchema = z.object({\n  tradeId: z.string().optional().nullable(),\n  duration: z.number().optional(),\n  transcript: z.string().optional().nullable(),\n});\n\nexport const ScreenshotSchema = z.object({\n  tradeId: z.string().optional().nullable(),\n  caption: z.string().optional().nullable(),\n});\n\n// Type exports\nexport type TradeInput = z.infer<typeof TradeInputSchema>;\nexport type TradeUpdate = z.infer<typeof TradeUpdateSchema>;\nexport type PaginationParams = z.infer<typeof PaginationSchema>;\nexport type DailyGoal = z.infer<typeof DailyGoalSchema>;\nexport type VoiceNote = z.infer<typeof VoiceNoteSchema>;\nexport type Screenshot = z.infer<typeof ScreenshotSchema>;\n"],"names":[],"mappings":";;;;;;;;;;;;;;AAAA;;AAGO,MAAM,mBAAmB,yKAAC,CAAC,MAAM,CAAC;IACvC,MAAM,yKAAC,CAAC,MAAM,GAAG,GAAG,CAAC,GAAG;IACxB,WAAW,yKAAC,CAAC,IAAI,CAAC;QAAC;QAAQ;KAAQ;IACnC,YAAY,yKAAC,CAAC,MAAM,GAAG,QAAQ,CAAC;IAChC,WAAW,yKAAC,CAAC,MAAM,GAAG,QAAQ,GAAG,QAAQ,GAAG,QAAQ;IACpD,WAAW,yKAAC,CAAC,MAAM,GAAG,EAAE,CAAC,yKAAC,CAAC,IAAI;IAC/B,UAAU,yKAAC,CAAC,MAAM,GAAG,EAAE,CAAC,yKAAC,CAAC,IAAI,IAAI,QAAQ,GAAG,QAAQ;IACrD,SAAS,yKAAC,CAAC,IAAI,CAAC;QAAC;QAAO;QAAQ;QAAa;KAAO,EAAE,QAAQ;IAC9D,YAAY,yKAAC,CAAC,MAAM,GAAG,QAAQ,GAAG,QAAQ;IAC1C,mBAAmB,yKAAC,CAAC,MAAM,GAAG,QAAQ,GAAG,QAAQ;IACjD,QAAQ,yKAAC,CAAC,MAAM,GAAG,QAAQ,GAAG,QAAQ;IACtC,UAAU,yKAAC,CAAC,MAAM,GAAG,QAAQ,GAAG,QAAQ;IACxC,YAAY,yKAAC,CAAC,MAAM,GAAG,QAAQ,GAAG,QAAQ;IAC1C,YAAY,yKAAC,CAAC,MAAM,GAAG,QAAQ,GAAG,QAAQ;IAC1C,aAAa,yKAAC,CAAC,MAAM,GAAG,QAAQ,GAAG,QAAQ;IAC3C,iBAAiB,yKAAC,CAAC,MAAM,GAAG,QAAQ,GAAG,QAAQ;IAC/C,SAAS,yKAAC,CAAC,MAAM,GAAG,QAAQ;IAC5B,QAAQ,yKAAC,CAAC,MAAM,GAAG,QAAQ;IAC3B,gBAAgB,yKAAC,CAAC,MAAM,GAAG,QAAQ,GAAG,QAAQ;IAC9C,eAAe,yKAAC,CAAC,MAAM,GAAG,QAAQ,GAAG,QAAQ;IAC7C,gBAAgB,yKAAC,CAAC,MAAM,GAAG,QAAQ;IACnC,UAAU,yKAAC,CAAC,MAAM,GAAG,QAAQ;IAC7B,cAAc,yKAAC,CAAC,MAAM,GAAG,GAAG,CAAC,GAAG,GAAG,CAAC,IAAI,QAAQ;IAChD,OAAO,yKAAC,CAAC,MAAM,GAAG,QAAQ;IAC1B,aAAa,yKAAC,CAAC,MAAM,GAAG,QAAQ;IAChC,UAAU,yKAAC,CAAC,MAAM,GAAG,QAAQ;AAC/B;AAEO,MAAM,oBAAoB,iBAAiB,OAAO;AAElD,MAAM,mBAAmB,yKAAC,CAAC,MAAM,CAAC;IACvC,MAAM,yKAAC,CAAC,MAAM,GAAG,GAAG,GAAG,QAAQ,GAAG,OAAO,CAAC;IAC1C,OAAO,yKAAC,CAAC,MAAM,GAAG,GAAG,GAAG,QAAQ,GAAG,OAAO,CAAC;IAC3C,QAAQ,yKAAC,CAAC,MAAM,GAAG,GAAG,GAAG,WAAW,GAAG,QAAQ;AACjD;AAEO,MAAM,kBAAkB,yKAAC,CAAC,MAAM,CAAC;IACtC,MAAM,yKAAC,CAAC,MAAM;IACd,OAAO,yKAAC,CAAC,KAAK,CAAC,yKAAC,CAAC,MAAM,IAAI,OAAO,CAAC,EAAE;IACrC,OAAO,yKAAC,CAAC,MAAM,GAAG,QAAQ;AAC5B;AAEO,MAAM,kBAAkB,yKAAC,CAAC,MAAM,CAAC;IACtC,SAAS,yKAAC,CAAC,MAAM,GAAG,QAAQ,GAAG,QAAQ;IACvC,UAAU,yKAAC,CAAC,MAAM,GAAG,QAAQ;IAC7B,YAAY,yKAAC,CAAC,MAAM,GAAG,QAAQ,GAAG,QAAQ;AAC5C;AAEO,MAAM,mBAAmB,yKAAC,CAAC,MAAM,CAAC;IACvC,SAAS,yKAAC,CAAC,MAAM,GAAG,QAAQ,GAAG,QAAQ;IACvC,SAAS,yKAAC,CAAC,MAAM,GAAG,QAAQ,GAAG,QAAQ;AACzC"}},
    {"offset": {"line": 191, "column": 0}, "map": {"version":3,"sources":["file:///workspaces/Forex-Journal-2/src/lib/advanced-analytics-calculations.ts"],"sourcesContent":["import { PrismaClient } from '@prisma/client';\n\nexport interface TradeData {\n  id: string;\n  userId: string;\n  pair: string;\n  direction: string;\n  entryPrice: number;\n  exitPrice?: number | null;\n  entryTime: Date;\n  exitTime?: Date | null;\n  volume: number;\n  stopLoss?: number | null;\n  takeProfit?: number | null;\n  profitLoss?: number | null;\n  outcome?: string | null;\n  strategyId?: string | null;\n  marketConditionId?: string | null;\n  emotionalStateId?: string | null;\n  notes?: string | null;\n  tags?: string[];\n  emotionalDrift?: any;\n  learningPoints?: string[];\n  setupQuality?: number | null;\n  executionQuality?: number | null;\n  marketContext?: any;\n  riskRewardRatio?: number | null;\n  holdingTimeMinutes?: number | null;\n}\n\nexport interface DecisionQualityFactors {\n  setupQuality: number;\n  timingQuality: number;\n  riskManagement: number;\n  strategyAlignment: number;\n  marketConditionMatch: number;\n}\n\nexport interface ExecutionQualityFactors {\n  entryPrecision: number;\n  stopPlacement: number;\n  positionSizing: number;\n  exitDiscipline: number;\n  emotionalControl: number;\n}\n\nexport interface EmotionalCostMetrics {\n  emotionalCostScore: number;\n  stressAccumulation: number;\n  decisionQualityImpact: number;\n  futurePerformanceImpact: number;\n  recoveryTimeMinutes: number;\n}\n\n/**\n * Calculate decision quality score based on trade characteristics\n */\nexport function calculateDecisionQuality(trade: TradeData): {\n  score: number;\n  factors: DecisionQualityFactors;\n  mistakes: string[];\n  strengths: string[];\n  learningPoints: string[];\n  recommendations: string[];\n} {\n  let score = 0;\n  const factors: DecisionQualityFactors = {\n    setupQuality: 0,\n    timingQuality: 0,\n    riskManagement: 0,\n    strategyAlignment: 0,\n    marketConditionMatch: 0,\n  };\n\n  const mistakes: string[] = [];\n  const strengths: string[] = [];\n  const learningPoints: string[] = [];\n  const recommendations: string[] = [];\n\n  // Setup Quality (0-10)\n  if (trade.setupQuality) {\n    factors.setupQuality = Math.max(0, Math.min(10, trade.setupQuality));\n  } else {\n    // Infer from trade characteristics\n    factors.setupQuality = 6; // Default neutral\n    if (trade.riskRewardRatio && trade.riskRewardRatio >= 2) {\n      factors.setupQuality += 2;\n      strengths.push('Good risk-reward ratio');\n    }\n    if (trade.stopLoss && trade.takeProfit) {\n      factors.setupQuality += 1;\n      strengths.push('Clear stop and target levels');\n    }\n  }\n\n  // Timing Quality (0-10)\n  factors.timingQuality = 7; // Default good timing\n  if (trade.holdingTimeMinutes) {\n    if (trade.holdingTimeMinutes < 5) {\n      factors.timingQuality -= 2;\n      mistakes.push('Very short holding time');\n      learningPoints.push('Allow trades more time to develop');\n    } else if (trade.holdingTimeMinutes > 480) { // 8 hours\n      factors.timingQuality -= 1;\n      mistakes.push('Very long holding time');\n      learningPoints.push('Consider taking profits earlier');\n    }\n  }\n\n  // Risk Management (0-10)\n  factors.riskManagement = 5; // Default\n  if (trade.stopLoss) {\n    factors.riskManagement += 2;\n    strengths.push('Stop loss in place');\n  } else {\n    factors.riskManagement -= 3;\n    mistakes.push('No stop loss');\n    learningPoints.push('Always use stop losses');\n    recommendations.push('Implement mandatory stop loss policy');\n  }\n\n  if (trade.riskRewardRatio) {\n    if (trade.riskRewardRatio >= 2) {\n      factors.riskManagement += 2;\n      strengths.push('Favorable risk-reward ratio');\n    } else if (trade.riskRewardRatio < 1) {\n      factors.riskManagement -= 2;\n      mistakes.push('Poor risk-reward ratio');\n      learningPoints.push('Only take trades with RR >= 2:1');\n    }\n  }\n\n  // Strategy Alignment (0-10)\n  factors.strategyAlignment = trade.strategyId ? 8 : 4;\n  if (trade.strategyId) {\n    strengths.push('Strategy-based trade');\n  } else {\n    mistakes.push('No strategy specified');\n    learningPoints.push('Always trade with a defined strategy');\n    recommendations.push('Create and follow trading strategies');\n  }\n\n  // Market Condition Match (0-10)\n  factors.marketConditionMatch = trade.marketConditionId ? 8 : 5;\n  if (trade.marketConditionId) {\n    strengths.push('Market conditions considered');\n  }\n\n  // Calculate overall score\n  score = Math.round(\n    (factors.setupQuality * 0.25 +\n     factors.timingQuality * 0.20 +\n     factors.riskManagement * 0.25 +\n     factors.strategyAlignment * 0.15 +\n     factors.marketConditionMatch * 0.15)\n  );\n\n  return {\n    score,\n    factors,\n    mistakes,\n    strengths,\n    learningPoints,\n    recommendations,\n  };\n}\n\n/**\n * Calculate execution quality score\n */\nexport function calculateExecutionQuality(trade: TradeData): {\n  score: number;\n  factors: ExecutionQualityFactors;\n} {\n  const factors: ExecutionQualityFactors = {\n    entryPrecision: 7, // Default good\n    stopPlacement: 5,\n    positionSizing: 6,\n    exitDiscipline: 6,\n    emotionalControl: 7,\n  };\n\n  // Entry Precision\n  if (trade.profitLoss !== undefined && trade.profitLoss !== null) {\n    // Better entry if profitable\n    factors.entryPrecision = trade.profitLoss > 0 ? 8 : 6;\n  }\n\n  // Stop Placement\n  if (trade.stopLoss) {\n    factors.stopPlacement = 8;\n  } else {\n    factors.stopPlacement = 2;\n  }\n\n  // Position Sizing\n  if (trade.volume) {\n    // Assume reasonable sizing if volume is provided\n    factors.positionSizing = Math.min(10, Math.max(4, trade.volume * 10));\n  }\n\n  // Exit Discipline\n  if (trade.takeProfit && trade.exitPrice) {\n    factors.exitDiscipline = 8;\n  } else if (trade.outcome === 'profit') {\n    factors.exitDiscipline = 7;\n  } else {\n    factors.exitDiscipline = 5;\n  }\n\n  // Emotional Control (inferred)\n  if (trade.emotionalDrift) {\n    const drift = trade.emotionalDrift;\n    if (drift.confidenceChange < -20 || drift.stressChange > 30) {\n      factors.emotionalControl = 3;\n    } else if (drift.confidenceChange < -10 || drift.stressChange > 15) {\n      factors.emotionalControl = 5;\n    } else {\n      factors.emotionalControl = 8;\n    }\n  }\n\n  const score = Math.round(\n    (factors.entryPrecision * 0.20 +\n     factors.stopPlacement * 0.20 +\n     factors.positionSizing * 0.15 +\n     factors.exitDiscipline * 0.25 +\n     factors.emotionalControl * 0.20)\n  );\n\n  return { score, factors };\n}\n\n/**\n * Calculate emotional cost metrics\n */\nexport function calculateEmotionalCost(trade: TradeData): EmotionalCostMetrics {\n  let emotionalCostScore = 0;\n  let stressAccumulation = 0;\n  let decisionQualityImpact = 0;\n  let futurePerformanceImpact = 0;\n  let recoveryTimeMinutes = 0;\n\n  if (trade.emotionalDrift) {\n    const drift = trade.emotionalDrift;\n\n    // Base emotional cost on confidence and stress changes\n    const confidenceImpact = Math.abs(drift.confidenceChange || 0);\n    const stressImpact = Math.abs(drift.stressChange || 0);\n    const focusImpact = Math.abs(drift.focusChange || 0);\n    const energyImpact = Math.abs(drift.energyChange || 0);\n\n    emotionalCostScore = Math.round(\n      (confidenceImpact * 0.3 + stressImpact * 0.3 + focusImpact * 0.2 + energyImpact * 0.2)\n    );\n\n    stressAccumulation = Math.max(0, (drift.stressChange || 0) + (drift.energyChange || 0) * 0.5);\n    decisionQualityImpact = Math.max(0, -1 * (drift.confidenceChange || 0) * 0.8);\n    futurePerformanceImpact = Math.max(0, emotionalCostScore * 0.6);\n\n    // Recovery time based on emotional cost\n    if (emotionalCostScore > 50) {\n      recoveryTimeMinutes = 480; // 8 hours\n    } else if (emotionalCostScore > 25) {\n      recoveryTimeMinutes = 180; // 3 hours\n    } else {\n      recoveryTimeMinutes = 30; // 30 minutes\n    }\n  } else {\n    // Default values for trades without emotional drift data\n    emotionalCostScore = trade.profitLoss && trade.profitLoss < 0 ? 25 : 10;\n    stressAccumulation = trade.profitLoss && trade.profitLoss < 0 ? 20 : 5;\n    decisionQualityImpact = trade.profitLoss && trade.profitLoss < 0 ? 15 : 5;\n    futurePerformanceImpact = emotionalCostScore * 0.5;\n    recoveryTimeMinutes = 60;\n  }\n\n  return {\n    emotionalCostScore,\n    stressAccumulation,\n    decisionQualityImpact,\n    futurePerformanceImpact,\n    recoveryTimeMinutes,\n  };\n}\n\n/**\n * Calculate overall decision score (0-100)\n */\nexport function calculateDecisionScore(trade: TradeData): number {\n  const decisionQuality = calculateDecisionQuality(trade);\n  const executionQuality = calculateExecutionQuality(trade);\n\n  // Weight decision quality more heavily than execution\n  return Math.round(decisionQuality.score * 0.6 + executionQuality.score * 0.4);\n}\n\n/**\n * Update trade with calculated analytics\n */\nexport async function updateTradeAnalytics(prisma: PrismaClient, tradeId: string): Promise<void> {\n  const trade = await prisma.trade.findUnique({\n    where: { id: tradeId },\n    include: {\n      strategy: true,\n      marketCondition: true,\n      emotionalState: true,\n    },\n  });\n\n  if (!trade) {\n    throw new Error(`Trade ${tradeId} not found`);\n  }\n\n  const decisionQuality = calculateDecisionQuality(trade);\n  const executionQuality = calculateExecutionQuality(trade);\n  const emotionalCost = calculateEmotionalCost(trade);\n  const decisionScore = calculateDecisionScore(trade);\n\n  // Update trade with calculated values\n  await prisma.trade.update({\n    where: { id: tradeId },\n    data: {\n      decisionScore,\n      decisionQuality: {\n        decisionQualityScore: decisionQuality.score,\n        executionQualityScore: executionQuality.score,\n        overallScore: decisionScore,\n        decisionFactors: decisionQuality.factors,\n        executionFactors: executionQuality.factors,\n        mistakes: decisionQuality.mistakes,\n        strengths: decisionQuality.strengths,\n        learningPoints: decisionQuality.learningPoints,\n        recommendations: decisionQuality.recommendations,\n      },\n      emotionalCost: {\n        emotionalCostScore: emotionalCost.emotionalCostScore,\n        stressAccumulation: emotionalCost.stressAccumulation,\n        decisionQualityImpact: emotionalCost.decisionQualityImpact,\n        futurePerformanceImpact: emotionalCost.futurePerformanceImpact,\n        recoveryTimeMinutes: emotionalCost.recoveryTimeMinutes,\n        emotionalDrift: trade.emotionalDrift,\n        behavioralImpacts: {},\n        physiologicalCosts: {},\n        opportunityCosts: {},\n        longTermEffects: {},\n      },\n    },\n  });\n\n  // Create or update decision quality record\n  await prisma.decisionQuality.upsert({\n    where: { tradeId },\n    update: {\n      decisionQualityScore: decisionQuality.score,\n      executionQualityScore: executionQuality.score,\n      overallScore: decisionScore,\n      decisionFactors: decisionQuality.factors,\n      executionFactors: executionQuality.factors,\n      mistakes: decisionQuality.mistakes,\n      strengths: decisionQuality.strengths,\n      learningPoints: decisionQuality.learningPoints,\n      recommendations: decisionQuality.recommendations,\n    },\n    create: {\n      id: `dq-${tradeId}`,\n      tradeId,\n      timestamp: new Date(),\n      decisionQualityScore: decisionQuality.score,\n      executionQualityScore: executionQuality.score,\n      overallScore: decisionScore,\n      decisionFactors: decisionQuality.factors,\n      executionFactors: executionQuality.factors,\n      mistakes: decisionQuality.mistakes,\n      strengths: decisionQuality.strengths,\n      learningPoints: decisionQuality.learningPoints,\n      recommendations: decisionQuality.recommendations,\n    },\n  });\n\n  // Create or update emotional cost record\n  await prisma.emotionalCost.upsert({\n    where: { tradeId },\n    update: {\n      emotionalCostScore: emotionalCost.emotionalCostScore,\n      stressAccumulation: emotionalCost.stressAccumulation,\n      decisionQualityImpact: emotionalCost.decisionQualityImpact,\n      futurePerformanceImpact: emotionalCost.futurePerformanceImpact,\n      recoveryTimeMinutes: emotionalCost.recoveryTimeMinutes,\n      emotionalDrift: trade.emotionalDrift,\n    },\n    create: {\n      id: `ec-${tradeId}`,\n      tradeId,\n      timestamp: new Date(),\n      emotionalCostScore: emotionalCost.emotionalCostScore,\n      stressAccumulation: emotionalCost.stressAccumulation,\n      decisionQualityImpact: emotionalCost.decisionQualityImpact,\n      futurePerformanceImpact: emotionalCost.futurePerformanceImpact,\n      recoveryTimeMinutes: emotionalCost.recoveryTimeMinutes,\n      emotionalDrift: trade.emotionalDrift,\n      behavioralImpacts: {},\n      physiologicalCosts: {},\n      opportunityCosts: {},\n      longTermEffects: {},\n    },\n  });\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 501, "column": 0}, "map": {"version":3,"sources":["file:///workspaces/Forex-Journal-2/src/app/api/trades/route.ts"],"sourcesContent":["import { PrismaClient } from '@prisma/client';\r\nimport { NextRequest } from 'next/server';\r\nimport { readFileSync } from 'fs';\r\nimport path from 'path';\r\nimport { apiResponse } from '@/lib/api-response';\r\nimport { TradeInputSchema, TradeUpdateSchema, PaginationSchema } from '@/lib/validation';\r\nimport { updateTradeAnalytics } from '@/lib/advanced-analytics-calculations';\r\n\r\nlet prisma: PrismaClient | null = null;\r\ntry {\r\n  prisma = new PrismaClient();\r\n} catch (e) {\r\n  console.warn('Prisma client failed to initialize', e);\r\n  prisma = null;\r\n}\r\n\r\ninterface DemoTrade {\r\n  id: string;\r\n  userId?: string;\r\n  pair: string;\r\n  direction: string;\r\n  entryPrice: number;\r\n  exitPrice?: number | null;\r\n  profitLoss?: number | null;\r\n  outcome?: string | null;\r\n  entryTime: string | Date;\r\n  [key: string]: unknown;\r\n}\r\n\r\nfunction loadDemoTrades(): DemoTrade[] {\r\n  const possible = [\r\n    path.join(process.cwd(), 'data', 'demo-trades.json'),\r\n    path.join(process.cwd(), 'src', 'data', 'demo-trades.json'),\r\n    path.join(process.cwd(), 'public', 'data', 'demo-trades.json'),\r\n  ];\r\n\r\n  for (const p of possible) {\r\n    try {\r\n      const raw = readFileSync(p, 'utf-8');\r\n      return JSON.parse(raw);\r\n    } catch (_e) {\r\n      // try next\r\n    }\r\n  }\r\n\r\n  console.error('Failed to load demo trades file from known locations');\r\n  return [];\r\n}\r\n\r\nexport async function GET(request: NextRequest) {\r\n  const userId = request.headers.get('x-user-id') || 'demo-user';\r\n\r\n  try {\r\n    const { searchParams } = new URL(request.url);\r\n    \r\n    // Pagination\r\n    const page = parseInt(searchParams.get('page') || '1');\r\n    const limit = parseInt(searchParams.get('limit') || '50');\r\n    const skip = (page - 1) * limit;\r\n\r\n    const pair = searchParams.get('pair');\r\n    const startDate = searchParams.get('startDate');\r\n    const endDate = searchParams.get('endDate');\r\n    const outcome = searchParams.get('outcome');\r\n    const account = searchParams.get('account');\r\n    const strategy = searchParams.get('strategy');\r\n    const search = searchParams.get('search');\r\n\r\n    const where: Record<string, unknown> = { userId };\r\n\r\n    if (pair) where.pair = pair;\r\n    if (outcome) where.outcome = outcome;\r\n    if (account) where.account = account;\r\n    if (strategy) where.strategy = strategy;\r\n    if (search) {\r\n      where.OR = [\r\n        { pair: { contains: search, mode: 'insensitive' } },\r\n        { notes: { contains: search, mode: 'insensitive' } },\r\n        { strategy: { contains: search, mode: 'insensitive' } },\r\n      ];\r\n    }\r\n    if (startDate || endDate) {\r\n      const dateRange: Record<string, Date> = {};\r\n      if (startDate) dateRange.gte = new Date(startDate);\r\n      if (endDate) dateRange.lte = new Date(endDate);\r\n      where.entryTime = dateRange;\r\n    }\r\n\r\n    if (!prisma) {\r\n      const demoAll = loadDemoTrades();\r\n      const filtered = demoAll.filter((t: DemoTrade) => t.userId === userId || !t.userId);\r\n      const total = filtered.length;\r\n      const demo = filtered.slice(skip, skip + limit);\r\n      return apiResponse.success(demo, { page, limit, total });\r\n    }\r\n\r\n    const [trades, total] = await Promise.all([\r\n      prisma.trade.findMany({\r\n        where,\r\n        orderBy: { entryTime: 'desc' },\r\n        skip,\r\n        take: limit,\r\n        include: {\r\n          screenshots: true,\r\n          voiceNotes: true,\r\n        },\r\n      }),\r\n      prisma.trade.count({ where }),\r\n    ]);\r\n\r\n    return apiResponse.success(trades, { page, limit, total });\r\n  } catch (error) {\r\n    console.error('Error fetching trades:', error);\r\n    return apiResponse.serverError('Failed to fetch trades');\r\n  }\r\n}\r\n\r\nexport async function POST(request: NextRequest) {\r\n  try {\r\n    const userId = request.headers.get('x-user-id') || 'demo-user';\r\n    const body = await request.json();\r\n\r\n    // Validate input with Zod\r\n    const validation = TradeInputSchema.safeParse(body);\r\n    if (!validation.success) {\r\n      const errors = validation.error.flatten().fieldErrors;\r\n      return apiResponse.validationError(errors);\r\n    }\r\n\r\n    const data = validation.data;\r\n\r\n    if (!prisma) {\r\n      return apiResponse.unavailable();\r\n    }\r\n\r\n    const trade = await prisma.trade.create({\r\n      data: {\r\n        userId,\r\n        pair: data.pair,\r\n        direction: data.direction,\r\n        entryPrice: data.entryPrice,\r\n        exitPrice: data.exitPrice ?? null,\r\n        entryTime: new Date(data.entryTime),\r\n        exitTime: data.exitTime ? new Date(data.exitTime) : null,\r\n        volume: data.volume ?? 1.0,\r\n        stopLoss: data.stopLoss ?? null,\r\n        takeProfit: data.takeProfit ?? null,\r\n        riskAmount: data.riskAmount ?? null,\r\n        riskPercent: data.riskPercent ?? null,\r\n        riskRewardRatio: data.riskRewardRatio ?? null,\r\n        account: data.account ?? null,\r\n        broker: data.broker ?? null,\r\n        accountBalance: data.accountBalance ?? null,\r\n        accountEquity: data.accountEquity ?? null,\r\n        profitLoss: data.profitLoss ?? null,\r\n        profitLossPercent: data.profitLossPercent ?? null,\r\n        outcome: data.outcome || 'OPEN',\r\n        strategyId: data.strategy ?? null,\r\n        notes: data.notes ?? null,\r\n        emotionalState: data.emotionalState ?? null,\r\n        setupQuality: data.setupQuality ?? null,\r\n        whatLearned: data.whatLearned ?? null,\r\n        mistakes: data.mistakes ?? null,\r\n      },\r\n      include: {\r\n        screenshots: true,\r\n        voiceNotes: true,\r\n      },\r\n    });\r\n\r\n    // Calculate and update advanced analytics\r\n    try {\r\n      await updateTradeAnalytics(prisma, trade.id);\r\n    } catch (analyticsError) {\r\n      console.warn('Failed to calculate trade analytics:', analyticsError);\r\n      // Don't fail the trade creation if analytics calculation fails\r\n    }\r\n\r\n    return apiResponse.success(trade, undefined, 201);\r\n  } catch (error) {\r\n    console.error('Error creating trade:', error);\r\n    return apiResponse.serverError('Failed to create trade');\r\n  }\r\n}"],"names":[],"mappings":"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"}}]
}