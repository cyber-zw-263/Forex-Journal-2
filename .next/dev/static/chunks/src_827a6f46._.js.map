{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///workspaces/Forex-Journal-2/src/components/CustomTooltip.tsx"],"sourcesContent":["import React from 'react';\n\ninterface ChartPayloadItem {\n  dataKey?: string;\n  value?: unknown;\n}\n\nexport interface CustomTooltipProps {\n  active?: boolean;\n  payload?: ChartPayloadItem[];\n  label?: string | number;\n}\n\nexport function CustomTooltip({ active, payload, label }: CustomTooltipProps) {\n  if (!active || !payload || !payload.length) return null;\n  const equityItem = payload.find((p) => p.dataKey === 'equity') || payload[0];\n  const drawdownItem = payload.find((p) => p.dataKey === 'drawdown');\n  return (\n    <div className=\"bg-gray-900 p-2 rounded text-sm text-white\">\n      <div className=\"font-bold\">{label}</div>\n      {equityItem && <div>Equity: <span className=\"font-mono\">{String(equityItem.value)}</span></div>}\n      {drawdownItem && <div>Drawdown: <span className=\"font-mono\">{String(drawdownItem.value)}</span></div>}\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;;AAaO,SAAS,cAAc,EAAE,MAAM,EAAE,OAAO,EAAE,KAAK,EAAsB;IAC1E,IAAI,CAAC,UAAU,CAAC,WAAW,CAAC,QAAQ,MAAM,EAAE,OAAO;IACnD,MAAM,aAAa,QAAQ,IAAI,CAAC,CAAC,IAAM,EAAE,OAAO,KAAK,aAAa,OAAO,CAAC,EAAE;IAC5E,MAAM,eAAe,QAAQ,IAAI,CAAC,CAAC,IAAM,EAAE,OAAO,KAAK;IACvD,qBACE,6LAAC;QAAI,WAAU;;0BACb,6LAAC;gBAAI,WAAU;0BAAa;;;;;;YAC3B,4BAAc,6LAAC;;oBAAI;kCAAQ,6LAAC;wBAAK,WAAU;kCAAa,OAAO,WAAW,KAAK;;;;;;;;;;;;YAC/E,8BAAgB,6LAAC;;oBAAI;kCAAU,6LAAC;wBAAK,WAAU;kCAAa,OAAO,aAAa,KAAK;;;;;;;;;;;;;;;;;;AAG5F;KAXgB"}},
    {"offset": {"line": 76, "column": 0}, "map": {"version":3,"sources":["file:///workspaces/Forex-Journal-2/src/components/AnalyticsChartsV2.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { useState, useEffect } from 'react';\r\nimport {\r\n  LineChart,\r\n  Line,\r\n  Area,\r\n  ReferenceDot,\r\n  BarChart,\r\n  Bar,\r\n  PieChart,\r\n  Pie,\r\n  Cell,\r\n  XAxis,\r\n  YAxis,\r\n  CartesianGrid,\r\n  Tooltip,\r\n  Legend,\r\n  ResponsiveContainer,\r\n} from 'recharts';\r\nimport dynamic from 'next/dynamic';\r\nimport { CustomTooltip } from './CustomTooltip';\r\n\r\nconst ChartExportButton = dynamic(() => import('./ChartExportButton'), { ssr: false });\r\nconst PdfReport = dynamic(() => import('./PdfReport'), { ssr: false });\r\n\r\ninterface Trade {\r\n  id: string;\r\n  pair: string;\r\n  direction: string;\r\n  entryPrice: number;\r\n  exitPrice?: number;\r\n  profitLoss?: number;\r\n  outcome?: string;\r\n  entryTime: string;\r\n  [key: string]: unknown;\r\n}\r\n\r\ninterface AnalyticsChartsProps {\r\n  trades: Trade[];\r\n}\r\n\r\ninterface EquityPoint { date: string; equity: number; drawdown: number }\r\ninterface PairPerf { pair: string; wins: number; losses: number; pnl: number }\r\ninterface DirectionPerf { direction: string; value: number; name: string; [key: string]: number | string }\r\n\r\ninterface ChartData { dailyPnL: { date: string; pnl: number }[]; pairPerformance: PairPerf[]; directionPerformance: DirectionPerf[]; equity: EquityPoint[] }\r\n\r\n\r\nexport default function AnalyticsChartsV2({ trades, startDate, endDate }: AnalyticsChartsProps & { startDate?: string | null; endDate?: string | null }) {\r\n  const [chartData, setChartData] = useState<ChartData>({ dailyPnL: [], pairPerformance: [], directionPerformance: [], equity: [] });\r\n\r\n  useEffect(() => {\r\n    if (!trades.length) return;\r\n\r\n    // Optionally filter by selectedDateRange\r\n    let working = trades;\r\n    if (startDate || endDate) {\r\n      working = trades.filter(t => {\r\n        const d = new Date(t.entryTime);\r\n        if (startDate && new Date(d.toISOString().slice(0,10)) < new Date(startDate)) return false;\r\n        if (endDate && new Date(d.toISOString().slice(0,10)) > new Date(endDate)) return false;\r\n        return true;\r\n      });\r\n    }\r\n\r\n    // Daily P&L Chart\r\n    const dailyData: { [key: string]: number } = {};\r\n    working.forEach(trade => {\r\n      const date = new Date(trade.entryTime).toLocaleDateString();\r\n      dailyData[date] = (dailyData[date] || 0) + (trade.profitLoss || 0);\r\n    });\r\n\r\n    const dailyPnL = Object.entries(dailyData).map(([date, pnl]) => ({ date, pnl: Math.round(pnl * 100) / 100 }));\r\n\r\n    // Performance by Pair\r\n    const pairData: { [key: string]: { wins: number; losses: number; pnl: number } } = {};\r\n    trades.forEach(trade => {\r\n      if (!pairData[trade.pair]) {\r\n        pairData[trade.pair] = { wins: 0, losses: 0, pnl: 0 };\r\n      }\r\n      if (trade.outcome === 'WIN') pairData[trade.pair].wins++;\r\n      if (trade.outcome === 'LOSS') pairData[trade.pair].losses++;\r\n      pairData[trade.pair].pnl += trade.profitLoss || 0;\r\n    });\r\n\r\n    const pairPerformance = Object.entries(pairData).map(([pair, data]) => ({ pair, wins: data.wins, losses: data.losses, pnl: Math.round(data.pnl * 100) / 100 }));\r\n\r\n    // Performance by Direction\r\n    const directionData: { [key: string]: { wins: number; losses: number } } = { LONG: { wins: 0, losses: 0 }, SHORT: { wins: 0, losses: 0 } };\r\n    trades.forEach(trade => {\r\n      if (trade.outcome === 'WIN') {\r\n        directionData[trade.direction].wins++;\r\n      } else if (trade.outcome === 'LOSS') {\r\n        directionData[trade.direction].losses++;\r\n      }\r\n    });\r\n\r\n    const directionPerformance = Object.entries(directionData).map(([direction, data]) => ({ direction, value: data.wins, name: `${direction} (${data.wins} wins)` }));\r\n\r\n    // Equity curve and drawdown (respect date filters)\r\n    const sorted = [...working].sort((a, b) => new Date(a.entryTime).getTime() - new Date(b.entryTime).getTime());\r\n    let equity = 0;\r\n    let maxEquity = -Infinity;\r\n    const equityData = sorted.map((t) => {\r\n      equity += t.profitLoss || 0;\r\n      maxEquity = Math.max(maxEquity, equity);\r\n      const drawdown = Math.round((maxEquity - equity) * 100) / 100;\r\n      return { date: new Date(t.entryTime).toLocaleDateString(), equity: Math.round(equity * 100) / 100, drawdown };\r\n    });\r\n\r\n    // compute annotations (min drawdown, max equity)\r\n    const minDrawdown = equityData.reduce((acc: number, cur: EquityPoint) => Math.max(acc, cur.drawdown), 0);\r\n    const maxPoint = equityData.length ? equityData.reduce((acc: EquityPoint, cur: EquityPoint) => (cur.equity > acc.equity ? cur : acc), equityData[0]) : null;\r\n    const minPoint = equityData.length ? equityData.reduce((acc: EquityPoint, cur: EquityPoint) => (cur.equity < acc.equity ? cur : acc), equityData[0]) : null;\r\n\r\n    setChartData({ dailyPnL, pairPerformance, directionPerformance, equity: equityData });\r\n    // optionally set annotations into state if needed for external UI later\r\n    // setAnnotations({ minDrawdown, maxEquity: maxPoint ? maxPoint.equity : null });\r\n  }, [trades]);\r\n\r\n  \r\n\r\n  const maxPoint = chartData.equity.length ? chartData.equity.reduce((acc: EquityPoint, cur: EquityPoint) => (cur.equity > acc.equity ? cur : acc), chartData.equity[0]) : null;\r\n  const minPoint = chartData.equity.length ? chartData.equity.reduce((acc: EquityPoint, cur: EquityPoint) => (cur.equity < acc.equity ? cur : acc), chartData.equity[0]) : null;\r\n\r\n  const COLORS = ['#10b981', '#ef4444'];\r\n\r\n  return (\r\n    <div className=\"space-y-8\">\r\n      {/* Live Equity Curve */}\r\n      {chartData.equity.length > 0 && (\r\n        <div className=\"card-glass rounded-lg p-6\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <h3 className=\"text-lg font-bold text-gray-200 mb-4\">Equity Curve (Live)</h3>\r\n            <div className=\"flex items-center gap-2\">\r\n              <ChartExportButton selector=\".recharts-wrapper\" filename={`equity-${new Date().toISOString().slice(0,10)}.png`} />\r\n            </div>\r\n          </div>\r\n          <ResponsiveContainer width=\"100%\" height={320}>\r\n            <LineChart data={chartData.equity} className=\"equity-chart\">              <CartesianGrid strokeDasharray=\"3 3\" stroke=\"#111827\" />\r\n              <XAxis dataKey=\"date\" stroke=\"#6b7280\" />\r\n              <YAxis stroke=\"#6b7280\" />\r\n              <Tooltip content={<CustomTooltip />} />\r\n\r\n              {/* subtle drawdown area */}\r\n              <Area type=\"monotone\" dataKey=\"drawdown\" fill=\"#7c3aed\" fillOpacity={0.06} stroke=\"none\" />\r\n\r\n              {/* animated equity and drawdown lines */}\r\n              <Line type=\"monotone\" dataKey=\"equity\" stroke=\"#06b6d4\" strokeWidth={3} dot={false} strokeOpacity={0.98} isAnimationActive={true} animationDuration={1200} />\r\n              <Line type=\"monotone\" dataKey=\"drawdown\" stroke=\"#7c3aed\" strokeWidth={2} dot={false} strokeOpacity={0.6} isAnimationActive={true} animationDuration={1000} />\r\n\r\n              {/* min/max markers */}\r\n              {maxPoint && (\r\n                <ReferenceDot x={maxPoint.date} y={maxPoint.equity} r={6} fill=\"#06b6d4\" stroke=\"#fff\" strokeWidth={1} />\r\n              )}\r\n              {minPoint && (\r\n                <ReferenceDot x={minPoint.date} y={minPoint.equity} r={6} fill=\"#7c3aed\" stroke=\"#fff\" strokeWidth={1} />\r\n              )}\r\n            </LineChart>\r\n          </ResponsiveContainer>\r\n        </div>\r\n      )}\r\n\r\n      {/* Daily P&L Chart */}\r\n      {chartData.dailyPnL.length > 0 && (\r\n        <div className=\"card-glass rounded-lg p-6\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <h3 className=\"text-lg font-bold text-gray-200 mb-4\">Daily P&L</h3>\r\n            <div className=\"flex items-center gap-2\">\r\n              <ChartExportButton selector=\".recharts-wrapper\" filename={`daily-pnl-${new Date().toISOString().slice(0,10)}.png`} />\r\n              <PdfReport trades={trades} chartSelector=\".recharts-wrapper\" />\r\n            </div>\r\n          </div>\r\n          <ResponsiveContainer width=\"100%\" height={300}>\r\n            <LineChart data={chartData.dailyPnL}>\r\n              <CartesianGrid strokeDasharray=\"3 3\" stroke=\"#111827\" />\r\n              <XAxis dataKey=\"date\" stroke=\"#6b7280\" />\r\n              <YAxis stroke=\"#6b7280\" />\r\n              <Tooltip contentStyle={{ backgroundColor: '#0b1220', border: 'none', borderRadius: '0.5rem', color: '#fff' }} />\r\n              <Line type=\"monotone\" dataKey=\"pnl\" stroke=\"#3b82f6\" dot={{ fill: '#3b82f6' }} isAnimationActive={true} strokeWidth={2} />\r\n            </LineChart>\r\n          </ResponsiveContainer>\r\n        </div>\r\n      )}\r\n\r\n      {/* Performance by Pair */}\r\n      {chartData.pairPerformance.length > 0 && (\r\n        <div className=\"card-glass rounded-lg p-6\">\r\n          <h3 className=\"text-lg font-bold text-gray-200 mb-4\">Performance by Pair</h3>\r\n          <ResponsiveContainer width=\"100%\" height={300}>\r\n            <BarChart data={chartData.pairPerformance}>\r\n              <CartesianGrid strokeDasharray=\"3 3\" stroke=\"#111827\" />\r\n              <XAxis dataKey=\"pair\" stroke=\"#6b7280\" />\r\n              <YAxis stroke=\"#6b7280\" />\r\n              <Tooltip contentStyle={{ backgroundColor: '#0b1220', border: 'none', borderRadius: '0.5rem', color: '#fff' }} />\r\n              <Legend />\r\n              <Bar dataKey=\"wins\" fill=\"#10b981\" />\r\n              <Bar dataKey=\"losses\" fill=\"#ef4444\" />\r\n            </BarChart>\r\n          </ResponsiveContainer>\r\n        </div>\r\n      )}\r\n\r\n      {/* Direction Win Rate */}\r\n      {chartData.directionPerformance.length > 0 && (\r\n        <div className=\"card-glass rounded-lg p-6\">\r\n          <h3 className=\"text-lg font-bold text-gray-200 mb-4\">Win Rate by Direction</h3>\r\n          <ResponsiveContainer width=\"100%\" height={300}>\r\n            <PieChart>\r\n              <Pie data={chartData.directionPerformance} cx=\"50%\" cy=\"50%\" labelLine={false} label={({ name }) => name} outerRadius={80} fill=\"#8884d8\" dataKey=\"value\">\r\n                {chartData.directionPerformance.map((entry: Record<string, number | string>, index: number) => (\r\n                  <Cell key={`cell-${index}`} fill={COLORS[index % COLORS.length]} />\r\n                ))}\r\n              </Pie>\r\n              <Tooltip contentStyle={{ backgroundColor: '#0b1220', border: 'none', borderRadius: '0.5rem', color: '#fff' }} />\r\n            </PieChart>\r\n          </ResponsiveContainer>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 715, "column": 0}, "map": {"version":3,"sources":["file:///workspaces/Forex-Journal-2/src/components/YearlyHeatmap.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { useMemo, useState, useEffect } from 'react';\r\n\r\ninterface Trade { entryTime: string; profitLoss?: number }\r\n\r\nexport default function YearlyHeatmap({ trades, onSelectRange }: { trades: Trade[]; onSelectRange?: (range: { start: string | null; end: string | null }) => void }) {\r\n  const days = useMemo(() => {\r\n    const map: Record<string, number> = {};\r\n    const now = new Date();\r\n    for (let i = 0; i < 365; i++) {\r\n      const d = new Date(now);\r\n      d.setDate(now.getDate() - i);\r\n      map[d.toISOString().slice(0, 10)] = 0;\r\n    }\r\n\r\n    function safeDateKey(value: unknown): string | null {\r\n      if (!value) return null;\r\n      // Try to parse common formats and timestamps\r\n      const parsed = typeof value === 'number' ? new Date(value) : new Date(String(value));\r\n      if (!(parsed instanceof Date) || isNaN(parsed.getTime())) return null;\r\n      return parsed.toISOString().slice(0, 10);\r\n    }\r\n\r\n    trades.forEach(t => {\r\n      const key = safeDateKey(t.entryTime);\r\n      if (!key) return; // skip invalid dates\r\n      // only include within the last 365 days (map already initialized for those keys)\r\n      if (typeof map[key] === 'undefined') {\r\n        // ignore out-of-range dates\r\n        return;\r\n      }\r\n      map[key] = (map[key] || 0) + (t.profitLoss || 0);\r\n    });\r\n\r\n    return Object.entries(map).map(([day, pnl]) => ({ day, pnl }));\r\n  }, [trades]);\r\n\r\n  const max = Math.max(...days.map(d => Math.abs(d.pnl)), 1);\r\n\r\n  const [start, setStart] = useState<string | null>(null);\r\n  const [end, setEnd] = useState<string | null>(null);\r\n\r\n  useEffect(() => {\r\n    if (onSelectRange) onSelectRange({ start, end });\r\n  }, [start, end, onSelectRange]);\r\n\r\n  const [monthZoom, setMonthZoom] = useState(false);\r\n\r\n  function handleClick(day: string) {\r\n    if (monthZoom) {\r\n      // Zoom to month of the clicked day\r\n      const d = new Date(day);\r\n      const startOfMonth = new Date(d.getFullYear(), d.getMonth(), 1).toISOString().slice(0,10);\r\n      const endOfMonth = new Date(d.getFullYear(), d.getMonth() + 1, 0).toISOString().slice(0,10);\r\n      setStart(startOfMonth);\r\n      setEnd(endOfMonth);\r\n      return;\r\n    }\r\n\r\n    // If no start, set start\r\n    if (!start) {\r\n      setStart(day);\r\n      setEnd(null);\r\n      return;\r\n    }\r\n\r\n    // If start exists and no end: set end (ensure proper order)\r\n    if (start && !end) {\r\n      if (day === start) {\r\n        // toggle off\r\n        setStart(null);\r\n        setEnd(null);\r\n        return;\r\n      }\r\n      // ensure chronological order\r\n      const s = new Date(start);\r\n      const d = new Date(day);\r\n      if (d < s) {\r\n        setStart(day);\r\n        setEnd(s.toISOString().slice(0, 10));\r\n      } else {\r\n        setEnd(day);\r\n      }\r\n      return;\r\n    }\r\n\r\n    // If both set, start new selection at clicked day\r\n    setStart(day);\r\n    setEnd(null);\r\n  }\r\n\r\n  function isSelected(day: string) {\r\n    if (!start) return false;\r\n    if (start && !end) return day === start;\r\n    // range\r\n    const s = new Date(start);\r\n    const e = new Date(end as string);\r\n    const d = new Date(day);\r\n    return d >= s && d <= e;\r\n  }\r\n\r\n  return (\r\n    <div className=\"card-glass p-4 rounded-lg\">\r\n      <div className=\"flex items-center justify-between\">\r\n        <h3 className=\"text-lg font-bold text-gray-200 mb-4\">Yearly P&L Heatmap</h3>\r\n        <div className=\"flex items-center gap-3\">\r\n          <div className=\"text-xs text-gray-400\">\r\n            {start && <span>From <strong>{start}</strong></span>} {end && <span> to <strong>{end}</strong></span>}\r\n            {(start || end) && <button className=\"ml-3 text-sm text-blue-400\" onClick={() => { setStart(null); setEnd(null); if (onSelectRange) onSelectRange({ start: null, end: null }); }}>Clear</button>}\r\n          </div>\r\n          <button type=\"button\" aria-pressed={monthZoom} aria-label=\"Toggle month zoom\" className={`px-2 py-1 rounded ${monthZoom ? 'bg-indigo-600 text-white' : 'bg-transparent text-gray-300 border border-gray-700'}`} onClick={() => setMonthZoom(s => !s)}>\r\n            {monthZoom ? 'Month Zoom: ON' : 'Month Zoom: OFF'}\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"grid grid-cols-52 gap-1\" role=\"grid\" aria-label=\"Yearly profit/loss heatmap\" style={{gap: '6px'}}>\r\n        {days.map(d => {\r\n          const intensity = Math.min(1, Math.abs(d.pnl) / max);\r\n          const bg = d.pnl > 0 ? `rgba(16,185,129,${0.14 + intensity * 0.86})` : d.pnl < 0 ? `rgba(239,68,68,${0.14 + intensity * 0.86})` : 'transparent';\r\n          const selected = isSelected(d.day);\r\n          const borderStyle = selected ? { boxShadow: '0 0 0 3px rgba(99,102,241,0.12)', outline: 'none' } : {};\r\n          const showLabel = Math.abs(d.pnl) > (max * 0.25);\r\n\r\n          return (\r\n            <button\r\n              key={d.day}\r\n              title={`${d.day}: ${d.pnl}`}\r\n              aria-pressed={selected}\r\n              onClick={() => handleClick(d.day)}\r\n              onKeyDown={(e) => {\r\n                if (e.key === 'Enter' || e.key === ' ') {\r\n                  e.preventDefault();\r\n                  handleClick(d.day);\r\n                }\r\n              }}\r\n              style={{ background: bg, width: '36px', height: '36px', borderRadius: '8px', display: 'flex', alignItems: 'center', justifyContent: 'center', color: 'var(--foreground)', fontSize: '11px', ...borderStyle }}\r\n              className={`focus:outline-none`}\r\n            >\r\n              {showLabel ? (d.pnl > 0 ? `+$${Math.round(d.pnl)}` : `-$${Math.abs(Math.round(d.pnl))}`) : ''}\r\n            </button>\r\n          );\r\n        })}\r\n      </div>\r\n      <div className=\"text-xs text-gray-400 mt-2\">Green = Profit, Pink = Loss. Click a day to set start, click another to set end. Toggle Month Zoom to select whole month on click. Clear to reset selection.</div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1005, "column": 0}, "map": {"version":3,"sources":["file:///workspaces/Forex-Journal-2/src/components/MonthlyPerformanceTable.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { useState, useMemo } from 'react';\r\n\r\ninterface Trade { entryTime: string; profitLoss?: number; pair?: string }\r\n\r\nexport default function MonthlyPerformanceTable({ trades }: { trades: Trade[] }) {\r\n  const months = useMemo(() => {\r\n    const map: Record<string, { pnl: number; trades: Trade[] }> = {};\r\n    trades.forEach(t => {\r\n      const d = new Date(t.entryTime);\r\n      const key = `${d.getFullYear()}-${String(d.getMonth() + 1).padStart(2, '0')}`;\r\n      if (!map[key]) map[key] = { pnl: 0, trades: [] };\r\n      map[key].pnl += t.profitLoss || 0;\r\n      map[key].trades.push(t);\r\n    });\r\n    return Object.entries(map).sort((a, b) => b[0].localeCompare(a[0]));\r\n  }, [trades]);\r\n\r\n  const [open, setOpen] = useState<Record<string, boolean>>({});\r\n\r\n  return (\r\n    <div className=\"card-glass p-4 rounded-lg\">\r\n      <h3 className=\"text-lg font-bold text-gray-200 mb-4\">Monthly Performance</h3>\r\n      <div className=\"space-y-2\">\r\n        {months.map(([month, data]) => (\r\n          <div key={month} className=\"border border-transparent hover:border-gray-700 rounded-lg p-2\">\r\n            <div className=\"flex items-center justify-between cursor-pointer\" onClick={() => setOpen(prev => ({ ...prev, [month]: !prev[month] }))}>\r\n              <div>\r\n                <div className=\"text-sm text-gray-300 font-medium\">{month}</div>\r\n                <div className=\"text-xs text-gray-400\">{data.trades.length} trades</div>\r\n              </div>\r\n              <div className={`text-lg font-bold ${data.pnl >= 0 ? 'text-green-400' : 'text-red-400'}`}>{data.pnl.toFixed(2)}</div>\r\n            </div>\r\n            {open[month] && (\r\n              <div className=\"mt-2 text-sm text-gray-300\">\r\n                {data.trades.map((t, i) => (\r\n                  <div key={i} className=\"py-1 border-t border-gray-800\">{new Date(t.entryTime).toLocaleString()} — {t.pair} — {t.profitLoss}</div>\r\n                ))}\r\n              </div>\r\n            )}\r\n          </div>\r\n        ))}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;;;AAFA;;AAMe,SAAS,wBAAwB,EAAE,MAAM,EAAuB;;IAC7E,MAAM,SAAS,IAAA,wKAAO;mDAAC;YACrB,MAAM,MAAwD,CAAC;YAC/D,OAAO,OAAO;2DAAC,CAAA;oBACb,MAAM,IAAI,IAAI,KAAK,EAAE,SAAS;oBAC9B,MAAM,MAAM,GAAG,EAAE,WAAW,GAAG,CAAC,EAAE,OAAO,EAAE,QAAQ,KAAK,GAAG,QAAQ,CAAC,GAAG,MAAM;oBAC7E,IAAI,CAAC,GAAG,CAAC,IAAI,EAAE,GAAG,CAAC,IAAI,GAAG;wBAAE,KAAK;wBAAG,QAAQ,EAAE;oBAAC;oBAC/C,GAAG,CAAC,IAAI,CAAC,GAAG,IAAI,EAAE,UAAU,IAAI;oBAChC,GAAG,CAAC,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC;gBACvB;;YACA,OAAO,OAAO,OAAO,CAAC,KAAK,IAAI;2DAAC,CAAC,GAAG,IAAM,CAAC,CAAC,EAAE,CAAC,aAAa,CAAC,CAAC,CAAC,EAAE;;QACnE;kDAAG;QAAC;KAAO;IAEX,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,yKAAQ,EAA0B,CAAC;IAE3D,qBACE,6LAAC;QAAI,WAAU;;0BACb,6LAAC;gBAAG,WAAU;0BAAuC;;;;;;0BACrD,6LAAC;gBAAI,WAAU;0BACZ,OAAO,GAAG,CAAC,CAAC,CAAC,OAAO,KAAK,iBACxB,6LAAC;wBAAgB,WAAU;;0CACzB,6LAAC;gCAAI,WAAU;gCAAmD,SAAS,IAAM,QAAQ,CAAA,OAAQ,CAAC;4CAAE,GAAG,IAAI;4CAAE,CAAC,MAAM,EAAE,CAAC,IAAI,CAAC,MAAM;wCAAC,CAAC;;kDAClI,6LAAC;;0DACC,6LAAC;gDAAI,WAAU;0DAAqC;;;;;;0DACpD,6LAAC;gDAAI,WAAU;;oDAAyB,KAAK,MAAM,CAAC,MAAM;oDAAC;;;;;;;;;;;;;kDAE7D,6LAAC;wCAAI,WAAW,CAAC,kBAAkB,EAAE,KAAK,GAAG,IAAI,IAAI,mBAAmB,gBAAgB;kDAAG,KAAK,GAAG,CAAC,OAAO,CAAC;;;;;;;;;;;;4BAE7G,IAAI,CAAC,MAAM,kBACV,6LAAC;gCAAI,WAAU;0CACZ,KAAK,MAAM,CAAC,GAAG,CAAC,CAAC,GAAG,kBACnB,6LAAC;wCAAY,WAAU;;4CAAiC,IAAI,KAAK,EAAE,SAAS,EAAE,cAAc;4CAAG;4CAAI,EAAE,IAAI;4CAAC;4CAAI,EAAE,UAAU;;uCAAhH;;;;;;;;;;;uBAXR;;;;;;;;;;;;;;;;AAoBpB;GAxCwB;KAAA"}},
    {"offset": {"line": 1154, "column": 0}, "map": {"version":3,"sources":["file:///workspaces/Forex-Journal-2/src/app/analytics/page.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { useState, useEffect } from 'react';\r\n/* Header provided by AppShell */\r\nimport AnalyticsCharts from '@/components/AnalyticsChartsV2';\r\nimport YearlyHeatmap from '@/components/YearlyHeatmap';\r\nimport MonthlyPerformanceTable from '@/components/MonthlyPerformanceTable';\r\nimport { useTheme } from '@/context/ThemeContext';\r\nimport { Toaster } from 'react-hot-toast';\r\nimport toast from 'react-hot-toast';\r\nimport AnimatedCard from '@/components/AnimatedCard';\r\nimport { FiAlertCircle } from 'react-icons/fi';\r\n\r\nexport default function AnalyticsPage() {\r\n  const { theme } = useTheme();\r\n  const [trades, setTrades] = useState<any[]>([]);\r\n  const [mounted, setMounted] = useState(() => typeof window !== 'undefined');\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [dateRange, setDateRange] = useState<{ start: string | null; end: string | null }>({ start: null, end: null });\r\n\r\n  useEffect(() => {\r\n    if (!mounted) return;\r\n    \r\n    const fetchTrades = async () => {\r\n      try {\r\n        setIsLoading(true);\r\n        setError(null);\r\n        const response = await fetch('/api/trades', {\r\n          headers: {\r\n            'x-user-id': 'demo-user',\r\n          },\r\n        });\r\n\r\n        if (!response.ok) {\r\n          let errBody: unknown = null;\r\n          try { errBody = await response.json(); } catch (e) { errBody = await response.text(); }\r\n          console.error('Failed to fetch trades:', response.status, errBody);\r\n          setError('Failed to load trades data. Please try again.');\r\n          setTrades([]);\r\n          return;\r\n        }\r\n\r\n        const data = await response.json();\r\n        if (!Array.isArray(data)) {\r\n          console.warn('Unexpected trades payload in analytics page', data);\r\n          setError('Invalid trades data format');\r\n          setTrades([]);\r\n          return;\r\n        }\r\n\r\n        setTrades(data);\r\n      } catch (error) {\r\n        console.error('Error fetching trades:', error);\r\n        setError('An error occurred while loading trades');\r\n        setTrades([]);\r\n      } finally {\r\n        setIsLoading(false);\r\n      }\r\n    };\r\n\r\n    fetchTrades();\r\n  }, [mounted]);\r\n\r\n  if (!mounted) {\r\n    return <div className=\"min-h-screen\" style={{ backgroundColor: 'var(--background)' }} />;\r\n  }\r\n\r\n  return (\r\n    <div className=\"min-h-screen\" style={{ backgroundColor: 'var(--background)' }}>\r\n      <main style={{ maxWidth: '1280px', margin: '0 auto', padding: '32px 16px' }}>\r\n        {/* Header */}\r\n        <div style={{ marginBottom: '32px' }}>\r\n          <h1 style={{ fontSize: '28px', fontWeight: '700', color: 'var(--text-primary)', marginBottom: '8px' }}>\r\n            Analytics & Insights\r\n          </h1>\r\n          <p style={{ fontSize: '14px', color: 'var(--text-secondary)' }}>\r\n            Track your trading performance with detailed charts and metrics\r\n          </p>\r\n        </div>\r\n\r\n        {/* Error State */}\r\n        {error && (\r\n          <div\r\n            style={{\r\n              marginBottom: '24px',\r\n              padding: '16px',\r\n              backgroundColor: 'rgba(220, 38, 38, 0.1)',\r\n              border: '1px solid rgba(220, 38, 38, 0.3)',\r\n              borderRadius: '8px',\r\n              display: 'flex',\r\n              alignItems: 'center',\r\n              gap: '12px',\r\n            }}\r\n            role=\"alert\"\r\n          >\r\n            <FiAlertCircle size={20} style={{ color: 'var(--loss-color)' }} />\r\n            <span style={{ color: 'var(--loss-color)', fontSize: '14px' }}>{error}</span>\r\n          </div>\r\n        )}\r\n\r\n        {/* Loading State */}\r\n        {isLoading ? (\r\n          <div style={{ textAlign: 'center', padding: '60px 20px', color: 'var(--text-secondary)' }}>\r\n            <div style={{ fontSize: '14px', marginBottom: '16px' }}>Loading analytics data...</div>\r\n            <div style={{\r\n              width: '40px',\r\n              height: '40px',\r\n              border: '2px solid var(--purple-base)',\r\n              borderTop: '2px solid transparent',\r\n              borderRadius: '50%',\r\n              animation: 'spin 1s linear infinite',\r\n              margin: '0 auto',\r\n            }} />\r\n          </div>\r\n        ) : trades.length === 0 ? (\r\n          <div style={{\r\n            textAlign: 'center',\r\n            padding: '60px 20px',\r\n            backgroundColor: 'var(--card-bg)',\r\n            border: '1px solid var(--card-border)',\r\n            borderRadius: '12px',\r\n            color: 'var(--text-secondary)',\r\n          }}>\r\n            <p style={{ fontSize: '16px', marginBottom: '8px' }}>No trades data available</p>\r\n            <p style={{ fontSize: '13px' }}>Add some trades to your journal to see analytics</p>\r\n          </div>\r\n        ) : (\r\n          <>\r\n            {/* Charts Section */}\r\n            <div style={{ marginBottom: '32px' }}>\r\n              <div style={{\r\n                display: 'flex',\r\n                alignItems: 'center',\r\n                gap: '16px',\r\n                flexWrap: 'wrap',\r\n                justifyContent: 'space-between',\r\n                marginBottom: '16px',\r\n              }}>\r\n                <h2 style={{ fontSize: '18px', fontWeight: '600', color: 'var(--text-primary)' }}>\r\n                  Performance Charts\r\n                </h2>\r\n                {dateRange.start && (\r\n                  <span style={{ fontSize: '13px', color: 'var(--text-secondary)' }}>\r\n                    Range: <strong>{dateRange.start}</strong> {dateRange.end && <span>— <strong>{dateRange.end}</strong></span>}\r\n                  </span>\r\n                )}\r\n              </div>\r\n              <div style={{\r\n                backgroundColor: 'var(--card-bg)',\r\n                border: '1px solid var(--card-border)',\r\n                borderRadius: '12px',\r\n                padding: '20px',\r\n              }}>\r\n                <AnalyticsCharts trades={trades} startDate={dateRange.start} endDate={dateRange.end} />\r\n              </div>\r\n            </div>\r\n\r\n            {/* Heatmap and Table Section */}\r\n            <div style={{\r\n              display: 'grid',\r\n              gridTemplateColumns: 'repeat(auto-fit, minmax(400px, 1fr))',\r\n              gap: '24px',\r\n            }}>\r\n              <div style={{\r\n                backgroundColor: 'var(--card-bg)',\r\n                border: '1px solid var(--card-border)',\r\n                borderRadius: '12px',\r\n                padding: '20px',\r\n              }}>\r\n                <h3 style={{ fontSize: '16px', fontWeight: '600', color: 'var(--text-primary)', marginBottom: '16px' }}>\r\n                  Yearly Heatmap\r\n                </h3>\r\n                <YearlyHeatmap trades={trades} onSelectRange={(r) => setDateRange(r)} />\r\n              </div>\r\n              <div style={{\r\n                backgroundColor: 'var(--card-bg)',\r\n                border: '1px solid var(--card-border)',\r\n                borderRadius: '12px',\r\n                padding: '20px',\r\n              }}>\r\n                <h3 style={{ fontSize: '16px', fontWeight: '600', color: 'var(--text-primary)', marginBottom: '16px' }}>\r\n                  Monthly Performance\r\n                </h3>\r\n                <MonthlyPerformanceTable trades={trades} />\r\n              </div>\r\n            </div>\r\n          </>\r\n        )}\r\n      </main>\r\n\r\n      <Toaster position=\"bottom-right\" />\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}}]
}