module.exports=[93695,(e,t,r)=>{t.exports=e.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},70406,(e,t,r)=>{t.exports=e.x("next/dist/compiled/@opentelemetry/api",()=>require("next/dist/compiled/@opentelemetry/api"))},18622,(e,t,r)=>{t.exports=e.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},56704,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},24725,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/after-task-async-storage.external.js",()=>require("next/dist/server/app-render/after-task-async-storage.external.js"))},63021,(e,t,r)=>{t.exports=e.x("@prisma/client-2c3a283f134fdcb6",()=>require("@prisma/client-2c3a283f134fdcb6"))},98043,e=>{"use strict";var t=e.i(63021);let r=null;try{let e=(process.env.DATABASE_URL||"").trim(),a=e.startsWith("file:"),i=e.startsWith("postgres")||e.startsWith("postgresql:");e&&(a||i)?r=function(){try{let e=new t.PrismaClient;return e.$connect().catch(e=>{console.warn("Prisma client connection failed during initialization:",e?.message||e)}),e}catch(e){return console.warn("Failed to create Prisma client:",e),null}}():console.warn("Prisma disabled: DATABASE_URL not set to sqlite or postgres. API routes should handle missing DB.")}catch(e){console.warn("Prisma initialization error:",e),r=null}async function a(){try{r&&await r.$disconnect()}catch(e){console.warn("Error disconnecting Prisma:",e)}}"undefined"!=typeof process&&process.on?.("SIGINT",async()=>{await a(),process.exit(0)}),e.s(["prisma",()=>r])},48855,e=>{"use strict";var t=e.i(89171);let r={success:(e,r,a=200)=>{let i={success:!0,data:e};return r&&(i.pagination={...r,totalPages:Math.ceil(r.total/r.limit)}),t.NextResponse.json(i,{status:a})},error:(e,r,a,i=400)=>t.NextResponse.json({success:!1,error:{code:e,message:r,details:a}},{status:i}),validationError:e=>r.error("VALIDATION_ERROR","Invalid input",e,400),notFound:(e="Resource not found")=>r.error("NOT_FOUND",e,void 0,404),unauthorized:()=>r.error("UNAUTHORIZED","Unauthorized",void 0,401),forbidden:()=>r.error("FORBIDDEN","Access denied",void 0,403),serverError:(e="Internal server error",t)=>r.error("SERVER_ERROR",e,t,500),unavailable:()=>r.error("SERVICE_UNAVAILABLE","Database service unavailable. Using demo data.",void 0,503)};e.s(["apiResponse",0,r])},18226,e=>{"use strict";function t(e){let t={setupQuality:0,timingQuality:0,riskManagement:0,strategyAlignment:0,marketConditionMatch:0},r=[],a=[],i=[],o=[];return e.setupQuality?t.setupQuality=Math.max(0,Math.min(10,e.setupQuality)):(t.setupQuality=6,e.riskRewardRatio&&e.riskRewardRatio>=2&&(t.setupQuality+=2,a.push("Good risk-reward ratio")),e.stopLoss&&e.takeProfit&&(t.setupQuality+=1,a.push("Clear stop and target levels"))),t.timingQuality=7,e.holdingTimeMinutes&&(e.holdingTimeMinutes<5?(t.timingQuality-=2,r.push("Very short holding time"),i.push("Allow trades more time to develop")):e.holdingTimeMinutes>480&&(t.timingQuality-=1,r.push("Very long holding time"),i.push("Consider taking profits earlier"))),t.riskManagement=5,e.stopLoss?(t.riskManagement+=2,a.push("Stop loss in place")):(t.riskManagement-=3,r.push("No stop loss"),i.push("Always use stop losses"),o.push("Implement mandatory stop loss policy")),e.riskRewardRatio&&(e.riskRewardRatio>=2?(t.riskManagement+=2,a.push("Favorable risk-reward ratio")):e.riskRewardRatio<1&&(t.riskManagement-=2,r.push("Poor risk-reward ratio"),i.push("Only take trades with RR >= 2:1"))),t.strategyAlignment=e.strategyId?8:4,e.strategyId?a.push("Strategy-based trade"):(r.push("No strategy specified"),i.push("Always trade with a defined strategy"),o.push("Create and follow trading strategies")),t.marketConditionMatch=e.marketConditionId?8:5,e.marketConditionId&&a.push("Market conditions considered"),{score:Math.round(.25*t.setupQuality+.2*t.timingQuality+.25*t.riskManagement+.15*t.strategyAlignment+.15*t.marketConditionMatch),factors:t,mistakes:r,strengths:a,learningPoints:i,recommendations:o}}function r(e){let t={entryPrecision:7,stopPlacement:5,positionSizing:6,exitDiscipline:6,emotionalControl:7};if(void 0!==e.profitLoss&&null!==e.profitLoss&&(t.entryPrecision=e.profitLoss>0?8:6),e.stopLoss?t.stopPlacement=8:t.stopPlacement=2,e.volume&&(t.positionSizing=Math.min(10,Math.max(4,10*e.volume))),e.takeProfit&&e.exitPrice?t.exitDiscipline=8:"profit"===e.outcome?t.exitDiscipline=7:t.exitDiscipline=5,e.emotionalDrift){let r=e.emotionalDrift;r.confidenceChange<-20||r.stressChange>30?t.emotionalControl=3:r.confidenceChange<-10||r.stressChange>15?t.emotionalControl=5:t.emotionalControl=8}return{score:Math.round(.2*t.entryPrecision+.2*t.stopPlacement+.15*t.positionSizing+.25*t.exitDiscipline+.2*t.emotionalControl),factors:t}}async function a(e,a){let i,o,s=await e.trade.findUnique({where:{id:a},include:{strategy:!0,marketCondition:!0,emotionalState:!0}});if(!s)throw Error(`Trade ${a} not found`);let n=t(s),l=r(s),c=function(e){let t=0,r=0,a=0,i=0,o=0;if(e.emotionalDrift){let s=e.emotionalDrift;t=Math.round(.3*Math.abs(s.confidenceChange||0)+.3*Math.abs(s.stressChange||0)+.2*Math.abs(s.focusChange||0)+.2*Math.abs(s.energyChange||0)),r=Math.max(0,(s.stressChange||0)+.5*(s.energyChange||0)),a=Math.max(0,-1*(s.confidenceChange||0)*.8),i=Math.max(0,.6*t),o=t>50?480:t>25?180:30}else t=e.profitLoss&&e.profitLoss<0?25:10,r=e.profitLoss&&e.profitLoss<0?20:5,a=e.profitLoss&&e.profitLoss<0?15:5,i=.5*t,o=60;return{emotionalCostScore:t,stressAccumulation:r,decisionQualityImpact:a,futurePerformanceImpact:i,recoveryTimeMinutes:o}}(s),u=(i=t(s),o=r(s),Math.round(.6*i.score+.4*o.score));await e.trade.update({where:{id:a},data:{decisionScore:u,decisionQuality:{decisionQualityScore:n.score,executionQualityScore:l.score,overallScore:u,decisionFactors:n.factors,executionFactors:l.factors,mistakes:n.mistakes,strengths:n.strengths,learningPoints:n.learningPoints,recommendations:n.recommendations},emotionalCost:{emotionalCostScore:c.emotionalCostScore,stressAccumulation:c.stressAccumulation,decisionQualityImpact:c.decisionQualityImpact,futurePerformanceImpact:c.futurePerformanceImpact,recoveryTimeMinutes:c.recoveryTimeMinutes,emotionalDrift:s.emotionalDrift,behavioralImpacts:{},physiologicalCosts:{},opportunityCosts:{},longTermEffects:{}}}}),await e.decisionQuality.upsert({where:{tradeId:a},update:{decisionQualityScore:n.score,executionQualityScore:l.score,overallScore:u,decisionFactors:n.factors,executionFactors:l.factors,mistakes:n.mistakes,strengths:n.strengths,learningPoints:n.learningPoints,recommendations:n.recommendations},create:{id:`dq-${a}`,tradeId:a,timestamp:new Date,decisionQualityScore:n.score,executionQualityScore:l.score,overallScore:u,decisionFactors:n.factors,executionFactors:l.factors,mistakes:n.mistakes,strengths:n.strengths,learningPoints:n.learningPoints,recommendations:n.recommendations}}),await e.emotionalCost.upsert({where:{tradeId:a},update:{emotionalCostScore:c.emotionalCostScore,stressAccumulation:c.stressAccumulation,decisionQualityImpact:c.decisionQualityImpact,futurePerformanceImpact:c.futurePerformanceImpact,recoveryTimeMinutes:c.recoveryTimeMinutes,emotionalDrift:s.emotionalDrift},create:{id:`ec-${a}`,tradeId:a,timestamp:new Date,emotionalCostScore:c.emotionalCostScore,stressAccumulation:c.stressAccumulation,decisionQualityImpact:c.decisionQualityImpact,futurePerformanceImpact:c.futurePerformanceImpact,recoveryTimeMinutes:c.recoveryTimeMinutes,emotionalDrift:s.emotionalDrift,behavioralImpacts:{},physiologicalCosts:{},opportunityCosts:{},longTermEffects:{}}})}e.s(["updateTradeAnalytics",()=>a])},98123,e=>{"use strict";var t=e.i(47909),r=e.i(74017),a=e.i(96250),i=e.i(59756),o=e.i(61916),s=e.i(74677),n=e.i(69741),l=e.i(16795),c=e.i(87718),u=e.i(95169),d=e.i(47587),p=e.i(66012),m=e.i(70101),h=e.i(26937),f=e.i(10372),g=e.i(93695);e.i(52474);var y=e.i(220),v=e.i(98043),R=e.i(48855),w=e.i(66545),x=e.i(18226);async function C(e,{params:t}){try{let{id:r}=await t,a=e.headers.get("x-user-id")||"demo-user";if(!v.prisma)return R.apiResponse.unavailable();let i=await v.prisma.trade.findUnique({where:{id:r},include:{screenshots:!0,voiceNotes:!0}});if(!i||i.userId!==a)return R.apiResponse.notFound("Trade not found");return R.apiResponse.success(i)}catch(e){return R.apiResponse.serverError("Failed to fetch trade")}}async function E(e,{params:t}){try{let{id:r}=await t,a=e.headers.get("x-user-id")||"demo-user",i=await e.json(),o=w.TradeUpdateSchema.safeParse(i);if(!o.success){let e=o.error.flatten().fieldErrors;return R.apiResponse.validationError(e)}if(!v.prisma)return R.apiResponse.unavailable();let s=await v.prisma.trade.findUnique({where:{id:r}});if(!s||s.userId!==a)return R.apiResponse.notFound("Trade not found");let n=o.data,l={};n.pair&&(l.pair=n.pair),n.direction&&(l.direction=n.direction),void 0!==n.entryPrice&&(l.entryPrice=n.entryPrice),void 0!==n.exitPrice&&(l.exitPrice=n.exitPrice),n.entryTime&&(l.entryTime=new Date(n.entryTime)),n.exitTime&&(l.exitTime=new Date(n.exitTime)),void 0!==n.volume&&(l.volume=n.volume),void 0!==n.stopLoss&&(l.stopLoss=n.stopLoss),void 0!==n.takeProfit&&(l.takeProfit=n.takeProfit),void 0!==n.riskAmount&&(l.riskAmount=n.riskAmount),void 0!==n.riskPercent&&(l.riskPercent=n.riskPercent),void 0!==n.riskRewardRatio&&(l.riskRewardRatio=n.riskRewardRatio),n.account&&(l.account=n.account),n.broker&&(l.broker=n.broker),void 0!==n.accountBalance&&(l.accountBalance=n.accountBalance),void 0!==n.accountEquity&&(l.accountEquity=n.accountEquity),void 0!==n.profitLoss&&(l.profitLoss=n.profitLoss),void 0!==n.profitLossPercent&&(l.profitLossPercent=n.profitLossPercent),n.outcome&&(l.outcome=n.outcome),n.strategy&&(l.strategy=n.strategy),n.emotionalState&&(l.emotionalState=n.emotionalState),void 0!==n.setupQuality&&(l.setupQuality=n.setupQuality),n.notes&&(l.notes=n.notes),n.whatLearned&&(l.whatLearned=n.whatLearned);let c=await v.prisma.trade.update({where:{id:r},data:l,include:{screenshots:!0,voiceNotes:!0}});try{await (0,x.updateTradeAnalytics)(v.prisma,r)}catch(e){console.warn("Failed to calculate trade analytics:",e)}return R.apiResponse.success(c)}catch(e){return R.apiResponse.serverError("Failed to update trade")}}async function P(e,{params:t}){try{let{id:r}=await t,a=e.headers.get("x-user-id")||"demo-user";if(!v.prisma)return R.apiResponse.unavailable();let i=await v.prisma.trade.findUnique({where:{id:r}});if(!i||i.userId!==a)return R.apiResponse.notFound("Trade not found");return await v.prisma.trade.delete({where:{id:r}}),R.apiResponse.success({message:"Trade deleted"})}catch(e){return R.apiResponse.serverError("Failed to delete trade")}}e.s(["DELETE",()=>P,"GET",()=>C,"PUT",()=>E],58151);var k=e.i(58151);let A=new t.AppRouteRouteModule({definition:{kind:r.RouteKind.APP_ROUTE,page:"/api/trades/[id]/route",pathname:"/api/trades/[id]",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/src/app/api/trades/[id]/route.ts",nextConfigOutput:"",userland:k}),{workAsyncStorage:T,workUnitAsyncStorage:S,serverHooks:b}=A;function I(){return(0,a.patchFetch)({workAsyncStorage:T,workUnitAsyncStorage:S})}async function M(e,t,a){A.isDev&&(0,i.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let v="/api/trades/[id]/route";v=v.replace(/\/index$/,"")||"/";let R=await A.prepare(e,t,{srcPage:v,multiZoneDraftMode:!1});if(!R)return t.statusCode=400,t.end("Bad Request"),null==a.waitUntil||a.waitUntil.call(a,Promise.resolve()),null;let{buildId:w,params:x,nextConfig:C,parsedUrl:E,isDraftMode:P,prerenderManifest:k,routerServerContext:T,isOnDemandRevalidate:S,revalidateOnlyGenerated:b,resolvedPathname:I,clientReferenceManifest:M,serverActionsManifest:D}=R,N=(0,n.normalizeAppPath)(v),L=!!(k.dynamicRoutes[N]||k.routes[I]),q=async()=>((null==T?void 0:T.render404)?await T.render404(e,t,E,!1):t.end("This page could not be found"),null);if(L&&!P){let e=!!k.routes[I],t=k.dynamicRoutes[N];if(t&&!1===t.fallback&&!e){if(C.experimental.adapterPath)return await q();throw new g.NoFallbackError}}let Q=null;!L||A.isDev||P||(Q="/index"===(Q=I)?"/":Q);let U=!0===A.isDev||!L,O=L&&!U;D&&M&&(0,s.setManifestsSingleton)({page:v,clientReferenceManifest:M,serverActionsManifest:D});let _=e.method||"GET",F=(0,o.getTracer)(),j=F.getActiveScopeSpan(),H={params:x,prerenderManifest:k,renderOpts:{experimental:{authInterrupts:!!C.experimental.authInterrupts},cacheComponents:!!C.cacheComponents,supportsDynamicResponse:U,incrementalCache:(0,i.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:C.cacheLife,waitUntil:a.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,r,a,i)=>A.onRequestError(e,t,a,i,T)},sharedContext:{buildId:w}},$=new l.NodeNextRequest(e),B=new l.NodeNextResponse(t),V=c.NextRequestAdapter.fromNodeNextRequest($,(0,c.signalFromNodeResponse)(t));try{let s=async e=>A.handle(V,H).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let r=F.getRootSpanAttributes();if(!r)return;if(r.get("next.span_type")!==u.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${r.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let a=r.get("next.route");if(a){let t=`${_} ${a}`;e.setAttributes({"next.route":a,"http.route":a,"next.span_name":t}),e.updateName(t)}else e.updateName(`${_} ${v}`)}),n=!!(0,i.getRequestMeta)(e,"minimalMode"),l=async i=>{var o,l;let c=async({previousCacheEntry:r})=>{try{if(!n&&S&&b&&!r)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let o=await s(i);e.fetchMetrics=H.renderOpts.fetchMetrics;let l=H.renderOpts.pendingWaitUntil;l&&a.waitUntil&&(a.waitUntil(l),l=void 0);let c=H.renderOpts.collectedTags;if(!L)return await (0,p.sendResponse)($,B,o,H.renderOpts.pendingWaitUntil),null;{let e=await o.blob(),t=(0,m.toNodeOutgoingHttpHeaders)(o.headers);c&&(t[f.NEXT_CACHE_TAGS_HEADER]=c),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let r=void 0!==H.renderOpts.collectedRevalidate&&!(H.renderOpts.collectedRevalidate>=f.INFINITE_CACHE)&&H.renderOpts.collectedRevalidate,a=void 0===H.renderOpts.collectedExpire||H.renderOpts.collectedExpire>=f.INFINITE_CACHE?void 0:H.renderOpts.collectedExpire;return{value:{kind:y.CachedRouteKind.APP_ROUTE,status:o.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:r,expire:a}}}}catch(t){throw(null==r?void 0:r.isStale)&&await A.onRequestError(e,t,{routerKind:"App Router",routePath:v,routeType:"route",revalidateReason:(0,d.getRevalidateReason)({isStaticGeneration:O,isOnDemandRevalidate:S})},!1,T),t}},u=await A.handleResponse({req:e,nextConfig:C,cacheKey:Q,routeKind:r.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:k,isRoutePPREnabled:!1,isOnDemandRevalidate:S,revalidateOnlyGenerated:b,responseGenerator:c,waitUntil:a.waitUntil,isMinimalMode:n});if(!L)return null;if((null==u||null==(o=u.value)?void 0:o.kind)!==y.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==u||null==(l=u.value)?void 0:l.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});n||t.setHeader("x-nextjs-cache",S?"REVALIDATED":u.isMiss?"MISS":u.isStale?"STALE":"HIT"),P&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let g=(0,m.fromNodeOutgoingHttpHeaders)(u.value.headers);return n&&L||g.delete(f.NEXT_CACHE_TAGS_HEADER),!u.cacheControl||t.getHeader("Cache-Control")||g.get("Cache-Control")||g.set("Cache-Control",(0,h.getCacheControlHeader)(u.cacheControl)),await (0,p.sendResponse)($,B,new Response(u.value.body,{headers:g,status:u.value.status||200})),null};j?await l(j):await F.withPropagatedContext(e.headers,()=>F.trace(u.BaseServerSpan.handleRequest,{spanName:`${_} ${v}`,kind:o.SpanKind.SERVER,attributes:{"http.method":_,"http.target":e.url}},l))}catch(t){if(t instanceof g.NoFallbackError||await A.onRequestError(e,t,{routerKind:"App Router",routePath:N,routeType:"route",revalidateReason:(0,d.getRevalidateReason)({isStaticGeneration:O,isOnDemandRevalidate:S})},!1,T),L)throw t;return await (0,p.sendResponse)($,B,new Response(null,{status:500})),null}}e.s(["handler",()=>M,"patchFetch",()=>I,"routeModule",()=>A,"serverHooks",()=>b,"workAsyncStorage",()=>T,"workUnitAsyncStorage",()=>S],98123)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__b6df19a1._.js.map