module.exports=[47137,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(27348),e=a.i(63418),f=a.i(46271),g=a.i(71297),h=a.i(6704);let i=[{id:"htf_bias",label:"Higher Timeframe Bias",description:"Market bias on higher timeframe aligns with trade direction",icon:d.FiTrendingUp,required:!0,category:"market"},{id:"poi_identified",label:"Points of Interest",description:"Key levels, support/resistance, and POI identified",icon:d.FiTarget,required:!0,category:"setup"},{id:"entry_rules",label:"Entry Rules Met",description:"All strategy entry criteria satisfied",icon:d.FiCheck,required:!0,category:"setup"},{id:"session_respect",label:"Session Respect",description:"Trading within appropriate session time",icon:d.FiTarget,required:!1,category:"market"},{id:"risk_rules",label:"Risk Rules",description:"Position size and risk limits respected",icon:d.FiShield,required:!0,category:"risk"},{id:"emotional_state",label:"Emotional State",description:"Calm, focused, and disciplined mindset",icon:d.FiHeart,required:!0,category:"emotional"}],j={setup:"bg-blue-500",risk:"bg-red-500",emotional:"bg-purple-500",market:"bg-green-500"},k={setup:"Setup",risk:"Risk",emotional:"Emotional",market:"Market"};function l({tradeId:a,onChecklistComplete:e,onChecklistChange:l,className:m=""}){let[n,o]=(0,c.useState)(new Set),[p,q]=(0,c.useState)(!1),[r,s]=(0,c.useState)(new Set);(0,c.useEffect)(()=>{a&&t()},[a]);let t=async()=>{if(a)try{let b=await fetch(`/api/trades/${a}/checklist`,{headers:{"x-user-id":"demo-user"}});if(b.ok){let a=await b.json(),c=Array.isArray(a.completedItems)?a.completedItems:[],d=new Set(c.filter(a=>"string"==typeof a));o(d),s(d)}}catch(a){console.error("Failed to load checklist state:",a)}},u=async b=>{if(a){q(!0);try{(await fetch(`/api/trades/${a}/checklist`,{method:"POST",headers:{"Content-Type":"application/json","x-user-id":"demo-user"},body:JSON.stringify({completedItems:Array.from(b)})})).ok?(s(new Set(b)),h.default.success("Checklist saved")):h.default.error("Failed to save checklist")}catch(a){console.error("Failed to save checklist:",a),h.default.error("Failed to save checklist")}finally{q(!1)}}},v=i.filter(a=>a.required),w=v.every(a=>n.has(a.id)),x=Math.round(n.size/i.length*100),y=i.reduce((a,b)=>(a[b.category]||(a[b.category]=[]),a[b.category].push(b),a),{});return(0,b.jsxs)(g.default,{className:`p-6 ${m}`,children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Pre-Trade Checklist"}),(0,b.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:"Complete all required items before entering the trade"})]}),(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsxs)("div",{className:"text-right",children:[(0,b.jsxs)("div",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:[x,"%"]}),(0,b.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Complete"})]}),w?(0,b.jsx)(d.FiCheck,{className:"w-8 h-8 text-green-500"}):(0,b.jsx)(d.FiAlertCircle,{className:"w-8 h-8 text-yellow-500"})]})]}),(0,b.jsx)("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2 mb-6",children:(0,b.jsx)(f.motion.div,{className:"bg-gradient-to-r from-blue-500 to-purple-600 h-2 rounded-full",initial:{width:0},animate:{width:`${x}%`},transition:{duration:.5}})}),(0,b.jsx)("div",{className:"space-y-6",children:Object.entries(y).map(([c,g])=>(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex items-center mb-3",children:[(0,b.jsx)("div",{className:`w-3 h-3 rounded-full ${j[c]} mr-2`}),(0,b.jsx)("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 uppercase tracking-wide",children:k[c]})]}),(0,b.jsx)("div",{className:"space-y-3 ml-5",children:g.map(c=>{let g=c.icon,h=n.has(c.id),j=c.required;return(0,b.jsxs)(f.motion.div,{className:`flex items-start space-x-3 p-3 rounded-lg border-2 transition-all cursor-pointer ${h?"border-green-200 bg-green-50 dark:border-green-800 dark:bg-green-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"}`,onClick:()=>{var b;let d,f;return b=c.id,(d=new Set(n)).has(b)?d.delete(b):d.add(b),o(d),a&&u(d),f=i.filter(a=>a.required).map(a=>a.id).every(a=>d.has(a)),void(l?.(Array.from(d),f),f&&!n.has(b)&&e?.(Array.from(d)))},whileHover:{scale:1.02},whileTap:{scale:.98},children:[(0,b.jsx)("div",{className:`flex-shrink-0 w-6 h-6 rounded-full flex items-center justify-center border-2 ${h?"bg-green-500 border-green-500 text-white":"border-gray-300 dark:border-gray-600"}`,children:h?(0,b.jsx)(d.FiCheck,{className:"w-4 h-4"}):(0,b.jsx)("div",{className:"w-2 h-2 rounded-full bg-gray-300 dark:bg-gray-600"})}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)(g,{className:`w-4 h-4 ${h?"text-green-600":"text-gray-400"}`}),(0,b.jsxs)("span",{className:`text-sm font-medium ${h?"text-green-800 dark:text-green-200":"text-gray-900 dark:text-white"}`,children:[c.label,j&&(0,b.jsx)("span",{className:"text-red-500 ml-1",children:"*"})]})]}),(0,b.jsx)("p",{className:`text-xs mt-1 ${h?"text-green-700 dark:text-green-300":"text-gray-600 dark:text-gray-400"}`,children:c.description})]})]},c.id)})})]},c))}),(0,b.jsx)("div",{className:"mt-6 p-4 rounded-lg bg-gray-50 dark:bg-gray-800",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("div",{className:"flex items-center space-x-2",children:w?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(d.FiCheck,{className:"w-5 h-5 text-green-500"}),(0,b.jsx)("span",{className:"text-sm font-medium text-green-700 dark:text-green-300",children:"All required items completed!"})]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(d.FiAlertCircle,{className:"w-5 h-5 text-yellow-500"}),(0,b.jsxs)("span",{className:"text-sm font-medium text-yellow-700 dark:text-yellow-300",children:[v.length-v.filter(a=>n.has(a.id)).length," required items remaining"]})]})}),p&&(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"}),(0,b.jsx)("span",{className:"text-xs text-gray-500",children:"Saving..."})]})]})})]})}var m=a.i(28268);let n=[{value:"none",label:"No Action",description:"Monitoring the trade"},{value:"sl_moved",label:"Stop Loss Moved",description:"Adjusted stop loss level"},{value:"tp_adjusted",label:"Take Profit Adjusted",description:"Modified profit target"},{value:"partial_close",label:"Partial Close",description:"Closed portion of position"},{value:"manual_close",label:"Manual Close",description:"Closed entire position manually"}],o=[{value:"followed_plan",label:"Followed Plan",description:"Executed according to strategy"},{value:"market_structure",label:"Market Structure",description:"Responding to price action"},{value:"emotional",label:"Emotional Response",description:"Reacted based on emotions"},{value:"fear",label:"Fear",description:"Fear-driven decision"},{value:"greed",label:"Greed",description:"Greed-driven decision"},{value:"uncertainty",label:"Uncertainty",description:"Uncertain market conditions"},{value:"distraction",label:"Distraction",description:"Lost focus or distracted"}],p=[{value:"calm",label:"Calm",color:"bg-green-100 text-green-800"},{value:"confident",label:"Confident",color:"bg-blue-100 text-blue-800"},{value:"anxious",label:"Anxious",color:"bg-yellow-100 text-yellow-800"},{value:"hesitant",label:"Hesitant",color:"bg-orange-100 text-orange-800"},{value:"overconfident",label:"Overconfident",color:"bg-purple-100 text-purple-800"},{value:"fearful",label:"Fearful",color:"bg-red-100 text-red-800"},{value:"impulsive",label:"Impulsive",color:"bg-pink-100 text-pink-800"},{value:"detached",label:"Detached",color:"bg-gray-100 text-gray-800"}],q=[{value:"disciplined",label:"Disciplined",description:"Following rules consistently"},{value:"patient",label:"Patient",description:"Waiting for proper setup"},{value:"focused",label:"Focused",description:"Maintaining attention"},{value:"impulsive",label:"Impulsive",description:"Acting without thinking"},{value:"fearful",label:"Fearful",description:"Avoiding necessary actions"},{value:"greedy",label:"Greedy",description:"Taking excessive risk"},{value:"distracted",label:"Distracted",description:"Not fully engaged"},{value:"overconfident",label:"Overconfident",description:"Taking unnecessary risks"}];function r({isOpen:a,onClose:e,tradeId:g,onUpdateAdded:i,existingUpdates:j=[]}){let[k,l]=(0,c.useState)(!1),[r,s]=(0,c.useState)({id:"",action:"none",reason:"",emotionalState:"",behavior:[],notes:"",timestamp:new Date().toISOString()}),t=()=>{s({id:"",action:"none",reason:"",emotionalState:"",behavior:[],notes:"",timestamp:new Date().toISOString()}),e()},u=async a=>{if(a.preventDefault(),!r.action)return void h.default.error("Please select an action");l(!0);try{let a=await fetch(`/api/trades/${g}/updates`,{method:"POST",headers:{"Content-Type":"application/json","x-user-id":"demo-user"},body:JSON.stringify({action:r.action,reason:r.reason||null,emotionalState:r.emotionalState||null,behavior:r.behavior&&r.behavior.length>0?r.behavior:null,notes:r.notes||null})});if(!a.ok){let b=await a.json();throw Error(b.error||"Failed to add update")}let b=await a.json();h.default.success("Trade update added successfully"),i?.(b),t()}catch(a){console.error("Error adding trade update:",a),h.default.error(a instanceof Error?a.message:"Failed to add trade update")}finally{l(!1)}};return(0,b.jsx)(m.default,{open:a,onClose:t,children:(0,b.jsxs)(f.motion.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},style:{background:"var(--background)",borderRadius:"12px",boxShadow:"var(--shadow-lg)",maxWidth:"800px",width:"100%",margin:"0 16px",maxHeight:"90vh",overflowY:"auto"},children:[(0,b.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"24px",borderBottom:"1px solid var(--border)"},children:[(0,b.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[(0,b.jsx)("div",{style:{width:"40px",height:"40px",background:"var(--accent-bg)",borderRadius:"8px",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,b.jsx)(d.FiClock,{style:{width:"20px",height:"20px",color:"var(--accent-color)"}})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{style:{fontSize:"20px",fontWeight:"600",color:"var(--text-primary)",margin:"0"},children:"Add Trade Update"}),(0,b.jsx)("p",{style:{fontSize:"14px",color:"var(--text-secondary)",margin:"4px 0 0 0"},children:"Record changes and observations during the trade"})]})]}),(0,b.jsx)("button",{onClick:t,style:{padding:"8px",background:"transparent",border:"none",borderRadius:"6px",cursor:"pointer",color:"var(--text-secondary)",transition:"background 0.2s"},onMouseEnter:a=>a.currentTarget.style.background="var(--hover-bg)",onMouseLeave:a=>a.currentTarget.style.background="transparent",children:(0,b.jsx)(d.FiX,{style:{width:"20px",height:"20px"}})})]}),(0,b.jsxs)("form",{onSubmit:u,style:{padding:"24px",display:"flex",flexDirection:"column",gap:"24px"},children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{style:{display:"block",fontSize:"14px",fontWeight:"500",color:"var(--text-primary)",marginBottom:"12px"},children:"What action did you take?"}),(0,b.jsx)("div",{style:{display:"grid",gridTemplateColumns:"1fr",gap:"12px"},children:n.map(a=>(0,b.jsxs)("label",{style:{display:"flex",alignItems:"flex-start",gap:"12px",padding:"16px",borderRadius:"8px",border:r.action===a.value?"2px solid var(--accent-color)":"2px solid var(--border)",background:r.action===a.value?"var(--accent-bg)":"var(--card-bg)",cursor:"pointer",transition:"all 0.2s"},children:[(0,b.jsx)("input",{type:"radio",name:"action",value:a.value,checked:r.action===a.value,onChange:a=>s(b=>({...b,action:a.target.value})),style:{marginTop:"2px"}}),(0,b.jsxs)("div",{style:{flex:1},children:[(0,b.jsx)("div",{style:{fontWeight:"500",color:"var(--text-primary)",marginBottom:"4px"},children:a.label}),(0,b.jsx)("div",{style:{fontSize:"14px",color:"var(--text-secondary)"},children:a.description})]})]},a.value))})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{style:{display:"block",fontSize:"14px",fontWeight:"500",color:"var(--text-primary)",marginBottom:"12px"},children:"Why did you take this action?"}),(0,b.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"12px"},children:o.map(a=>(0,b.jsxs)("label",{style:{display:"flex",alignItems:"flex-start",gap:"8px",padding:"16px",borderRadius:"8px",border:r.reason===a.value?"2px solid var(--accent-color)":"2px solid var(--border)",background:r.reason===a.value?"var(--accent-bg)":"var(--card-bg)",cursor:"pointer",transition:"all 0.2s"},children:[(0,b.jsx)("input",{type:"radio",name:"reason",value:a.value,checked:r.reason===a.value,onChange:a=>s(b=>({...b,reason:a.target.value})),style:{marginTop:"2px"}}),(0,b.jsx)("div",{style:{fontSize:"12px"},children:(0,b.jsx)("div",{style:{fontWeight:"500",color:"var(--text-primary)"},children:a.label})})]},a.value))})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{style:{display:"block",fontSize:"14px",fontWeight:"500",color:"var(--text-primary)",marginBottom:"12px"},children:"How were you feeling?"}),(0,b.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:"8px"},children:p.map(a=>(0,b.jsx)("button",{type:"button",onClick:()=>s(b=>({...b,emotionalState:b.emotionalState===a.value?"":a.value})),style:{padding:"8px 16px",borderRadius:"20px",fontSize:"14px",fontWeight:"500",border:"none",cursor:"pointer",transition:"all 0.2s",background:r.emotionalState===a.value?a.color:"var(--card-bg)",color:r.emotionalState===a.value?"white":"var(--text-primary)",boxShadow:r.emotionalState===a.value?"0 0 0 2px var(--accent-color)":"none"},children:a.label},a.value))})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{style:{display:"block",fontSize:"14px",fontWeight:"500",color:"var(--text-primary)",marginBottom:"12px"},children:"How did you behave during this update?"}),(0,b.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"12px"},children:q.map(a=>(0,b.jsxs)("label",{style:{display:"flex",alignItems:"flex-start",gap:"8px",padding:"16px",borderRadius:"8px",border:r.behavior?.includes(a.value)?"2px solid var(--success-color)":"2px solid var(--border)",background:r.behavior?.includes(a.value)?"var(--success-bg)":"var(--card-bg)",cursor:"pointer",transition:"all 0.2s"},children:[(0,b.jsx)("input",{type:"checkbox",checked:r.behavior?.includes(a.value)||!1,onChange:()=>{var b;return b=a.value,void s(a=>({...a,behavior:a.behavior?.includes(b)?a.behavior.filter(a=>a!==b):[...a.behavior||[],b]}))},style:{marginTop:"2px"}}),(0,b.jsxs)("div",{style:{fontSize:"12px",flex:1},children:[(0,b.jsx)("div",{style:{fontWeight:"500",color:"var(--text-primary)",marginBottom:"4px"},children:a.label}),(0,b.jsx)("div",{style:{color:"var(--text-secondary)",lineHeight:"1.4"},children:a.description})]})]},a.value))})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{style:{display:"block",fontSize:"14px",fontWeight:"500",color:"var(--text-primary)",marginBottom:"8px"},children:"Additional Notes"}),(0,b.jsx)("textarea",{value:r.notes,onChange:a=>s(b=>({...b,notes:a.target.value})),placeholder:"Any additional observations or thoughts...",rows:3,style:{width:"100%",padding:"12px",border:"1px solid var(--border)",borderRadius:"8px",background:"var(--card-bg)",color:"var(--text-primary)",fontSize:"14px",resize:"vertical",outline:"none",transition:"border-color 0.2s"},onFocus:a=>a.currentTarget.style.borderColor="var(--accent-color)",onBlur:a=>a.currentTarget.style.borderColor="var(--border)"})]}),(0,b.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px",paddingTop:"16px",borderTop:"1px solid var(--border)"},children:[(0,b.jsx)("button",{type:"button",onClick:t,style:{padding:"8px 16px",background:"transparent",border:"none",borderRadius:"6px",color:"var(--text-secondary)",cursor:"pointer",fontSize:"14px",transition:"background 0.2s"},onMouseEnter:a=>a.currentTarget.style.background="var(--hover-bg)",onMouseLeave:a=>a.currentTarget.style.background="transparent",children:"Cancel"}),(0,b.jsx)("button",{type:"submit",disabled:k,style:{display:"flex",alignItems:"center",gap:"8px",padding:"8px 24px",background:k?"var(--disabled-bg)":"var(--accent-color)",border:"none",borderRadius:"6px",color:"white",cursor:k?"not-allowed":"pointer",fontSize:"14px",fontWeight:"500",transition:"background 0.2s"},onMouseEnter:a=>{k||(a.currentTarget.style.background="var(--accent-hover)")},onMouseLeave:a=>{k||(a.currentTarget.style.background="var(--accent-color)")},children:k?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{style:{width:"16px",height:"16px",border:"2px solid transparent",borderTop:"2px solid white",borderRadius:"50%",animation:"spin 1s linear infinite"}}),(0,b.jsx)("span",{children:"Saving..."})]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(d.FiSave,{style:{width:"16px",height:"16px"}}),(0,b.jsx)("span",{children:"Add Update"})]})})]})]})]})})}let s={none:d.FiMinus,sl_moved:d.FiTrendingDown,tp_adjusted:d.FiTrendingUp,partial_close:d.FiPlus,manual_close:d.FiX},t={none:"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-200",sl_moved:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200",tp_adjusted:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",partial_close:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200",manual_close:"bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200"},u={calm:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",confident:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200",anxious:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200",hesitant:"bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200",overconfident:"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200",fearful:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200",impulsive:"bg-pink-100 text-pink-800 dark:bg-pink-900 dark:text-pink-200",detached:"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-200"},v={followed_plan:"Followed Plan",market_structure:"Market Structure",emotional:"Emotional",fear:"Fear",greed:"Greed",uncertainty:"Uncertainty",distraction:"Distraction"};function w({tradeId:a,className:e=""}){let[h,i]=(0,c.useState)([]),[j,k]=(0,c.useState)(!0),[l,m]=(0,c.useState)(null),[n,o]=(0,c.useState)(!1);(0,c.useEffect)(()=>{p()},[a]);let p=async()=>{try{k(!0),m(null);let b=await fetch(`/api/trades/${a}/updates`,{headers:{"x-user-id":"demo-user"}});if(!b.ok)throw Error("Failed to load trade updates");let c=await b.json();i(c)}catch(a){console.error("Error loading trade updates:",a),m(a instanceof Error?a.message:"Failed to load updates")}finally{k(!1)}};return j?(0,b.jsx)(g.default,{className:`p-6 ${e}`,children:(0,b.jsxs)("div",{className:"flex items-center justify-center py-8",children:[(0,b.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"}),(0,b.jsx)("span",{className:"ml-3 text-gray-600 dark:text-gray-400",children:"Loading updates..."})]})}):l?(0,b.jsx)(g.default,{className:`p-6 ${e}`,children:(0,b.jsxs)("div",{className:"text-center py-8",children:[(0,b.jsx)("div",{className:"text-red-500 mb-2",children:"Failed to load trade updates"}),(0,b.jsx)("button",{onClick:p,className:"text-blue-600 hover:text-blue-700 underline",children:"Try again"})]})}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(g.default,{className:`p-6 ${e}`,children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,b.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,b.jsx)("div",{className:"w-10 h-10 bg-blue-100 dark:bg-blue-900 rounded-lg flex items-center justify-center",children:(0,b.jsx)(d.FiClock,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Trade Updates"}),(0,b.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[h.length," update",1!==h.length?"s":""," recorded"]})]})]}),(0,b.jsxs)("button",{onClick:()=>o(!0),className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors",children:[(0,b.jsx)(d.FiEdit3,{className:"w-4 h-4"}),(0,b.jsx)("span",{children:"Add Update"})]})]}),0===h.length?(0,b.jsxs)("div",{className:"text-center py-12",children:[(0,b.jsx)(d.FiClock,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),(0,b.jsx)("h4",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"No updates yet"}),(0,b.jsx)("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"Record changes and observations as the trade progresses"}),(0,b.jsxs)("button",{onClick:()=>o(!0),className:"inline-flex items-center space-x-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors",children:[(0,b.jsx)(d.FiPlus,{className:"w-4 h-4"}),(0,b.jsx)("span",{children:"Add First Update"})]})]}):(0,b.jsx)("div",{className:"space-y-4",children:h.map((a,c)=>{let e,g,h,i,j,k=s[a.action]||d.FiMinus;return(0,b.jsx)(f.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1*c},className:"border border-gray-200 dark:border-gray-700 rounded-lg p-4 hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors",children:(0,b.jsx)("div",{className:"flex items-start justify-between",children:(0,b.jsxs)("div",{className:"flex items-start space-x-4 flex-1",children:[(0,b.jsxs)("div",{className:`flex-shrink-0 px-3 py-1 rounded-full text-xs font-medium ${t[a.action]||t.none}`,children:[(0,b.jsx)(k,{className:"w-3 h-3 inline mr-1"}),a.action.replace("_"," ").replace(/\b\w/g,a=>a.toUpperCase())]}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,b.jsx)("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:(e=new Date(a.timestamp),h=Math.floor((g=new Date().getTime()-e.getTime())/6e4),i=Math.floor(g/36e5),j=Math.floor(g/864e5),h<1?"Just now":h<60?`${h}m ago`:i<24?`${i}h ago`:j<7?`${j}d ago`:e.toLocaleDateString())}),a.reason&&(0,b.jsx)("span",{className:"text-xs bg-gray-100 dark:bg-gray-700 px-2 py-1 rounded",children:v[a.reason]||a.reason})]}),a.emotionalState&&(0,b.jsx)("div",{className:"mb-2",children:(0,b.jsxs)("span",{className:`inline-block px-2 py-1 rounded-full text-xs font-medium ${u[a.emotionalState]||"bg-gray-100 text-gray-800"}`,children:["Feeling: ",a.emotionalState.replace(/\b\w/g,a=>a.toUpperCase())]})}),a.behavior&&a.behavior.length>0&&(0,b.jsx)("div",{className:"mb-2",children:(0,b.jsx)("div",{className:"flex flex-wrap gap-1",children:a.behavior.map(a=>(0,b.jsx)("span",{className:"inline-block px-2 py-1 bg-purple-100 dark:bg-purple-900 text-purple-800 dark:text-purple-200 rounded text-xs",children:a.replace(/\b\w/g,a=>a.toUpperCase())},a))})}),a.notes&&(0,b.jsx)("div",{className:"text-sm text-gray-700 dark:text-gray-300 bg-gray-50 dark:bg-gray-800 p-3 rounded-lg",children:a.notes})]})]})})},a.id)})})]}),(0,b.jsx)(r,{isOpen:n,onClose:()=>o(!1),tradeId:a,onUpdateAdded:a=>{i(b=>[...b,a].sort((a,b)=>new Date(a.timestamp).getTime()-new Date(b.timestamp).getTime()))},existingUpdates:h})]})}let x=[{value:"yes",label:"Yes",description:"Fully followed the plan"},{value:"mostly",label:"Mostly",description:"Minor deviations only"},{value:"no",label:"No",description:"Significant deviations"}],y=[{value:"calm",label:"Calm",color:"bg-green-100 text-green-800"},{value:"confident",label:"Confident",color:"bg-blue-100 text-blue-800"},{value:"anxious",label:"Anxious",color:"bg-yellow-100 text-yellow-800"},{value:"hesitant",label:"Hesitant",color:"bg-orange-100 text-orange-800"},{value:"overconfident",label:"Overconfident",color:"bg-purple-100 text-purple-800"},{value:"fearful",label:"Fearful",color:"bg-red-100 text-red-800"},{value:"impulsive",label:"Impulsive",color:"bg-pink-100 text-pink-800"},{value:"detached",label:"Detached",color:"bg-gray-100 text-gray-800"}],z=[{value:"disciplined",label:"Disciplined",description:"Followed all rules"},{value:"patient",label:"Patient",description:"Waited for proper setup"},{value:"focused",label:"Focused",description:"Maintained attention"},{value:"impulsive",label:"Impulsive",description:"Acted without thinking"},{value:"fearful",label:"Fearful",description:"Avoided necessary actions"},{value:"greedy",label:"Greedy",description:"Took excessive risk"},{value:"distracted",label:"Distracted",description:"Lost focus"},{value:"overconfident",label:"Overconfident",description:"Took unnecessary risks"}];function A({tradeId:a,onReflectionComplete:e,className:f=""}){let[i,j]=(0,c.useState)(!1),[k,l]=(0,c.useState)(!1),[m,n]=(0,c.useState)({followedPlan:"",rulesRespected:"",emotionalSummary:[],behavioralOutcomes:[],whatWentRight:"",whatWentWrong:"",lessonLearned:"",ruleToReinforce:""});(0,c.useEffect)(()=>{o()},[a]);let o=async()=>{try{j(!0);let b=await fetch(`/api/trades/${a}/reflection`,{headers:{"x-user-id":"demo-user"}});if(b.ok){let a=await b.json();n({followedPlan:a.followedPlan||"",rulesRespected:a.rulesRespected||"",emotionalSummary:a.emotionalSummary?JSON.parse(a.emotionalSummary):[],behavioralOutcomes:a.behavioralOutcomes?JSON.parse(a.behavioralOutcomes):[],whatWentRight:a.whatWentRight||"",whatWentWrong:a.whatWentWrong||"",lessonLearned:a.lessonLearned||"",ruleToReinforce:a.ruleToReinforce||""})}}catch(a){console.error("Failed to load reflection:",a)}finally{j(!1)}},p=async b=>{if(b.preventDefault(),!m.followedPlan||!m.rulesRespected)return void h.default.error("Please complete the execution quality assessment");l(!0);try{let b=await fetch(`/api/trades/${a}/reflection`,{method:"POST",headers:{"Content-Type":"application/json","x-user-id":"demo-user"},body:JSON.stringify({followedPlan:m.followedPlan,rulesRespected:m.rulesRespected,emotionalSummary:m.emotionalSummary,behavioralOutcomes:m.behavioralOutcomes,whatWentRight:m.whatWentRight,whatWentWrong:m.whatWentWrong,lessonLearned:m.lessonLearned,ruleToReinforce:m.ruleToReinforce})});if(!b.ok){let a=await b.json();throw Error(a.error||"Failed to save reflection")}let c=await b.json();h.default.success("Reflection saved successfully"),e?.(c)}catch(a){console.error("Error saving reflection:",a),h.default.error(a instanceof Error?a.message:"Failed to save reflection")}finally{l(!1)}};return i?(0,b.jsx)(g.default,{className:`p-6 ${f}`,children:(0,b.jsxs)("div",{className:"flex items-center justify-center py-8",children:[(0,b.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"}),(0,b.jsx)("span",{className:"ml-3 text-gray-600 dark:text-gray-400",children:"Loading reflection..."})]})}):(0,b.jsxs)(g.default,{className:`p-6 ${f}`,children:[(0,b.jsxs)("div",{className:"flex items-center space-x-3 mb-6",children:[(0,b.jsx)("div",{className:"w-10 h-10 bg-green-100 dark:bg-green-900 rounded-lg flex items-center justify-center",children:(0,b.jsx)(d.FiBookOpen,{className:"w-5 h-5 text-green-600 dark:text-green-400"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Post-Trade Reflection"}),(0,b.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Analyze what happened and learn from the experience"})]})]}),(0,b.jsxs)("form",{onSubmit:p,className:"space-y-6",children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Did you follow your trading plan?"}),(0,b.jsx)("div",{className:"space-y-2",children:x.map(a=>(0,b.jsxs)("label",{className:`flex items-center space-x-3 p-3 rounded-lg border-2 cursor-pointer transition-all ${m.followedPlan===a.value?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"}`,children:[(0,b.jsx)("input",{type:"radio",name:"followedPlan",value:a.value,checked:m.followedPlan===a.value,onChange:a=>n(b=>({...b,followedPlan:a.target.value})),className:"text-blue-600"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"font-medium text-gray-900 dark:text-white",children:a.label}),(0,b.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:a.description})]})]},a.value))})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Did you respect your trading rules?"}),(0,b.jsx)("div",{className:"space-y-2",children:x.map(a=>(0,b.jsxs)("label",{className:`flex items-center space-x-3 p-3 rounded-lg border-2 cursor-pointer transition-all ${m.rulesRespected===a.value?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"}`,children:[(0,b.jsx)("input",{type:"radio",name:"rulesRespected",value:a.value,checked:m.rulesRespected===a.value,onChange:a=>n(b=>({...b,rulesRespected:a.target.value})),className:"text-blue-600"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"font-medium text-gray-900 dark:text-white",children:a.label}),(0,b.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:a.description})]})]},`rules-${a.value}`))})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"How did you feel during and after the trade?"}),(0,b.jsx)("div",{className:"flex flex-wrap gap-2",children:y.map(a=>(0,b.jsx)("button",{type:"button",onClick:()=>{var b;return b=a.value,void n(a=>({...a,emotionalSummary:a.emotionalSummary.includes(b)?a.emotionalSummary.filter(a=>a!==b):[...a.emotionalSummary,b]}))},className:`px-3 py-2 rounded-full text-sm font-medium transition-all ${m.emotionalSummary.includes(a.value)?a.color+" ring-2 ring-offset-2 ring-blue-500":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"}`,children:a.label},a.value))})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"How did you behave during this trade?"}),(0,b.jsx)("div",{className:"grid grid-cols-2 gap-3",children:z.map(a=>(0,b.jsxs)("label",{className:`flex items-start space-x-2 p-3 rounded-lg border cursor-pointer transition-all ${m.behavioralOutcomes.includes(a.value)?"border-green-500 bg-green-50 dark:bg-green-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"}`,children:[(0,b.jsx)("input",{type:"checkbox",checked:m.behavioralOutcomes.includes(a.value),onChange:()=>{var b;return b=a.value,void n(a=>({...a,behavioralOutcomes:a.behavioralOutcomes.includes(b)?a.behavioralOutcomes.filter(a=>a!==b):[...a.behavioralOutcomes,b]}))},className:"mt-0.5"}),(0,b.jsxs)("div",{className:"text-xs",children:[(0,b.jsx)("div",{className:"font-medium text-gray-900 dark:text-white",children:a.label}),(0,b.jsx)("div",{className:"text-gray-600 dark:text-gray-400",children:a.description})]})]},a.value))})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"What went right?"}),(0,b.jsx)("textarea",{value:m.whatWentRight,onChange:a=>n(b=>({...b,whatWentRight:a.target.value})),placeholder:"What did you do well in this trade?",rows:4,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"What went wrong?"}),(0,b.jsx)("textarea",{value:m.whatWentWrong,onChange:a=>n(b=>({...b,whatWentWrong:a.target.value})),placeholder:"What could you have done better?",rows:4,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Key lesson learned"}),(0,b.jsx)("textarea",{value:m.lessonLearned,onChange:a=>n(b=>({...b,lessonLearned:a.target.value})),placeholder:"What's the most important takeaway from this trade?",rows:3,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Rule to reinforce"}),(0,b.jsx)("textarea",{value:m.ruleToReinforce,onChange:a=>n(b=>({...b,ruleToReinforce:a.target.value})),placeholder:"Which trading rule should you focus on reinforcing?",rows:3,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]})]}),(0,b.jsx)("div",{className:"flex justify-end pt-4 border-t border-gray-200 dark:border-gray-700",children:(0,b.jsx)("button",{type:"submit",disabled:k,className:"flex items-center space-x-2 px-6 py-2 bg-green-600 hover:bg-green-700 disabled:bg-green-400 text-white rounded-lg transition-colors",children:k?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),(0,b.jsx)("span",{children:"Saving..."})]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(d.FiSave,{className:"w-4 h-4"}),(0,b.jsx)("span",{children:"Save Reflection"})]})})})]})]})}function B({onRecordingSaved:a}){let e=(0,c.useRef)(null),f=(0,c.useRef)([]),[g,i]=(0,c.useState)(!1),[j,k]=(0,c.useState)(0),[l,m]=(0,c.useState)([]),[n,o]=(0,c.useState)(null);(0,c.useEffect)(()=>{let a;return g&&(a=setInterval(()=>{k(a=>a+1)},1e3)),()=>clearInterval(a)},[g]);let p=async()=>{try{let b=await navigator.mediaDevices.getUserMedia({audio:!0});e.current=new MediaRecorder(b),f.current=[],e.current.ondataavailable=a=>{f.current.push(a.data)},e.current.onstop=()=>{(async()=>{let b=new Blob(f.current,{type:"audio/webm"}),c=URL.createObjectURL(b),d={id:Date.now().toString(),url:c,duration:j,timestamp:new Date,uploaded:!1};m(a=>[d,...a]),a?.(c);try{let a=new FormData;a.append("file",b,`voice-${Date.now()}.webm`);let c=await fetch("/api/voice-notes",{method:"POST",body:a,headers:{"x-user-id":"demo-user"}});if(c.ok){let a=await c.json();a?.url?m(b=>b.map(b=>b.id===d.id?{...b,url:a.url,uploaded:!0}:b)):m(a=>a.map(a=>a.id===d.id?{...a,uploaded:!0}:a)),h.default.success("Voice note uploaded")}else(0,h.default)("Saved locally (upload failed)",{icon:"âš ï¸"})}catch(a){console.error("Voice upload failed",a),(0,h.default)("Saved locally (upload failed)",{icon:"âš ï¸"})}})()},e.current.start(),i(!0),k(0)}catch(a){h.default.error("Unable to access microphone"),console.error(a)}},q=a=>{let b=Math.floor(a/60);return`${b}:${(a%60).toString().padStart(2,"0")}`};return(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"bg-white dark:bg-slate-800 rounded-lg p-6 border border-gray-200 dark:border-slate-700",children:[(0,b.jsx)("h3",{className:"text-lg font-bold text-gray-900 dark:text-white mb-4",children:"Voice Notes"}),(0,b.jsx)("div",{className:"flex items-center gap-4 mb-4 flex-wrap",children:g?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("button",{onClick:()=>{e.current&&g&&(e.current.stop(),i(!1),e.current.stream.getTracks().forEach(a=>a.stop()))},className:"flex items-center gap-2 bg-red-600 hover:bg-red-700 text-white font-semibold py-3 px-4 rounded-lg transition-colors","aria-label":"Stop recording","aria-live":"polite",children:[(0,b.jsx)(d.FiStopCircle,{className:"w-5 h-5"}),"Stop"]}),(0,b.jsxs)("div",{className:"text-lg font-bold text-red-600 dark:text-red-400","aria-live":"polite",children:["Recording: ",q(j)]}),(0,b.jsx)("div",{className:"flex-1 h-1 bg-red-300 dark:bg-red-900 rounded-full relative overflow-hidden min-w-[100px]",children:(0,b.jsx)("div",{className:"h-full bg-red-600 animate-pulse",style:{width:"30%"}})})]}):(0,b.jsxs)("button",{onClick:p,className:"flex items-center gap-2 bg-red-600 hover:bg-red-700 text-white font-semibold py-3 px-4 rounded-lg transition-colors","aria-label":"Start recording voice note",children:[(0,b.jsx)(d.FiMic,{className:"w-5 h-5"}),"Start Recording"]})}),l.length>0&&(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("h4",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300",children:["Recordings (",l.length,")"]}),l.map(a=>(0,b.jsxs)("div",{className:"flex items-center justify-between bg-gray-50 dark:bg-slate-700 p-3 rounded-lg",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 flex-1",children:[(0,b.jsx)("button",{onClick:()=>o(n===a.id?null:a.id),className:"p-2 rounded-lg bg-blue-600 hover:bg-blue-700 text-white transition-colors","aria-label":n===a.id?"Pause recording":"Play recording",children:(0,b.jsx)(d.FiPlay,{className:"w-4 h-4"})}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:a.timestamp.toLocaleTimeString()}),(0,b.jsxs)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Duration: ",q(a.duration),a.uploaded&&(0,b.jsx)("span",{className:"ml-2",children:"âœ“ Uploaded"})]})]})]}),(0,b.jsx)("button",{onClick:()=>{var b;return b=a.id,void m(a=>a.filter(a=>a.id!==b))},className:"p-2 rounded-lg text-red-600 dark:text-red-400 hover:bg-red-100 dark:hover:bg-red-900/30 transition-colors","aria-label":`Delete recording from ${a.timestamp.toLocaleTimeString()}`,children:(0,b.jsx)(d.FiTrash2,{className:"w-4 h-4"})})]},a.id))]}),0===l.length&&!g&&(0,b.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 text-center py-6",children:"No recordings yet. Start recording to add voice notes to your trades."})]}),n&&(0,b.jsx)("audio",{src:l.find(a=>a.id===n)?.url,autoPlay:!0,controls:!0,className:"w-full"},n)]})}function C({onScreenshotAdded:a}){let e=(0,c.useRef)(null),[f,g]=(0,c.useState)([]),[i,j]=(0,c.useState)(null),[k,l]=(0,c.useState)(""),m=async b=>{let c=b.currentTarget.files;if(c){for(let b of Array.from(c))try{let c=new FileReader;c.onload=b=>{let c=b.target?.result,d={id:Date.now().toString()+Math.random(),url:c,caption:"",timestamp:new Date};g(a=>[d,...a]),a?.(c),h.default.success("Screenshot uploaded")},c.readAsDataURL(b)}catch(a){h.default.error("Failed to upload screenshot"),console.error(a)}e.current&&(e.current.value="")}},n=(a,b)=>{g(c=>c.map(c=>c.id===a?{...c,caption:b}:c)),j(null)};return(0,b.jsx)("div",{className:"space-y-4",children:(0,b.jsxs)("div",{className:"bg-white dark:bg-slate-800 rounded-lg p-6 border border-gray-200 dark:border-slate-700",children:[(0,b.jsx)("h3",{className:"text-lg font-bold text-gray-900 dark:text-white mb-4",children:"Trade Setup Screenshots"}),(0,b.jsxs)("button",{onClick:()=>e.current?.click(),className:"w-full border-2 border-dashed border-gray-300 dark:border-slate-600 rounded-lg p-6 text-center cursor-pointer hover:bg-gray-50 dark:hover:bg-slate-700/50 transition-colors","aria-label":"Upload screenshot by clicking or dragging files",children:[(0,b.jsx)(d.FiUpload,{className:"w-8 h-8 mx-auto mb-2 text-gray-600 dark:text-gray-400"}),(0,b.jsx)("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:"Click to upload or drag & drop"}),(0,b.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"PNG, JPG, GIF up to 10MB"}),(0,b.jsx)("input",{ref:e,type:"file",multiple:!0,accept:"image/*",onChange:m,className:"hidden","aria-label":"File input for screenshots"})]}),f.length>0&&(0,b.jsxs)("div",{className:"mt-6",children:[(0,b.jsxs)("h4",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-4",children:["Uploads (",f.length,")"]}),(0,b.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:f.map(a=>(0,b.jsxs)("div",{className:"relative group bg-gray-100 dark:bg-slate-700 rounded-lg overflow-hidden",children:[(0,b.jsx)("img",{src:a.url,alt:"Trade setup",className:"w-full h-40 object-cover"}),(0,b.jsxs)("div",{className:"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-between p-2",children:[(0,b.jsx)("button",{onClick:()=>{var b,c;let d;return b=a.url,c=a.timestamp,void((d=document.createElement("a")).href=b,d.download=`trade-setup-${c.toISOString()}.png`,document.body.appendChild(d),d.click(),document.body.removeChild(d))},className:"p-2 rounded-lg bg-blue-600 hover:bg-blue-700 text-white transition-colors",title:"Download",children:(0,b.jsx)(d.FiDownload,{className:"w-4 h-4"})}),(0,b.jsx)("button",{onClick:()=>{var b;return b=a.id,void g(a=>a.filter(a=>a.id!==b))},className:"p-2 rounded-lg bg-red-600 hover:bg-red-700 text-white transition-colors",title:"Delete",children:(0,b.jsx)(d.FiX,{className:"w-4 h-4"})})]}),(0,b.jsx)("div",{className:"p-3 bg-white dark:bg-slate-800 border-t border-gray-200 dark:border-slate-600",children:i===a.id?(0,b.jsx)("input",{autoFocus:!0,type:"text",value:k,onChange:a=>l(a.target.value),onBlur:()=>n(a.id,k),onKeyPress:b=>{"Enter"===b.key&&n(a.id,k)},placeholder:"Add caption...",className:"w-full px-2 py-1 border border-gray-300 dark:border-slate-600 rounded bg-white dark:bg-slate-700 text-gray-900 dark:text-white text-xs focus:ring-2 focus:ring-blue-500 outline-none"}):(0,b.jsx)("p",{onClick:()=>{j(a.id),l(a.caption)},className:"text-xs text-gray-600 dark:text-gray-400 cursor-pointer hover:text-gray-900 dark:hover:text-white",children:a.caption||"Click to add caption..."})})]},a.id))})]})]})})}var D=a.i(42029);function E(){let{theme:a,toggleTheme:f}=(0,D.useTheme)(),[g]=(0,c.useState)(()=>!1),[i,j]=(0,c.useState)(null),[k,m]=(0,c.useState)([]),[n,o]=(0,c.useState)(!0),[p,q]=(0,c.useState)("checklist");(0,c.useEffect)(()=>{g&&r()},[g]);let r=async()=>{try{o(!0);let a=await fetch("/api/trades",{headers:{"x-user-id":"demo-user"}});if(!a.ok)throw Error("Failed to load trades");let b=await a.json();m(b)}catch(a){console.error("Error loading trades:",a),h.default.error("Failed to load trades")}finally{o(!1)}},s=k.find(a=>a.id===i),t=[{id:"checklist",label:"Pre-Trade Checklist",icon:d.FiCheckCircle},{id:"updates",label:"Trade Updates",icon:d.FiClock},{id:"reflection",label:"Post-Trade Reflection",icon:d.FiBookOpen},{id:"media",label:"Media & Notes",icon:d.FiTrendingUp}];return g?(0,b.jsxs)("div",{style:{minHeight:"100vh",backgroundColor:"var(--background)"},children:[(0,b.jsx)(e.default,{onThemeToggle:f,currentTheme:a}),(0,b.jsxs)("main",{style:{maxWidth:"1200px",margin:"0 auto",padding:"32px 16px"},children:[(0,b.jsxs)("div",{style:{marginBottom:"32px"},children:[(0,b.jsx)("h1",{style:{fontSize:"32px",fontWeight:"700",color:"var(--text-primary)",marginBottom:"8px"},children:"Trade Lifecycle Review"}),(0,b.jsx)("p",{style:{fontSize:"16px",color:"var(--text-secondary)",margin:0},children:"Complete pre-trade preparation, track in-trade decisions, and reflect on outcomes"})]}),(0,b.jsx)("div",{style:{marginBottom:"24px"},children:(0,b.jsx)("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap"},children:t.map(a=>{let c=a.icon;return(0,b.jsxs)("button",{onClick:()=>q(a.id),style:{display:"flex",alignItems:"center",gap:"8px",padding:"12px 16px",borderRadius:"8px",border:"none",backgroundColor:p===a.id?"var(--purple-base)":"transparent",color:p===a.id?"white":"var(--text-secondary)",cursor:"pointer",fontWeight:"600",fontSize:"14px",transition:"all 0.2s ease"},onMouseEnter:b=>{p!==a.id&&(b.currentTarget.style.backgroundColor="var(--panel-muted)")},onMouseLeave:b=>{p!==a.id&&(b.currentTarget.style.backgroundColor="transparent")},children:[(0,b.jsx)(c,{size:16}),(0,b.jsx)("span",{children:a.label})]},a.id)})})}),(0,b.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(300px, 1fr))",gap:"24px"},children:[(0,b.jsxs)("div",{style:{backgroundColor:"var(--card-bg)",border:"1px solid var(--card-border)",borderRadius:"12px",padding:"20px"},children:[(0,b.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"16px"},children:[(0,b.jsx)("h2",{style:{fontSize:"16px",fontWeight:"600",color:"var(--text-primary)",margin:0},children:"Recent Trades"}),(0,b.jsxs)("div",{style:{fontSize:"12px",color:"var(--text-secondary)"},children:[k.length," total"]})]}),(0,b.jsx)("div",{style:{maxHeight:"400px",overflowY:"auto"},children:n?(0,b.jsx)("div",{style:{display:"flex",justifyContent:"center",padding:"32px"},children:(0,b.jsx)("div",{style:{width:"24px",height:"24px",border:"2px solid var(--card-border)",borderTop:"2px solid var(--purple-base)",borderRadius:"50%",animation:"spin 1s linear infinite"}})}):k.length>0?(0,b.jsx)("div",{style:{display:"grid",gap:"8px"},children:k.map(a=>(0,b.jsxs)("button",{onClick:()=>j(a.id),style:{width:"100%",textAlign:"left",padding:"12px",borderRadius:"8px",border:i===a.id?"2px solid var(--purple-base)":"1px solid var(--card-border)",backgroundColor:i===a.id?"var(--panel-muted)":"var(--card-bg)",cursor:"pointer",transition:"all 0.2s ease"},onMouseEnter:b=>{i!==a.id&&(b.currentTarget.style.backgroundColor="var(--panel-muted)")},onMouseLeave:b=>{i!==a.id&&(b.currentTarget.style.backgroundColor=i===a.id?"var(--panel-muted)":"var(--card-bg)")},children:[(0,b.jsxs)("div",{style:{fontSize:"14px",fontWeight:"600",color:"var(--text-primary)",marginBottom:"4px"},children:[a.pair," ",a.direction]}),(0,b.jsx)("div",{style:{fontSize:"12px",color:"var(--text-secondary)",marginBottom:"4px"},children:new Date(a.entryTime).toLocaleDateString()}),(0,b.jsx)("div",{style:{fontSize:"12px",fontWeight:"600",color:"WIN"===a.outcome?"#10b981":"LOSS"===a.outcome?"#ef4444":"var(--text-secondary)"},children:a.outcome||"Open"})]},a.id))}):(0,b.jsxs)("div",{style:{textAlign:"center",padding:"32px"},children:[(0,b.jsx)("div",{style:{fontSize:"48px",marginBottom:"16px"},children:"ðŸ“Š"}),(0,b.jsx)("h3",{style:{fontSize:"16px",fontWeight:"600",color:"var(--text-primary)",marginBottom:"8px"},children:"No Trades Yet"}),(0,b.jsx)("p",{style:{fontSize:"14px",color:"var(--text-secondary)"},children:"Start trading to begin reviewing your performance"})]})})]}),(0,b.jsx)("div",{style:{backgroundColor:"var(--card-bg)",border:"1px solid var(--card-border)",borderRadius:"12px",padding:"20px"},children:s?(0,b.jsxs)("div",{style:{display:"grid",gap:"20px"},children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"16px"},children:[(0,b.jsxs)("h2",{style:{fontSize:"18px",fontWeight:"600",color:"var(--text-primary)",margin:0},children:[s.pair," - ",s.direction]}),(0,b.jsx)("span",{style:{padding:"4px 12px",borderRadius:"20px",fontSize:"12px",fontWeight:"600",backgroundColor:"closed"===s.status?"#dcfce7":"open"===s.status?"#dbeafe":"var(--panel-muted)",color:"closed"===s.status?"#166534":"open"===s.status?"#1e40af":"var(--text-secondary)"},children:s.status})]}),(0,b.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(120px, 1fr))",gap:"16px"},children:[(0,b.jsxs)("div",{style:{padding:"12px",backgroundColor:"var(--panel-muted)",borderRadius:"6px"},children:[(0,b.jsx)("div",{style:{fontSize:"12px",color:"var(--text-secondary)",marginBottom:"4px"},children:"Entry Price"}),(0,b.jsx)("div",{style:{fontSize:"14px",fontWeight:"600",color:"var(--text-primary)"},children:s.entryPrice.toFixed(5)})]}),(0,b.jsxs)("div",{style:{padding:"12px",backgroundColor:"var(--panel-muted)",borderRadius:"6px"},children:[(0,b.jsx)("div",{style:{fontSize:"12px",color:"var(--text-secondary)",marginBottom:"4px"},children:"Exit Price"}),(0,b.jsx)("div",{style:{fontSize:"14px",fontWeight:"600",color:"var(--text-primary)"},children:s.exitPrice?.toFixed(5)||"Open"})]}),(0,b.jsxs)("div",{style:{padding:"12px",backgroundColor:"var(--panel-muted)",borderRadius:"6px"},children:[(0,b.jsx)("div",{style:{fontSize:"12px",color:"var(--text-secondary)",marginBottom:"4px"},children:"P&L"}),(0,b.jsx)("div",{style:{fontSize:"14px",fontWeight:"600",color:(s.profitLoss||0)>=0?"#10b981":"#ef4444"},children:s.profitLoss?.toFixed(2)||"N/A"})]}),(0,b.jsxs)("div",{style:{padding:"12px",backgroundColor:"var(--panel-muted)",borderRadius:"6px"},children:[(0,b.jsx)("div",{style:{fontSize:"12px",color:"var(--text-secondary)",marginBottom:"4px"},children:"Outcome"}),(0,b.jsx)("div",{style:{fontSize:"14px",fontWeight:"600",color:"var(--text-primary)"},children:s.outcome||"Open"})]})]})]}),(0,b.jsxs)("div",{style:{minHeight:"400px"},children:["checklist"===p&&(0,b.jsx)(l,{tradeId:s.id,onChecklistComplete:a=>{h.default.success("Pre-trade checklist completed!")}}),"updates"===p&&(0,b.jsx)(w,{tradeId:s.id}),"reflection"===p&&(0,b.jsx)(A,{tradeId:s.id,onReflectionComplete:a=>{h.default.success("Post-trade reflection saved!")}}),"media"===p&&(0,b.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"16px"},children:[(0,b.jsxs)("div",{style:{backgroundColor:"var(--panel-muted)",borderRadius:"8px",padding:"16px"},children:[(0,b.jsx)("h3",{style:{fontSize:"16px",fontWeight:"600",color:"var(--text-primary)",marginBottom:"12px"},children:"Voice Notes"}),(0,b.jsx)(B,{})]}),(0,b.jsxs)("div",{style:{backgroundColor:"var(--panel-muted)",borderRadius:"8px",padding:"16px"},children:[(0,b.jsx)("h3",{style:{fontSize:"16px",fontWeight:"600",color:"var(--text-primary)",marginBottom:"12px"},children:"Screenshots"}),(0,b.jsx)(C,{})]})]})]})]}):(0,b.jsxs)("div",{style:{textAlign:"center",padding:"64px 32px"},children:[(0,b.jsx)("div",{style:{fontSize:"64px",marginBottom:"24px"},children:"ðŸ“ˆ"}),(0,b.jsx)("h3",{style:{fontSize:"20px",fontWeight:"600",color:"var(--text-primary)",marginBottom:"12px"},children:"Select a Trade to Review"}),(0,b.jsx)("p",{style:{fontSize:"16px",color:"var(--text-secondary)",marginBottom:"24px"},children:"Choose a trade from the sidebar to access the complete lifecycle review"}),(0,b.jsx)("button",{onClick:()=>j(k[0]?.id||null),disabled:0===k.length,style:{padding:"12px 24px",background:"linear-gradient(135deg, var(--purple-base) 0%, var(--purple-dark) 100%)",color:"white",border:"none",borderRadius:"8px",cursor:k.length>0?"pointer":"not-allowed",fontWeight:"600",fontSize:"14px",opacity:k.length>0?1:.5},children:"Select First Trade"})]})})]})]}),(0,b.jsx)(h.Toaster,{position:"bottom-right"})]}):(0,b.jsx)("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900"})}a.s(["default",()=>E],47137)}];

//# sourceMappingURL=src_app_review_page_tsx_d97b6247._.js.map